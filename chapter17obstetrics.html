<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AlliedRx -- Chapter 17: Women's Reproductive Health & Contraception</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --color-primary: #af4bef;
            --color-primary-soft: #d492ff;
            --color-accent: #8380f0;
            --color-success: #00b894;
            --color-error: #e17055;
            --color-warning: #fdcb6e;
            --color-info: #0984e3;
            --color-bg: #f7f5fb;
            --color-text: #2b2b2b;
            --color-muted: #6c6880;
            --color-dark: #0c0a18;
            --radius-lg: 24px;
            --radius-md: 16px;
            --radius-sm: 12px;
            --shadow-soft: 0 18px 45px rgba(23, 10, 61, 0.18);
            --shadow-hover: 0 25px 50px rgba(175, 75, 239, 0.15);
            --shadow-card: 0 12px 30px rgba(15, 23, 42, 0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            padding: 24px;
            background: radial-gradient(
                circle at top left,
                #ffffff 0,
                #f1ecff 40%,
                var(--color-bg) 100%
            );
            color: var(--color-text);
            -webkit-text-size-adjust: 100%;
            line-height: 1.5;
        }

        @media (max-width: 600px) {
            body { padding: 12px; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes checkmarkPop {
            0% { transform: scale(0); opacity: 0; }
            70% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .page {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 28px 30px 32px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
        }

        @media (max-width: 900px) { .page { padding: 22px; } }
        @media (max-width: 480px) {
            body { padding: 0; }
            .page {
                border-radius: 0;
                box-shadow: none;
                padding: 18px 14px 22px;
            }
        }

        /* Header */
        .brand-row {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 14px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            width: 100%;
            animation: fadeIn 0.6s ease-out 0.2s both;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .brand-logo {
            height: 40px;
            width: auto;
            max-width: 100%;
            filter: drop-shadow(0 3px 8px rgba(0, 0, 0, 0.2));
            transition: transform 0.3s ease;
        }

        .brand-logo:hover { transform: scale(1.05); }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 2px;
            max-width: 100%;
        }

        .course-name {
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: var(--color-muted);
            white-space: normal;
        }

        .week-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 10px;
            border-radius: 999px;
            background: rgba(175, 75, 239, 0.08);
            font-size: 0.76rem;
            color: var(--color-primary);
            white-space: normal;
        }

        .week-label-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--color-success);
            flex-shrink: 0;
        }

        .badge-mode {
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(12, 10, 24, 0.06);
            border: 1px solid rgba(12, 10, 24, 0.08);
            font-size: 0.74rem;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: var(--color-muted);
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .badge-mode:hover {
            background: rgba(175, 75, 239, 0.1);
            border-color: var(--color-primary-soft);
            color: var(--color-primary);
        }

        @media (max-width: 480px) {
            .brand-row { flex-direction: column; align-items: flex-start; }
            .badge-mode { margin-top: 6px; }
        }

        h1 {
            font-size: clamp(1.8rem, 3vw, 2.2rem);
            line-height: 1.1;
            color: var(--color-primary);
            margin-bottom: 6px;
            animation: fadeInUp 0.6s ease-out 0.3s both;
        }

        .module-subtitle {
            font-size: 0.98rem;
            color: var(--color-muted);
            max-width: 600px;
            margin-bottom: 24px;
            animation: fadeInUp 0.6s ease-out 0.4s both;
        }

        /* Progress Tracker */
        .progress-tracker {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
            padding: 0 20px;
        }

        .progress-tracker::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 50px;
            right: 50px;
            height: 3px;
            background: rgba(12, 10, 24, 0.08);
            z-index: 1;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: white;
            border: 2px solid rgba(12, 10, 24, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-muted);
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-circle {
            background: var(--color-primary);
            border-color: var(--color-primary);
            color: white;
            transform: scale(1.1);
        }

        .progress-step.completed .step-circle {
            background: var(--color-success);
            border-color: var(--color-success);
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-align: center;
            font-weight: 500;
        }

        .progress-step.active .step-label {
            color: var(--color-primary);
            font-weight: 600;
        }

        /* Progress Summary */
        .progress-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
            animation: fadeInUp 0.6s ease-out 0.5s both;
        }

        .summary-card {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-md);
            padding: 16px;
            border: 1px solid rgba(12, 10, 24, 0.06);
            text-align: center;
            transition: all 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-card);
            border-color: var(--color-primary-soft);
        }

        .summary-number {
            font-size: 2rem;
            font-weight: 800;
            color: var(--color-primary);
            display: block;
            line-height: 1;
            margin-bottom: 4px;
        }

        .summary-label {
            font-size: 0.8rem;
            color: var(--color-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Activity Grid */
        .activity-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .activity-grid { grid-template-columns: 1fr; }
        }

        .activity-card {
            background: white;
            border-radius: var(--radius-md);
            border: 1px solid rgba(12, 10, 24, 0.08);
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--color-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .activity-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            border-color: var(--color-primary-soft);
        }

        .activity-card:hover::before { opacity: 1; }

        .activity-card.completed {
            border-color: var(--color-success);
        }

        .activity-card.completed::before {
            background: var(--color-success);
            opacity: 1;
        }

        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .activity-number {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--color-primary);
            background: rgba(175, 75, 239, 0.1);
            padding: 4px 10px;
            border-radius: 20px;
        }

        .activity-status {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 12px;
            background: rgba(12, 10, 24, 0.06);
            color: var(--color-muted);
        }

        .activity-card.completed .activity-status {
            background: rgba(0, 184, 148, 0.1);
            color: var(--color-success);
        }

        .activity-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 8px;
        }

        .activity-description {
            font-size: 0.9rem;
            color: var(--color-muted);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        /* Activity 1: Contraceptive Method Selection Simulator */
        .patient-scenarios {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .patient-card {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-sm);
            padding: 15px;
            border: 2px solid rgba(12, 10, 24, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .patient-card:hover {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.05);
            transform: translateY(-2px);
        }

        .patient-card.selected {
            border-color: var(--color-success);
            background: rgba(0, 184, 148, 0.1);
        }

        .patient-age {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 5px;
        }

        .patient-details {
            font-size: 0.8rem;
            color: var(--color-text);
            line-height: 1.4;
        }

        .contraceptive-methods {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .method-item {
            background: rgba(12, 10, 24, 0.05);
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.85rem;
            cursor: grab;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .method-item:hover {
            background: rgba(175, 75, 239, 0.1);
            border-color: var(--color-primary-soft);
            transform: translateY(-2px);
        }

        .method-item.dragging {
            opacity: 0.7;
            transform: scale(0.95);
        }

        .patient-dropzone {
            min-height: 100px;
            border: 2px dashed rgba(12, 10, 24, 0.1);
            border-radius: var(--radius-sm);
            padding: 15px;
            margin-bottom: 20px;
            background: rgba(12, 10, 24, 0.02);
        }

        .patient-dropzone.hover {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.05);
        }

        .patient-dropzone.empty::after {
            content: 'Drag contraceptive methods here for selected patient';
            color: var(--color-muted);
            text-align: center;
            display: block;
            font-size: 0.9rem;
            margin-top: 30px;
        }

        .dropzone-header {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 10px;
        }

        .dropped-method {
            background: rgba(0, 184, 148, 0.1);
            border-radius: 15px;
            padding: 6px 12px;
            font-size: 0.8rem;
            margin: 5px;
            display: inline-block;
            border: 1px solid var(--color-success);
        }

        /* Activity 2: Menstrual Cycle & Disorders Explorer */
        .cycle-slider-container {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-sm);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(12, 10, 24, 0.08);
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .cycle-phase {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--color-primary);
        }

        .cycle-day {
            font-size: 0.8rem;
            color: var(--color-muted);
        }

        .slider-track {
            width: 100%;
            height: 8px;
            background: rgba(12, 10, 24, 0.1);
            border-radius: 4px;
            position: relative;
            margin-bottom: 30px;
        }

        .slider-thumb {
            width: 24px;
            height: 24px;
            background: var(--color-primary);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            cursor: grab;
            box-shadow: 0 4px 12px rgba(175, 75, 239, 0.3);
        }

        .slider-marker {
            position: absolute;
            top: 20px;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: var(--color-muted);
            text-align: center;
            width: 40px;
        }

        .hormone-levels {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .hormone-bar {
            height: 20px;
            background: var(--color-primary-soft);
            border-radius: 10px;
            margin-top: 5px;
            position: relative;
            overflow: hidden;
        }

        .hormone-fill {
            height: 100%;
            background: var(--color-accent);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .disorders-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .disorder-card {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-sm);
            padding: 15px;
            border: 2px dashed rgba(12, 10, 24, 0.1);
            min-height: 120px;
            transition: all 0.3s ease;
        }

        .disorder-card.hover {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.05);
        }

        .disorder-card.filled {
            border: 2px solid var(--color-primary-soft);
            background: rgba(175, 75, 239, 0.08);
        }

        .disorder-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 10px;
            text-align: center;
        }

        .disorder-items {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .disorder-item {
            background: rgba(12, 10, 24, 0.05);
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.85rem;
            cursor: grab;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .disorder-item:hover {
            background: rgba(175, 75, 239, 0.1);
            border-color: var(--color-primary-soft);
            transform: translateY(-2px);
        }

        .disorder-item.dragging {
            opacity: 0.7;
            transform: scale(0.95);
        }

        /* Feedback */
        .feedback-container {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-sm);
            padding: 15px;
            border: 1px solid rgba(12, 10, 24, 0.08);
            margin-top: 20px;
            display: none;
        }

        .feedback-container.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .feedback-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feedback-icon {
            font-size: 1.2rem;
        }

        .feedback-icon.correct {
            color: var(--color-success);
        }

        .feedback-icon.incorrect {
            color: var(--color-error);
        }

        .feedback-content {
            font-size: 0.85rem;
            color: var(--color-text);
            line-height: 1.5;
        }

        .feedback-content strong {
            color: var(--color-primary);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: #9a3bd6;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(175, 75, 239, 0.3);
        }

        .btn-secondary {
            background: rgba(12, 10, 24, 0.06);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: rgba(12, 10, 24, 0.1);
            transform: translateY(-2px);
        }

        .btn-icon {
            font-size: 1.1em;
        }

        /* Results Panel */
        .results-panel {
            background: var(--color-dark);
            color: white;
            border-radius: var(--radius-md);
            padding: 30px;
            margin-top: 30px;
            display: none;
            animation: fadeInUp 0.6s ease;
        }

        .results-panel.show {
            display: block;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .results-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: white;
        }

        .score-display {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--color-primary-soft);
            text-align: center;
            margin: 20px 0;
        }

        .clinical-insights {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            padding: 20px;
            margin-top: 20px;
        }

        .insights-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--color-primary-soft);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insights-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .insights-list li {
            display: flex;
            gap: 10px;
            align-items: flex-start;
            font-size: 0.9rem;
            color: #e5e7eb;
        }

        .insight-dot {
            width: 6px;
            height: 6px;
            margin-top: 6px;
            border-radius: 999px;
            background: var(--color-accent);
            flex-shrink: 0;
        }

        /* Ethical Note */
        .ethical-note {
            background: rgba(253, 203, 110, 0.1);
            border: 2px solid var(--color-warning);
            border-radius: var(--radius-sm);
            padding: 15px;
            margin-top: 15px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .note-icon {
            font-size: 1.5rem;
            color: var(--color-warning);
            flex-shrink: 0;
        }

        .note-content {
            flex: 1;
        }

        .note-title {
            font-size: 0.95rem;
            font-weight: 700;
            color: var(--color-warning);
            margin-bottom: 5px;
        }

        .note-text {
            font-size: 0.85rem;
            color: var(--color-text);
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .patient-scenarios { grid-template-columns: 1fr; }
            .hormone-levels { grid-template-columns: 1fr; }
            .disorders-grid { grid-template-columns: 1fr; }
            .action-buttons { flex-direction: column; }
            .btn { width: 100%; justify-content: center; }
        }
    </style>
</head>
<body>
    <main class="page" aria-labelledby="module-heading">
        <!-- Header -->
        <header class="brand-row">
            <div class="brand">
                <img
                    src="https://cdn.prod.website-files.com/64d0ccc1558d601cbfb09021/64e9d2f719b1e5258e5d57f5_IMG_1512-p-500.png"
                    alt="AlliedRx logo"
                    class="brand-logo"
                />
                <div class="course-meta">
                    <span class="course-name">Clinical Medical Assistant ‚Ä¢ Week 6</span>
                    <div class="week-label">
                        <span class="week-label-dot"></span>
                        <span>Chapter 17: Obstetrics & Gynecology</span>
                    </div>
                </div>
            </div>
            <span class="badge-mode">Campus & Online</span>
        </header>

        <h1 id="module-heading">Women's Reproductive Health & Contraception</h1>
        <p class="module-subtitle">
            Master contraceptive method selection and understand menstrual cycle phases 
            and gynecologic disorders through interactive patient scenarios and clinical simulations.
        </p>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">Contraceptive Selection</div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">Cycle & Disorders</div>
            </div>
        </div>

        <!-- Progress Summary -->
        <div class="progress-summary">
            <div class="summary-card">
                <span class="summary-number" id="completed-count">0</span>
                <span class="summary-label">Activities Completed</span>
            </div>
            <div class="summary-card">
                <span class="summary-number" id="accuracy-rate">0%</span>
                <span class="summary-label">Current Accuracy</span>
            </div>
            <div class="summary-card">
                <span class="summary-number" id="time-spent">0:00</span>
                <span class="summary-label">Time Spent</span>
            </div>
        </div>

        <!-- Activity Grid -->
        <div class="activity-grid">
            <!-- Activity 1: Contraceptive Method Selection Simulator -->
            <section class="activity-card" id="activity-1" data-activity="1">
                <div class="activity-header">
                    <span class="activity-number">Activity 1</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Contraceptive Method Selection Simulator</h3>
                <p class="activity-description">
                    Select appropriate contraceptive methods for different patient profiles 
                    based on medical history, lifestyle, and reproductive goals. 
                    <strong>Consider efficacy, safety, and patient preferences.</strong>
                </p>

                <!-- Patient Scenarios -->
                <div class="patient-scenarios">
                    <div class="patient-card" data-patient="1">
                        <div class="patient-age">22-year-old college student</div>
                        <div class="patient-details">
                            ‚Ä¢ Needs convenience and STD protection<br>
                            ‚Ä¢ Irregular schedule<br>
                            ‚Ä¢ No contraindications to hormones<br>
                            ‚Ä¢ Not planning pregnancy for 3-5 years
                        </div>
                    </div>
                    <div class="patient-card" data-patient="2">
                        <div class="patient-age">35-year-old mother of 3</div>
                        <div class="patient-details">
                            ‚Ä¢ Wants permanent solution<br>
                            ‚Ä¢ Completed childbearing<br>
                            ‚Ä¢ History of heavy menstrual bleeding<br>
                            ‚Ä¢ No future pregnancy plans
                        </div>
                    </div>
                    <div class="patient-card" data-patient="3">
                        <div class="patient-age">18-year-old with migraines with aura</div>
                        <div class="patient-details">
                            ‚Ä¢ Contraindicated for estrogen<br>
                            ‚Ä¢ Needs reliable contraception<br>
                            ‚Ä¢ Concerned about weight gain<br>
                            ‚Ä¢ May want children in 5+ years
                        </div>
                    </div>
                    <div class="patient-card" data-patient="4">
                        <div class="patient-age">30-year-old planning pregnancy in 1 year</div>
                        <div class="patient-details">
                            ‚Ä¢ Wants easily reversible method<br>
                            ‚Ä¢ Regular menstrual cycles<br>
                            ‚Ä¢ No medical contraindications<br>
                            ‚Ä¢ Planning to conceive in 12 months
                        </div>
                    </div>
                    <div class="patient-card" data-patient="5">
                        <div class="patient-age">45-year-old perimenopausal with hypertension</div>
                        <div class="patient-details">
                            ‚Ä¢ Controlled hypertension on medication<br>
                            ‚Ä¢ Irregular periods<br>
                            ‚Ä¢ Vasomotor symptoms<br>
                            ‚Ä¢ Needs non-hormonal options
                        </div>
                    </div>
                </div>

                <!-- Contraceptive Methods -->
                <div class="contraceptive-methods" id="contraceptive-methods">
                    <div class="method-item draggable" data-method="oral" data-category="hormonal">Oral Contraceptive Pill</div>
                    <div class="method-item draggable" data-method="patch" data-category="hormonal">Contraceptive Patch</div>
                    <div class="method-item draggable" data-method="ring" data-category="hormonal">Vaginal Ring</div>
                    <div class="method-item draggable" data-method="implant" data-category="hormonal">Contraceptive Implant</div>
                    <div class="method-item draggable" data-method="injection" data-category="hormonal">Depo-Provera Injection</div>
                    <div class="method-item draggable" data-method="iud-hormonal" data-category="hormonal">Hormonal IUD</div>
                    <div class="method-item draggable" data-method="iud-copper" data-category="non-hormonal">Copper IUD</div>
                    <div class="method-item draggable" data-method="condom" data-category="barrier">Male Condom</div>
                    <div class="method-item draggable" data-method="female-condom" data-category="barrier">Female Condom</div>
                    <div class="method-item draggable" data-method="diaphragm" data-category="barrier">Diaphragm</div>
                    <div class="method-item draggable" data-method="fertility-awareness" data-category="natural">Fertility Awareness</div>
                    <div class="method-item draggable" data-method="tubal" data-category="permanent">Tubal Ligation</div>
                    <div class="method-item draggable" data-method="vasectomy" data-category="permanent">Vasectomy (Partner)</div>
                    <div class="method-item draggable" data-method="emergency" data-category="emergency">Emergency Contraception</div>
                </div>

                <!-- Patient Dropzone -->
                <div class="patient-dropzone empty" id="patient-dropzone">
                    <div class="dropzone-header">Selected Patient: <span id="selected-patient">None</span></div>
                    <div id="dropped-methods"></div>
                </div>

                <!-- Ethical Note -->
                <div class="ethical-note">
                    <div class="note-icon">‚öñÔ∏è</div>
                    <div class="note-content">
                        <div class="note-title">Ethical & Cultural Considerations</div>
                        <div class="note-text">
                            <strong>Confidentiality:</strong> Adolescent patients have right to confidential reproductive health services.<br>
                            <strong>Informed Consent:</strong> Ensure patient understands risks, benefits, and alternatives.<br>
                            <strong>Cultural Sensitivity:</strong> Respect religious and cultural beliefs about contraception.<br>
                            <strong>Non-judgmental Care:</strong> Provide factual information without personal bias.
                        </div>
                    </div>
                </div>

                <!-- Feedback -->
                <div class="feedback-container" id="feedback-1">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Contraceptive Counseling Complete!
                    </div>
                    <div class="feedback-content">
                        <strong>Optimal Recommendations by Patient:</strong><br>
                        <strong>1. College Student (22):</strong> Long-acting reversible contraception (LARC) like hormonal IUD or implant plus condoms for STD protection.<br>
                        <strong>2. Mother of 3 (35):</strong> Permanent solution (tubal ligation) or hormonal IUD for heavy bleeding.<br>
                        <strong>3. Migraines with Aura (18):</strong> Progestin-only methods (implant, injection, hormonal IUD) - avoid estrogen.<br>
                        <strong>4. Planning Pregnancy Soon (30):</strong> Barrier methods or fertility awareness; avoid LARC if planning conception within year.<br>
                        <strong>5. Perimenopausal with HTN (45):</strong> Copper IUD or barrier methods; consider low-dose hormones only if HTN controlled.<br><br>
                        <strong>Clinical Pearls:</strong><br>
                        ‚Ä¢ LARC methods (IUDs, implant) have highest efficacy and continuation rates<br>
                        ‚Ä¢ Estrogen contraindicated in migraines with aura, hypertension, history of VTE<br>
                        ‚Ä¢ Permanent methods require thorough counseling and wait period<br>
                        ‚Ä¢ Emergency contraception available OTC for all ages
                    </div>
                </div>
            </section>

            <!-- Activity 2: Menstrual Cycle & Gynecologic Disorders Explorer -->
            <section class="activity-card" id="activity-2" data-activity="2">
                <div class="activity-header">
                    <span class="activity-number">Activity 2</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Menstrual Cycle & Gynecologic Disorders Explorer</h3>
                <p class="activity-description">
                    Explore menstrual cycle phases and match gynecologic disorders with their 
                    characteristics. Understand hormone fluctuations and clinical presentations.
                </p>

                <!-- Menstrual Cycle Slider -->
                <div class="cycle-slider-container">
                    <div class="slider-header">
                        <div class="cycle-phase" id="cycle-phase">Follicular Phase (Day 1-14)</div>
                        <div class="cycle-day" id="cycle-day">Day 1</div>
                    </div>
                    <div class="slider-track" id="slider-track">
                        <div class="slider-thumb" id="slider-thumb"></div>
                        <div class="slider-marker" style="left: 0%;">Day 1</div>
                        <div class="slider-marker" style="left: 25%;">Day 7</div>
                        <div class="slider-marker" style="left: 50%;">Day 14<br>(Ovulation)</div>
                        <div class="slider-marker" style="left: 75%;">Day 21</div>
                        <div class="slider-marker" style="left: 100%;">Day 28</div>
                    </div>

                    <!-- Hormone Levels -->
                    <div class="hormone-levels">
                        <div>
                            <div style="font-size: 0.8rem; color: var(--color-muted);">Estrogen</div>
                            <div class="hormone-bar">
                                <div class="hormone-fill" id="estrogen-level" style="width: 30%;"></div>
                            </div>
                        </div>
                        <div>
                            <div style="font-size: 0.8rem; color: var(--color-muted);">Progesterone</div>
                            <div class="hormone-bar">
                                <div class="hormone-fill" id="progesterone-level" style="width: 10%;"></div>
                            </div>
                        </div>
                    </div>

                    <p style="font-size: 0.8rem; color: var(--color-muted); margin-top: 15px;">
                        <strong>Clinical Insight:</strong> Follicular phase = estrogen rise, ovulation = LH surge, 
                        luteal phase = progesterone dominance. Implantation occurs day 20-24 if fertilization occurs.
                    </p>
                </div>

                <!-- Disorders Matching -->
                <div class="disorders-grid">
                    <div class="disorder-card" data-disorder="pcos" id="disorder-pcos">
                        <div class="disorder-title">PCOS</div>
                        <div class="disorder-content"></div>
                    </div>
                    <div class="disorder-card" data-disorder="endometriosis" id="disorder-endo">
                        <div class="disorder-title">Endometriosis</div>
                        <div class="disorder-content"></div>
                    </div>
                    <div class="disorder-card" data-disorder="fibroids" id="disorder-fibroids">
                        <div class="disorder-title">Uterine Fibroids</div>
                        <div class="disorder-content"></div>
                    </div>
                    <div class="disorder-card" data-disorder="dysmenorrhea" id="disorder-dysmenorrhea">
                        <div class="disorder-title">Dysmenorrhea</div>
                        <div class="disorder-content"></div>
                    </div>
                    <div class="disorder-card" data-disorder="yeast" id="disorder-yeast">
                        <div class="disorder-title">Yeast Infection</div>
                        <div class="disorder-content"></div>
                    </div>
                    <div class="disorder-card" data-disorder="bv" id="disorder-bv">
                        <div class="disorder-title">Bacterial Vaginosis</div>
                        <div class="disorder-content"></div>
                    </div>
                </div>

                <!-- Disorder Items -->
                <div class="disorder-items" id="disorder-items">
                    <div class="disorder-item draggable" data-disorder="pcos">Irregular periods, hirsutism, insulin resistance</div>
                    <div class="disorder-item draggable" data-disorder="pcos">Multiple ovarian cysts on ultrasound</div>
                    <div class="disorder-item draggable" data-disorder="endometriosis">Painful periods, dyspareunia, infertility</div>
                    <div class="disorder-item draggable" data-disorder="endometriosis">Endometrial tissue outside uterus</div>
                    <div class="disorder-item draggable" data-disorder="fibroids">Heavy menstrual bleeding, pelvic pressure</div>
                    <div class="disorder-item draggable" data-disorder="fibroids">Benign uterine muscle tumors</div>
                    <div class="disorder-item draggable" data-disorder="dysmenorrhea">Primary: no pelvic pathology</div>
                    <div class="disorder-item draggable" data-disorder="dysmenorrhea">Secondary: caused by underlying condition</div>
                    <div class="disorder-item draggable" data-disorder="yeast">Thick white discharge, itching, burning</div>
                    <div class="disorder-item draggable" data-disorder="yeast">Caused by Candida overgrowth</div>
                    <div class="disorder-item draggable" data-disorder="bv">Thin gray discharge, fishy odor</div>
                    <div class="disorder-item draggable" data-disorder="bv">Gardnerella vaginalis overgrowth</div>
                </div>

                <!-- Patient Education Note -->
                <div class="ethical-note">
                    <div class="note-icon">üë©‚Äç‚öïÔ∏è</div>
                    <div class="note-content">
                        <div class="note-title">Patient Education Focus</div>
                        <div class="note-text">
                            <strong>Menstrual Health:</strong> Normal cycle = 21-35 days, duration = 2-7 days.<br>
                            <strong>Red Flags:</strong> Bleeding between periods, postmenopausal bleeding, severe pain.<br>
                            <strong>Prevention:</strong> Regular Pap tests, HPV vaccination, safe sex practices.<br>
                            <strong>Self-Care:</strong> Heat for cramps, NSAIDs for pain, tracking symptoms.
                        </div>
                    </div>
                </div>

                <!-- Feedback -->
                <div class="feedback-container" id="feedback-2">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">‚úì</span>
                        Menstrual Health Knowledge Demonstrated!
                    </div>
                    <div class="feedback-content">
                        <strong>Key Disorder Characteristics:</strong><br>
                        <strong>PCOS:</strong> Irregular periods, hyperandrogenism, insulin resistance, ovarian cysts.<br>
                        <strong>Endometriosis:</strong> Painful periods, pain with sex, infertility, endometrial implants outside uterus.<br>
                        <strong>Uterine Fibroids:</strong> Heavy bleeding, pelvic pressure/pain, urinary frequency, benign smooth muscle tumors.<br>
                        <strong>Dysmenorrhea:</strong> Painful periods; primary (no pathology) vs secondary (endometriosis, fibroids, etc.).<br>
                        <strong>Yeast Infection:</strong> Thick white "cottage cheese" discharge, itching, burning, erythema.<br>
                        <strong>Bacterial Vaginosis:</strong> Thin gray discharge, fishy odor (especially after sex), clue cells on microscopy.<br><br>
                        <strong>Clinical Management:</strong><br>
                        ‚Ä¢ PCOS: Metformin, OCPs, spironolactone, lifestyle changes<br>
                        ‚Ä¢ Endometriosis: NSAIDs, hormonal suppression, surgery<br>
                        ‚Ä¢ Fibroids: Observation, hormonal therapy, UAE, myomectomy, hysterectomy<br>
                        ‚Ä¢ Infections: Antifungals (yeast), metronidazole/clindamycin (BV)<br>
                        ‚Ä¢ Menstrual cycle: Day 1 = first day of bleeding, ovulation ~day 14 in 28-day cycle
                    </div>
                </div>
            </section>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-secondary" id="reset-all-btn">
                <span class="btn-icon">‚Üª</span>
                Reset All Activities
            </button>
            <button class="btn btn-secondary" id="check-answers-btn">
                <span class="btn-icon">‚úì</span>
                Check All Answers
            </button>
            <button class="btn btn-primary" id="view-results-btn">
                <span class="btn-icon">üìä</span>
                View Final Results
            </button>
        </div>

        <!-- Results Panel -->
        <div class="results-panel" id="results-panel">
            <div class="results-header">
                <h2 class="results-title">Reproductive Health Competency Results</h2>
                <div class="score-display" id="final-score">0%</div>
            </div>

            <div class="clinical-insights">
                <h3 class="insights-title">
                    <span>ü©∫</span> Clinical Proficiency Insights
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Contraceptive Selection:</strong> LARC methods (IUDs, implant) have highest efficacy (>99%). Consider medical contraindications, lifestyle, and reproductive plans. Estrogen contraindicated in migraines with aura, hypertension >160/100, history of VTE, smokers >35.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Menstrual Cycle:</strong> Normal cycle = 21-35 days. Follicular phase variable, luteal phase fixed at 14 days. Ovulation occurs 14 days BEFORE next period (not 14 days after last period).</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>PCOS Diagnosis:</strong> Rotterdam criteria require 2 of 3: oligo/anovulation, hyperandrogenism, polycystic ovaries. Manage with lifestyle changes, metformin for insulin resistance, OCPs for hyperandrogenism.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Endometriosis:</strong> Gold standard diagnosis = laparoscopy with biopsy. Medical management with continuous OCPs, progestins, or GnRH agonists. Surgical excision for severe pain/infertility.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Infection Differentiation:</strong> Yeast = thick white discharge, itching. BV = thin gray discharge, fishy odor. Trichomoniasis = frothy yellow-green discharge, itching. PID = lower abdominal pain, fever, cervical motion tenderness.</span>
                    </li>
                </ul>
            </div>

            <div class="clinical-insights" style="margin-top: 20px;">
                <h3 class="insights-title">
                    <span>üìã</span> Documentation & Patient Education
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Contraceptive Counseling:</strong> Document method selected, informed consent, education provided, follow-up plan. Include discussion of efficacy, side effects, STD protection, and reversibility.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Menstrual History:</strong> Document LMP, cycle length, duration, flow (pads/tampons per day), associated symptoms (pain, PMS), and any intermenstrual or postcoital bleeding.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Adolescent Confidentiality:</strong> Most states allow confidential reproductive health services for minors. Document patient's understanding and any disclosures to parents per state law.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Cultural Competence:</strong> Respect cultural/religious beliefs about contraception, menstruation, and reproductive health. Use trained interpreters when needed.</span>
                    </li>
                </ul>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // State Management
            const state = {
                activities: {
                    1: { completed: false, correct: 0, total: 5, score: 0 },
                    2: { completed: false, correct: 0, total: 6, score: 0 }
                },
                startedAt: new Date(),
                timeSpent: 0,
                selectedPatient: null,
                placedMethods: {},
                placedDisorders: {}
            };

            // Correct answers
            const correctRecommendations = {
                1: ['implant', 'iud-hormonal', 'condom'], // College student
                2: ['tubal', 'iud-hormonal'], // Mother of 3
                3: ['implant', 'iud-hormonal', 'injection', 'iud-copper'], // Migraines with aura
                4: ['condom', 'diaphragm', 'fertility-awareness'], // Planning pregnancy soon
                5: ['iud-copper', 'condom', 'diaphragm'] // Perimenopausal with HTN
            };

            const correctDisorderMatches = {
                'pcos': ['Irregular periods, hirsutism, insulin resistance', 'Multiple ovarian cysts on ultrasound'],
                'endometriosis': ['Painful periods, dyspareunia, infertility', 'Endometrial tissue outside uterus'],
                'fibroids': ['Heavy menstrual bleeding, pelvic pressure', 'Benign uterine muscle tumors'],
                'dysmenorrhea': ['Primary: no pelvic pathology', 'Secondary: caused by underlying condition'],
                'yeast': ['Thick white discharge, itching, burning', 'Caused by Candida overgrowth'],
                'bv': ['Thin gray discharge, fishy odor', 'Gardnerella vaginalis overgrowth']
            };

            // DOM Elements
            const progressSteps = document.querySelectorAll('.progress-step');
            const activityCards = document.querySelectorAll('.activity-card');
            const completedCount = document.getElementById('completed-count');
            const accuracyRate = document.getElementById('accuracy-rate');
            const timeSpent = document.getElementById('time-spent');
            const resetBtn = document.getElementById('reset-all-btn');
            const checkBtn = document.getElementById('check-answers-btn');
            const resultsBtn = document.getElementById('view-results-btn');
            const resultsPanel = document.getElementById('results-panel');
            const finalScore = document.getElementById('final-score');
            const selectedPatientSpan = document.getElementById('selected-patient');
            const patientDropzone = document.getElementById('patient-dropzone');
            const droppedMethodsDiv = document.getElementById('dropped-methods');
            const sliderThumb = document.getElementById('slider-thumb');
            const sliderTrack = document.getElementById('slider-track');
            const cyclePhase = document.getElementById('cycle-phase');
            const cycleDay = document.getElementById('cycle-day');
            const estrogenLevel = document.getElementById('estrogen-level');
            const progesteroneLevel = document.getElementById('progesterone-level');

            // Timer for time spent
            function updateTimer() {
                const now = new Date();
                const diff = Math.floor((now - state.startedAt) / 1000);
                state.timeSpent = diff;
                const minutes = Math.floor(diff / 60);
                const seconds = diff % 60;
                timeSpent.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
            setInterval(updateTimer, 1000);

            // Update Progress Summary
            function updateProgressSummary() {
                let completed = 0;
                let totalCorrect = 0;
                let totalItems = 0;

                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) completed++;
                    totalCorrect += activity.correct;
                    totalItems += activity.total;
                });

                completedCount.textContent = completed;
                const accuracy = totalItems > 0 ? Math.round((totalCorrect / totalItems) * 100) : 0;
                accuracyRate.textContent = `${accuracy}%`;

                // Update progress steps
                progressSteps.forEach((step, index) => {
                    if (index < completed) {
                        step.classList.add('completed');
                        step.classList.remove('active');
                    } else if (index === completed) {
                        step.classList.add('active');
                        step.classList.remove('completed');
                    } else {
                        step.classList.remove('active', 'completed');
                    }
                });
            }

            // Activity 1: Contraceptive Method Selection Simulator
            function initActivity1() {
                const patientCards = document.querySelectorAll('#activity-1 .patient-card');
                const methodItems = document.querySelectorAll('#activity-1 .method-item');
                const feedback = document.getElementById('feedback-1');
                const status = document.querySelector('#activity-1 .activity-status');

                // Initialize placed methods object
                state.placedMethods = {};

                // Patient selection
                patientCards.forEach(card => {
                    card.addEventListener('click', function() {
                        if (state.activities[1].completed) return;

                        // Deselect all
                        patientCards.forEach(c => c.classList.remove('selected'));
                        // Select this
                        this.classList.add('selected');
                        
                        state.selectedPatient = this.dataset.patient;
                        selectedPatientSpan.textContent = this.querySelector('.patient-age').textContent;
                        
                        // Clear previous methods
                        droppedMethodsDiv.innerHTML = '';
                        patientDropzone.classList.remove('empty');
                        
                        // Show existing methods if any
                        if (state.placedMethods[state.selectedPatient]) {
                            state.placedMethods[state.selectedPatient].forEach(method => {
                                addMethodToDropzone(method);
                            });
                        }
                    });
                });

                // Setup drag and drop for methods
                methodItems.forEach(item => {
                    item.addEventListener('dragstart', function(e) {
                        if (!state.selectedPatient) {
                            e.preventDefault();
                            return;
                        }
                        e.dataTransfer.setData('text/plain', JSON.stringify({
                            method: this.dataset.method,
                            text: this.textContent
                        }));
                        this.classList.add('dragging');
                    });

                    item.addEventListener('dragend', function() {
                        this.classList.remove('dragging');
                    });
                });

                // Dropzone setup
                patientDropzone.addEventListener('dragover', function(e) {
                    if (!state.selectedPatient) {
                        e.preventDefault();
                        return;
                    }
                    e.preventDefault();
                    this.classList.add('hover');
                });

                patientDropzone.addEventListener('dragleave', function() {
                    this.classList.remove('hover');
                });

                patientDropzone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('hover');
                    
                    if (!state.selectedPatient) {
                        alert('Please select a patient first');
                        return;
                    }

                    const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                    
                    // Initialize array if not exists
                    if (!state.placedMethods[state.selectedPatient]) {
                        state.placedMethods[state.selectedPatient] = [];
                    }
                    
                    // Check if method already placed for this patient
                    if (!state.placedMethods[state.selectedPatient].includes(data.method)) {
                        state.placedMethods[state.selectedPatient].push(data.method);
                        addMethodToDropzone(data.method, data.text);
                        
                        // Check completion
                        checkActivity1Completion();
                    }
                });

                function addMethodToDropzone(methodId, methodText = null) {
                    if (!methodText) {
                        const methodElement = Array.from(methodItems).find(item => item.dataset.method === methodId);
                        methodText = methodElement ? methodElement.textContent : methodId;
                    }
                    
                    const div = document.createElement('div');
                    div.className = 'dropped-method';
                    div.textContent = methodText;
                    div.dataset.method = methodId;
                    
                    // Add remove button
                    div.addEventListener('click', function(e) {
                        if (e.target === this && !state.activities[1].completed) {
                            const methodToRemove = this.dataset.method;
                            state.placedMethods[state.selectedPatient] = state.placedMethods[state.selectedPatient].filter(m => m !== methodToRemove);
                            this.remove();
                            
                            if (state.placedMethods[state.selectedPatient].length === 0) {
                                patientDropzone.classList.add('empty');
                            }
                        }
                    });
                    
                    droppedMethodsDiv.appendChild(div);
                    patientDropzone.classList.remove('empty');
                }

                function checkActivity1Completion() {
                    // Check if all patients have at least one method
                    const allPatients = ['1', '2', '3', '4', '5'];
                    const allHaveMethods = allPatients.every(patient => 
                        state.placedMethods[patient] && state.placedMethods[patient].length > 0
                    );

                    if (allHaveMethods) {
                        // Calculate score
                        let correctCount = 0;
                        
                        allPatients.forEach(patient => {
                            const placed = state.placedMethods[patient] || [];
                            const correct = correctRecommendations[patient];
                            
                            // Count correct methods (at least one correct method = point)
                            const hasCorrect = placed.some(method => correct.includes(method));
                            if (hasCorrect) correctCount++;
                        });
                        
                        state.activities[1].completed = true;
                        state.activities[1].correct = correctCount;
                        state.activities[1].score = Math.round((correctCount / 5) * 100);
                        
                        status.textContent = 'Completed';
                        status.style.color = '#00b894';
                        document.querySelector('#activity-1').classList.add('completed');
                        feedback.classList.add('show');
                        
                        updateProgressSummary();
                    }
                }
            }

            // Activity 2: Menstrual Cycle & Disorders Explorer
            function initActivity2() {
                const disorderCards = document.querySelectorAll('#activity-2 .disorder-card');
                const disorderItems = document.querySelectorAll('#activity-2 .disorder-item');
                const feedback = document.getElementById('feedback-2');
                const status = document.querySelector('#activity-2 .activity-status');

                // Initialize placed disorders object
                state.placedDisorders = {};

                // Menstrual cycle slider
                let isDragging = false;
                
                function updateCycleDisplay(day) {
                    day = Math.max(1, Math.min(28, day));
                    cycleDay.textContent = `Day ${day}`;
                    
                    // Update phase
                    if (day <= 14) {
                        cyclePhase.textContent = `Follicular Phase (Day 1-14)`;
                    } else {
                        cyclePhase.textContent = `Luteal Phase (Day 15-28)`;
                    }
                    
                    // Update hormone levels
                    let estrogenWidth, progesteroneWidth;
                    
                    if (day <= 14) {
                        estrogenWidth = 30 + (day / 14) * 70; // 30% to 100%
                        progesteroneWidth = 10;
                    } else {
                        estrogenWidth = 100 - ((day - 14) / 14) * 40; // 100% to 60%
                        progesteroneWidth = 10 + ((day - 14) / 14) * 90; // 10% to 100%
                    }
                    
                    estrogenLevel.style.width = `${estrogenWidth}%`;
                    progesteroneLevel.style.width = `${progesteroneWidth}%`;
                    
                    // Update thumb position
                    const percent = ((day - 1) / 27) * 100;
                    sliderThumb.style.left = `${percent}%`;
                }
                
                sliderThumb.addEventListener('mousedown', function(e) {
                    isDragging = true;
                    document.addEventListener('mousemove', onMouseMove);
                    document.addEventListener('mouseup', onMouseUp);
                });
                
                sliderThumb.addEventListener('touchstart', function(e) {
                    isDragging = true;
                    document.addEventListener('touchmove', onTouchMove);
                    document.addEventListener('touchend', onTouchEnd);
                });
                
                function onMouseMove(e) {
                    if (!isDragging) return;
                    const rect = sliderTrack.getBoundingClientRect();
                    let x = e.clientX - rect.left;
                    x = Math.max(0, Math.min(rect.width, x));
                    const percent = (x / rect.width) * 100;
                    const day = Math.round(1 + (percent / 100) * 27);
                    updateCycleDisplay(day);
                }
                
                function onMouseUp() {
                    isDragging = false;
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                }
                
                function onTouchMove(e) {
                    if (!isDragging) return;
                    const rect = sliderTrack.getBoundingClientRect();
                    let x = e.touches[0].clientX - rect.left;
                    x = Math.max(0, Math.min(rect.width, x));
                    const percent = (x / rect.width) * 100;
                    const day = Math.round(1 + (percent / 100) * 27);
                    updateCycleDisplay(day);
                }
                
                function onTouchEnd() {
                    isDragging = false;
                    document.removeEventListener('touchmove', onTouchMove);
                    document.removeEventListener('touchend', onTouchEnd);
                }
                
                // Also allow clicking on track
                sliderTrack.addEventListener('click', function(e) {
                    const rect = this.getBoundingClientRect();
                    let x = e.clientX - rect.left;
                    x = Math.max(0, Math.min(rect.width, x));
                    const percent = (x / rect.width) * 100;
                    const day = Math.round(1 + (percent / 100) * 27);
                    updateCycleDisplay(day);
                });
                
                // Initialize display
                updateCycleDisplay(1);

                // Setup drag and drop for disorders
                disorderItems.forEach(item => {
                    item.addEventListener('dragstart', function(e) {
                        e.dataTransfer.setData('text/plain', JSON.stringify({
                            disorder: this.dataset.disorder,
                            text: this.textContent
                        }));
                        this.classList.add('dragging');
                    });

                    item.addEventListener('dragend', function() {
                        this.classList.remove('dragging');
                    });
                });

                disorderCards.forEach(card => {
                    card.addEventListener('dragover', function(e) {
                        e.preventDefault();
                        this.classList.add('hover');
                    });

                    card.addEventListener('dragleave', function() {
                        this.classList.remove('hover');
                    });

                    card.addEventListener('drop', function(e) {
                        e.preventDefault();
                        this.classList.remove('hover');
                        
                        const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                        const targetDisorder = this.dataset.disorder;
                        
                        if (data.disorder === targetDisorder) {
                            // Check if item already placed
                            const existingItems = Array.from(this.querySelectorAll('.disorder-content div'));
                            const alreadyPlaced = existingItems.some(div => div.textContent === data.text);
                            
                            if (!alreadyPlaced) {
                                // Add to card
                                const div = document.createElement('div');
                                div.textContent = data.text;
                                div.style.padding = '6px 10px';
                                div.style.margin = '4px 0';
                                div.style.background = 'rgba(0, 184, 148, 0.1)';
                                div.style.borderRadius = '8px';
                                div.style.fontSize = '0.8rem';
                                this.querySelector('.disorder-content').appendChild(div);
                                
                                // Hide original item
                                const originalItem = Array.from(disorderItems).find(item => 
                                    item.textContent === data.text && item.style.display !== 'none'
                                );
                                if (originalItem) {
                                    originalItem.style.display = 'none';
                                }
                                
                                // Initialize array if not exists
                                if (!state.placedDisorders[targetDisorder]) {
                                    state.placedDisorders[targetDisorder] = [];
                                }
                                
                                // Add to placed items
                                if (!state.placedDisorders[targetDisorder].includes(data.text)) {
                                    state.placedDisorders[targetDisorder].push(data.text);
                                }
                                
                                this.classList.add('filled');
                                
                                // Check completion
                                checkActivity2Completion();
                            }
                        } else {
                            // Wrong category - visual feedback
                            this.classList.add('hover');
                            setTimeout(() => {
                                this.classList.remove('hover');
                            }, 500);
                        }
                    });
                });

                function checkActivity2Completion() {
                    // Check if all disorders have 2 items each
                    const allDisorders = ['pcos', 'endometriosis', 'fibroids', 'dysmenorrhea', 'yeast', 'bv'];
                    const allComplete = allDisorders.every(disorder => 
                        state.placedDisorders[disorder] && state.placedDisorders[disorder].length === 2
                    );

                    if (allComplete) {
                        // Calculate score
                        let correctCount = 0;
                        
                        allDisorders.forEach(disorder => {
                            const placed = state.placedDisorders[disorder] || [];
                            const correct = correctDisorderMatches[disorder];
                            
                            // Check if both correct items are placed
                            const allCorrect = correct.every(item => placed.includes(item));
                            if (allCorrect) correctCount++;
                        });
                        
                        state.activities[2].completed = true;
                        state.activities[2].correct = correctCount;
                        state.activities[2].score = Math.round((correctCount / 6) * 100);
                        
                        status.textContent = 'Completed';
                        status.style.color = '#00b894';
                        document.querySelector('#activity-2').classList.add('completed');
                        feedback.classList.add('show');
                        
                        updateProgressSummary();
                    }
                }
            }

            // Reset All Activities
            function resetAllActivities() {
                // Reset state
                Object.keys(state.activities).forEach(key => {
                    state.activities[key] = {
                        completed: false,
                        correct: 0,
                        total: parseInt(key) === 1 ? 5 : 6,
                        score: 0
                    };
                });
                
                state.selectedPatient = null;
                state.placedMethods = {};
                state.placedDisorders = {};

                // Reset UI
                activityCards.forEach(card => {
                    card.classList.remove('completed');
                    const status = card.querySelector('.activity-status');
                    status.textContent = 'Not Started';
                    status.style.color = '';
                    const feedback = card.querySelector('.feedback-container');
                    feedback.classList.remove('show');
                });

                // Reset Activity 1
                document.querySelectorAll('#activity-1 .patient-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                selectedPatientSpan.textContent = 'None';
                droppedMethodsDiv.innerHTML = '';
                patientDropzone.classList.add('empty');
                
                document.querySelectorAll('#activity-1 .method-item').forEach(item => {
                    item.style.display = '';
                });

                // Reset Activity 2
                updateCycleDisplay(1);
                
                document.querySelectorAll('#activity-2 .disorder-content').forEach(content => {
                    content.innerHTML = '';
                });
                
                document.querySelectorAll('#activity-2 .disorder-card').forEach(card => {
                    card.classList.remove('filled', 'hover');
                });
                
                document.querySelectorAll('#activity-2 .disorder-item').forEach(item => {
                    item.style.display = '';
                });

                // Reset results
                resultsPanel.classList.remove('show');

                // Update progress
                updateProgressSummary();
            }

            // Check All Answers
            function checkAllAnswers() {
                // Activity 1
                if (!state.activities[1].completed) {
                    // Auto-place correct answers for demonstration
                    const allPatients = ['1', '2', '3', '4', '5'];
                    state.placedMethods = {};
                    
                    allPatients.forEach(patient => {
                        state.placedMethods[patient] = correctRecommendations[patient].slice(0, 2);
                    });
                    
                    // Select first patient for display
                    document.querySelector('#activity-1 .patient-card[data-patient="1"]').click();
                    
                    const feedback = document.getElementById('feedback-1');
                    const status = document.querySelector('#activity-1 .activity-status');
                    
                    state.activities[1].completed = true;
                    state.activities[1].correct = 5;
                    state.activities[1].score = 100;
                    
                    status.textContent = 'Completed';
                    status.style.color = '#00b894';
                    document.querySelector('#activity-1').classList.add('completed');
                    feedback.classList.add('show');
                    
                    // Update dropzone display
                    droppedMethodsDiv.innerHTML = '';
                    correctRecommendations[1].forEach(methodId => {
                        const methodElement = Array.from(document.querySelectorAll('#activity-1 .method-item'))
                            .find(item => item.dataset.method === methodId);
                        if (methodElement) {
                            addMethodToDropzone(methodId, methodElement.textContent);
                        }
                    });
                }

                // Activity 2
                if (!state.activities[2].completed) {
                    const allDisorders = ['pcos', 'endometriosis', 'fibroids', 'dysmenorrhea', 'yeast', 'bv'];
                    state.placedDisorders = {};
                    
                    allDisorders.forEach(disorder => {
                        state.placedDisorders[disorder] = correctDisorderMatches[disorder];
                    });
                    
                    const feedback = document.getElementById('feedback-2');
                    const status = document.querySelector('#activity-2 .activity-status');
                    
                    state.activities[2].completed = true;
                    state.activities[2].correct = 6;
                    state.activities[2].score = 100;
                    
                    status.textContent = 'Completed';
                    status.style.color = '#00b894';
                    document.querySelector('#activity-2').classList.add('completed');
                    feedback.classList.add('show');
                    
                    // Update disorder cards display
                    allDisorders.forEach(disorder => {
                        const card = document.getElementById(`disorder-${disorder}`);
                        const content = card.querySelector('.disorder-content');
                        content.innerHTML = '';
                        
                        correctDisorderMatches[disorder].forEach(text => {
                            const div = document.createElement('div');
                            div.textContent = text;
                            div.style.padding = '6px 10px';
                            div.style.margin = '4px 0';
                            div.style.background = 'rgba(0, 184, 148, 0.1)';
                            div.style.borderRadius = '8px';
                            div.style.fontSize = '0.8rem';
                            content.appendChild(div);
                        });
                        
                        card.classList.add('filled');
                        
                        // Hide the correct items
                        correctDisorderMatches[disorder].forEach(text => {
                            const item = Array.from(document.querySelectorAll('#activity-2 .disorder-item'))
                                .find(item => item.textContent === text);
                            if (item) item.style.display = 'none';
                        });
                    });
                }

                updateProgressSummary();
            }

            // Helper function for Activity 1
            function addMethodToDropzone(methodId, methodText) {
                const div = document.createElement('div');
                div.className = 'dropped-method';
                div.textContent = methodText;
                div.dataset.method = methodId;
                droppedMethodsDiv.appendChild(div);
                patientDropzone.classList.remove('empty');
            }

            // View Final Results
            function viewFinalResults() {
                let totalScore = 0;
                let activityCount = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) {
                        totalScore += activity.score;
                        activityCount++;
                    }
                });
                
                const averageScore = activityCount > 0 ? Math.round(totalScore / activityCount) : 0;
                finalScore.textContent = `${averageScore}%`;
                resultsPanel.classList.add('show');
                
                // Scroll to results
                resultsPanel.scrollIntoView({ behavior: 'smooth' });
            }

            // Initialize all activities
            initActivity1();
            initActivity2();

            // Event listeners
            resetBtn.addEventListener('click', resetAllActivities);
            checkBtn.addEventListener('click', checkAllAnswers);
            resultsBtn.addEventListener('click', viewFinalResults);

            // Initial progress update
            updateProgressSummary();
        });
    </script>
</body>
</html>
