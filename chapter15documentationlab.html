<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ALLIEDRx -- Chapter 4: Documentation Lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        /* === ALLIEDRx BRANDING EXACT MATCH === */
        :root {
            --color-primary: #af4bef; /* Purple - main brand color */
            --color-primary-soft: #d492ff; /* Light purple */
            --color-accent: #8380f0; /* Blue-purple accent */
            --color-success: #00b894; /* Green for correct/success */
            --color-warning: #fdcb6e;
            --color-error: #e17055; /* Red/Orange for errors */
            --color-bg: #f7f5fb; /* Light background */
            --color-text: #2b2b2b; /* Dark text */
            --color-muted: #6c6880; /* Muted text */
            --radius-lg: 24px;
            --radius-md: 16px;
            --radius-sm: 12px;
            --shadow-soft: 0 18px 45px rgba(23, 10, 61, 0.18);
            --shadow-medium: 0 12px 30px rgba(23, 10, 61, 0.12);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            overflow-x: hidden;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        body {
            padding: 24px;
            background: radial-gradient(
                circle at top left,
                #ffffff 0,
                #f1ecff 40%,
                var(--color-bg) 100%
            );
            color: var(--color-text);
            -webkit-text-size-adjust: 100%;
        }

        @media (max-width: 600px) {
            body {
                padding: 12px;
            }
        }

        /* === ANIMATIONS === */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes checkmarkPop {
            0% { transform: scale(0); opacity: 0; }
            70% { transform: scale(1.2); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* === MAIN PAGE CONTAINER === */
        .page {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 28px 30px 32px;
            display: flex;
            flex-direction: column;
            gap: 32px;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.6s ease-out;
        }

        @media (max-width: 900px) {
            .page {
                padding: 22px;
                gap: 28px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 0;
            }
            .page {
                border-radius: 0;
                box-shadow: none;
                padding: 18px 14px 22px;
                gap: 24px;
            }
        }

        /* === ALLIEDRx HEADER/BRANDING === */
        .brand-row {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 14px;
            margin-bottom: 8px;
            flex-wrap: wrap;
            width: 100%;
            animation: fadeInUp 0.5s ease-out;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .brand-logo {
            height: 40px;
            width: auto;
            max-width: 100%;
            filter: drop-shadow(0 3px 8px rgba(0, 0, 0, 0.2));
        }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 2px;
            max-width: 100%;
        }

        .course-name {
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: var(--color-muted);
            white-space: normal;
        }

        .week-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 10px;
            border-radius: 999px;
            background: rgba(175, 75, 239, 0.08);
            font-size: 0.76rem;
            color: var(--color-primary);
            white-space: normal;
        }

        .week-label-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--color-success);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }

        .badge-mode {
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(12, 10, 24, 0.06);
            border: 1px solid rgba(12, 10, 24, 0.08);
            font-size: 0.74rem;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: var(--color-muted);
            white-space: nowrap;
        }

        @media (max-width: 480px) {
            .brand-row {
                flex-direction: column;
                align-items: flex-start;
            }
            .badge-mode {
                margin-top: 6px;
            }
        }

        /* === MODULE HEADER === */
        .module-header {
            animation: fadeInUp 0.5s ease-out 0.1s both;
        }

        h1 {
            font-size: clamp(2rem, 3vw, 2.4rem);
            line-height: 1.05;
            color: var(--color-primary);
            margin-bottom: 6px;
        }

        .module-subtitle {
            font-size: 1.1rem;
            color: var(--color-muted);
            max-width: 800px;
            margin-bottom: 6px;
        }

        .module-description {
            font-size: 0.98rem;
            color: var(--color-muted);
            max-width: 800px;
            line-height: 1.6;
        }

        /* === PROGRESS TRACKER === */
        .progress-tracker {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 8px 0 20px;
            animation: fadeInUp 0.5s ease-out 0.2s both;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--color-muted);
        }

        .progress-step.active {
            color: var(--color-primary);
            font-weight: 600;
        }

        .progress-step.completed {
            color: var(--color-success);
        }

        .step-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(12, 10, 24, 0.06);
            color: var(--color-muted);
        }

        .progress-step.active .step-icon {
            background: var(--color-primary);
            color: white;
        }

        .progress-step.completed .step-icon {
            background: var(--color-success);
            color: white;
        }

        .step-divider {
            flex: 1;
            height: 2px;
            background: rgba(12, 10, 24, 0.1);
            margin: 0 8px;
        }

        /* === PROGRESS SUMMARY === */
        .progress-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 16px;
            padding: 16px;
            background: rgba(175, 75, 239, 0.03);
            border-radius: var(--radius-sm);
            animation: fadeInUp 0.5s ease-out 0.3s both;
        }

        @media (max-width: 480px) {
            .progress-summary {
                grid-template-columns: 1fr;
                gap: 12px;
            }
        }

        .progress-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .progress-number {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--color-primary);
        }

        .progress-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-align: center;
        }

        /* === ACTIVITY GRID === */
        .activity-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 32px;
            margin-bottom: 24px;
            animation: fadeInUp 0.5s ease-out 0.3s both;
        }

        /* === ACTIVITY CARDS === */
        .activity-card {
            background: rgba(175, 75, 239, 0.03);
            border-radius: var(--radius-md);
            border: 1px solid rgba(175, 75, 239, 0.1);
            padding: 28px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .activity-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
        }

        .activity-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .activity-icon {
            width: 42px;
            height: 42px;
            border-radius: 12px;
            background: var(--color-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .activity-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--color-text);
        }

        .activity-description {
            font-size: 1rem;
            color: var(--color-muted);
            line-height: 1.6;
            margin-bottom: 8px;
        }

        /* === CLINICAL TIP STYLES === */
        .clinical-tip {
            margin: 20px 0;
            padding: 16px 20px;
            background: rgba(175, 75, 239, 0.05);
            border-left: 4px solid var(--color-primary);
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .tip-label {
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* === ACTIVITY 1: SOAP NOTE COMPLETION === */
        .soap-container {
            display: flex;
            flex-direction: column;
            gap: 28px;
        }

        .soap-scenario {
            background: white;
            border-radius: var(--radius-md);
            padding: 24px;
            border: 1px solid rgba(12, 10, 24, 0.08);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .patient-info {
            font-weight: 700;
            color: var(--color-primary);
            font-size: 1.2rem;
            margin-bottom: 8px;
        }

        .patient-demographics {
            font-size: 1rem;
            color: var(--color-muted);
            margin-bottom: 12px;
        }

        .scenario-text {
            color: var(--color-text);
            margin-bottom: 16px;
            line-height: 1.6;
            font-size: 1rem;
        }

        .scenario-text strong {
            color: var(--color-muted);
        }

        .soap-instruction {
            font-size: 1rem;
            color: var(--color-muted);
            margin-bottom: 16px;
            font-style: italic;
            padding: 16px;
            background: rgba(175, 75, 239, 0.05);
            border-radius: var(--radius-sm);
            line-height: 1.5;
        }

        .soap-note-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 24px 0;
        }

        @media (max-width: 768px) {
            .soap-note-grid {
                grid-template-columns: 1fr;
            }
        }

        .soap-section {
            background: white;
            border-radius: var(--radius-sm);
            padding: 24px;
            border: 3px dashed #ddd;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            min-height: 200px;
        }

        .soap-section:hover {
            border-color: var(--color-primary-soft);
            background-color: rgba(175, 75, 239, 0.03);
        }

        .soap-section.correct-drop {
            border-color: var(--color-success);
            background-color: rgba(0, 184, 148, 0.05);
        }

        .soap-section.incorrect-drop {
            border-color: var(--color-error);
            background-color: rgba(225, 112, 85, 0.05);
        }

        .section-title {
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 16px;
            font-size: 1.1rem;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(175, 75, 239, 0.2);
        }

        .section-instruction {
            font-size: 0.95rem;
            color: var(--color-muted);
            line-height: 1.4;
            margin-bottom: 16px;
        }

        .soap-phrases {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin: 24px 0;
            justify-content: center;
        }

        .soap-phrase {
            background: white;
            border: 3px solid var(--color-accent);
            color: var(--color-text);
            padding: 12px 20px;
            border-radius: 24px;
            font-size: 1rem;
            cursor: grab;
            transition: all 0.2s ease;
            user-select: none;
            font-weight: 600;
            max-width: 300px;
            text-align: center;
        }

        .soap-phrase:hover {
            background: var(--color-accent);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(131, 128, 240, 0.3);
        }

        .soap-phrase.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }

        .soap-phrase.placed {
            background: var(--color-success);
            color: white;
            border-color: var(--color-success);
            cursor: default;
        }

        /* === FEEDBACK SECTION - ALWAYS VISIBLE === */
        .feedback-details {
            margin-top: 24px;
            padding: 20px;
            background: rgba(175, 75, 239, 0.03);
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--color-accent);
            display: block;
            animation: fadeIn 0.5s ease;
            min-height: 100px;
        }

        .feedback-title {
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 12px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feedback-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .feedback-item {
            margin-bottom: 12px;
            padding-left: 24px;
            position: relative;
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .feedback-item.correct:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--color-success);
            font-weight: bold;
        }

        .feedback-item.incorrect:before {
            content: "‚úó";
            position: absolute;
            left: 0;
            color: var(--color-error);
            font-weight: bold;
        }

        .feedback-item.tip:before {
            content: "üí°";
            position: absolute;
            left: 0;
        }

        /* === ACTIVITY 2: EHR DOCUMENTATION SCENARIOS === */
        .ehr-container {
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .ehr-scenario {
            background: white;
            border-radius: var(--radius-md);
            padding: 24px;
            border: 1px solid rgba(12, 10, 24, 0.08);
        }

        .section-title {
            font-size: 1.2rem;
            color: var(--color-primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--color-primary-soft);
        }

        .ehr-instruction {
            font-size: 1rem;
            color: var(--color-muted);
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .ehr-options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        @media (max-width: 768px) {
            .ehr-options-grid {
                grid-template-columns: 1fr;
            }
        }

        .ehr-option {
            background: white;
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 2px solid rgba(12, 10, 24, 0.08);
            display: flex;
            flex-direction: column;
            gap: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .ehr-option:hover {
            transform: translateY(-2px);
            border-color: var(--color-primary-soft);
            box-shadow: var(--shadow-medium);
        }

        .ehr-option.selected {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.05);
        }

        .ehr-option.correct {
            border-color: var(--color-success);
            background: rgba(0, 184, 148, 0.05);
        }

        .ehr-option.incorrect {
            border-color: var(--color-error);
            background: rgba(225, 112, 85, 0.05);
        }

        .ehr-header {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .ehr-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--color-muted);
            border-radius: 4px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
        }

        .ehr-option.selected .ehr-checkbox {
            background: var(--color-primary);
            border-color: var(--color-primary);
        }

        .ehr-option.correct .ehr-checkbox {
            background: var(--color-success);
            border-color: var(--color-success);
        }

        .ehr-option.incorrect .ehr-checkbox {
            background: var(--color-error);
            border-color: var(--color-error);
        }

        .ehr-text {
            font-size: 1rem;
            font-weight: 500;
            color: var(--color-text);
            line-height: 1.5;
        }

        /* === ACTIVITY 3: HIPAA VIOLATION IDENTIFICATION === */
        .hipaa-sequence {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 24px;
        }

        .hipaa-step {
            background: white;
            border-radius: var(--radius-md);
            padding: 20px;
            border-left: 4px solid var(--color-primary);
            display: flex;
            align-items: flex-start;
            gap: 16px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .hipaa-step:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-medium);
        }

        .hipaa-step.active {
            background: rgba(175, 75, 239, 0.05);
        }

        .hipaa-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--color-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
            font-weight: 700;
            flex-shrink: 0;
            transition: background 0.3s ease;
        }

        .hipaa-content {
            flex: 1;
        }

        .hipaa-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 4px;
        }

        .hipaa-description {
            font-size: 0.9rem;
            color: var(--color-muted);
            line-height: 1.6;
        }

        /* === ACTIVITY 4: MEDICAL TERMINOLOGY MATCHING === */
        .terminology-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 32px;
        }

        @media (max-width: 768px) {
            .terminology-container {
                grid-template-columns: 1fr;
            }
        }

        .terminology-column {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .term-item {
            background: white;
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 2px solid rgba(12, 10, 24, 0.08);
            cursor: grab;
            user-select: none;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            line-height: 1.5;
            font-weight: 500;
        }

        .term-item:hover {
            transform: translateY(-2px);
            border-color: var(--color-primary-soft);
            box-shadow: var(--shadow-medium);
        }

        .term-item.dragging {
            opacity: 0.7;
            transform: rotate(3deg);
        }

        .term-item.matched {
            border-color: var(--color-success);
            background: rgba(0, 184, 148, 0.05);
        }

        .term-item.incorrect-match {
            border-color: var(--color-error);
            background: rgba(225, 112, 85, 0.05);
        }

        .term-category {
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .term-drop-zones {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 32px;
        }

        @media (max-width: 768px) {
            .term-drop-zones {
                grid-template-columns: 1fr;
            }
        }

        .term-drop-zone {
            min-height: 120px;
            border: 3px dashed var(--color-primary-soft);
            border-radius: var(--radius-sm);
            padding: 20px;
            background: rgba(175, 75, 239, 0.03);
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: flex-start;
        }

        .term-drop-zone.active {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.08);
        }

        /* === ACTION BUTTONS === */
        .action-buttons {
            display: flex;
            gap: 16px;
            margin-top: 32px;
            animation: fadeInUp 0.5s ease-out 0.4s both;
        }

        .btn {
            padding: 14px 28px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #9a3ed8;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(175, 75, 239, 0.3);
        }

        .btn-secondary {
            background: rgba(12, 10, 24, 0.06);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: rgba(12, 10, 24, 0.12);
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* === ACTIVITY BUTTONS === */
        .activity-btn {
            padding: 12px 24px;
            background: var(--color-primary);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            align-self: flex-start;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .activity-btn:hover {
            background: #9a3ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(175, 75, 239, 0.3);
        }

        /* === RESULTS PANEL === */
        .results-panel {
            background: rgba(12, 10, 24, 0.94);
            color: #e5e7eb;
            border-radius: var(--radius-md);
            padding: 32px;
            margin-top: 32px;
            display: none;
            animation: fadeIn 0.6s ease;
        }

        .results-panel.show {
            display: block;
        }

        .results-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .results-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: #ffffff;
        }

        .results-content {
            font-size: 1rem;
            line-height: 1.7;
        }

        .results-content strong {
            color: #ffffff;
        }

        .score-display {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 24px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
        }

        .score-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--color-primary-soft);
        }

        .score-text {
            font-size: 1rem;
            color: #c4b5fd;
        }

        /* === CLINICAL INSIGHT CARD === */
        .clinical-insight {
            margin-top: 24px;
            border-radius: var(--radius-sm);
            border: 1px solid rgba(255, 255, 255, 0.16);
            background: rgba(15, 23, 42, 0.7);
            padding: 20px;
            font-size: 0.95rem;
            color: #e5e7eb;
            line-height: 1.6;
        }

        .clinical-insight strong {
            color: #fef3c7;
        }

        /* === FEEDBACK MESSAGES === */
        .feedback-message {
            padding: 16px 20px;
            border-radius: var(--radius-sm);
            margin-top: 16px;
            font-size: 1rem;
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .feedback-correct {
            background: rgba(0, 184, 148, 0.1);
            border-left: 4px solid var(--color-success);
            color: var(--color-success);
            display: block;
        }

        .feedback-incorrect {
            background: rgba(225, 112, 85, 0.1);
            border-left: 4px solid var(--color-error);
            color: var(--color-error);
            display: block;
        }

        /* === RESPONSIVE ADJUSTMENTS === */
        @media (max-width: 768px) {
            .activity-grid {
                gap: 24px;
            }
            .activity-card {
                padding: 20px;
            }
            .action-buttons {
                flex-direction: column;
            }
            .btn {
                width: 100%;
                justify-content: center;
            }
            .soap-note-grid {
                gap: 16px;
            }
            .soap-phrases {
                gap: 10px;
            }
            .ehr-options-grid {
                gap: 12px;
            }
        }

        @media (max-width: 480px) {
            .progress-tracker {
                flex-wrap: wrap;
                justify-content: center;
            }
            .step-divider {
                display: none;
            }
            .terminology-container {
                gap: 16px;
            }
            .term-drop-zones {
                gap: 16px;
            }
        }
    </style>
</head>
<body>
    <main class="page" aria-labelledby="module-heading">
        <!-- Header -->
        <header class="brand-row">
            <div class="brand">
                <img
                    src="https://cdn.prod.website-files.com/64d0ccc1558d601cbfb09021/64e9d2f719b1e5258e5d57f5_IMG_1512-p-500.png"
                    alt="AlliedRx logo"
                    class="brand-logo"
                />
                <div class="course-meta">
                    <span class="course-name">Clinical Medical Assistant ‚Ä¢ Kinn's Chapter 4</span>
                    <div class="week-label">
                        <span class="week-label-dot"></span>
                        <span>Interactive Module 2: Documentation Lab</span>
                    </div>
                </div>
            </div>
            <span class="badge-mode">Campus & Online</span>
        </header>

        <!-- Module Header -->
        <section class="module-header">
            <h1 id="module-heading">Documentation Lab</h1>
            <p class="module-subtitle">Master SOAP notes, EHR documentation, HIPAA compliance, and medical terminology</p>
            <p class="module-description">
                This interactive module covers Objectives 10-14 from Chapter 4. You'll practice accurate documentation, 
                identify HIPAA violations, complete SOAP notes, and match medical terminology.
            </p>
        </section>

        <!-- Clinical Tip -->
        <div class="clinical-tip">
            <div class="tip-label">üí° Clinical Insight</div>
            <p><strong>"If it wasn't documented, it wasn't done."</strong>‚ÄîAccurate, timely, and complete documentation protects both patients and healthcare providers. Always document objectively, avoiding opinions or assumptions.</p>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-step active">
                <span class="step-icon">1</span>
                <span>SOAP Note Completion</span>
            </div>
            <div class="step-divider"></div>
            <div class="progress-step">
                <span class="step-icon">2</span>
                <span>EHR Documentation</span>
            </div>
            <div class="step-divider"></div>
            <div class="progress-step">
                <span class="step-icon">3</span>
                <span>HIPAA Violations</span>
            </div>
            <div class="step-divider"></div>
            <div class="progress-step">
                <span class="step-icon">4</span>
                <span>Medical Terminology</span>
            </div>
        </div>

        <!-- Progress Summary -->
        <div class="progress-summary">
            <div class="progress-item">
                <span class="progress-number" id="completedCount">0</span>
                <span class="progress-label">Activities Completed</span>
            </div>
            <div class="progress-item">
                <span class="progress-number" id="accuracyScore">0%</span>
                <span class="progress-label">Current Accuracy</span>
            </div>
            <div class="progress-item">
                <span class="progress-number" id="timeSpent">0 min</span>
                <span class="progress-label">Time Spent</span>
            </div>
        </div>

        <!-- Activity Grid -->
        <div class="activity-grid">
            <!-- ACTIVITY 1: SOAP NOTE COMPLETION -->
            <section class="activity-card" aria-label="SOAP Note Completion Activity">
                <div class="activity-header">
                    <div class="activity-icon">üìù</div>
                    <h2 class="activity-title">Complete the SOAP Note</h2>
                </div>
                <p class="activity-description">
                    <strong>Instructions:</strong> Review the patient scenario and drag the appropriate documentation 
                    phrases to complete each section of the SOAP note.
                </p>
                
                <div class="soap-container">
                    <div class="soap-scenario">
                        <div class="scenario-header">
                            <div>
                                <div class="patient-info">Patient: Maria Rodriguez, 52 years old</div>
                                <div class="patient-demographics">Established patient with Type 2 Diabetes</div>
                            </div>
                        </div>
                        
                        <div class="scenario-text">
                            <strong>Chief Complaint:</strong> "My blood sugar has been high all week, around 250-300."<br>
                            <strong>History of Present Illness:</strong> Patient reports increased thirst, frequent urination, and fatigue for 1 week. 
                            Has been checking blood glucose 2x daily. Last A1c was 7.8% three months ago.<br>
                            <strong>Medications:</strong> Metformin 1000mg BID, Lisinopril 10mg daily.<br>
                            <strong>Vitals:</strong> BP 138/82, HR 88, Temp 98.6¬∞F, Weight 185 lbs.
                        </div>
                        
                        <div class="soap-instruction">
                            <strong>Pro Tip:</strong> SOAP notes follow a specific structure: 
                            <strong>S</strong>ubjective (patient's words), 
                            <strong>O</strong>bjective (measurable data), 
                            <strong>A</strong>ssessment (your analysis), 
                            <strong>P</strong>lan (next steps).
                        </div>
                        
                        <div class="soap-note-grid">
                            <div class="soap-section" data-section="subjective" id="section-subjective">
                                <div class="section-title">S - Subjective</div>
                                <div class="section-instruction">Patient's own words about symptoms, concerns, history</div>
                            </div>
                            <div class="soap-section" data-section="objective" id="section-objective">
                                <div class="section-title">O - Objective</div>
                                <div class="section-instruction">Measurable, observable data (vitals, exam findings)</div>
                            </div>
                            <div class="soap-section" data-section="assessment" id="section-assessment">
                                <div class="section-title">A - Assessment</div>
                                <div class="section-instruction">Your diagnosis, analysis, or clinical impression</div>
                            </div>
                            <div class="soap-section" data-section="plan" id="section-plan">
                                <div class="section-title">P - Plan</div>
                                <div class="section-instruction">Treatment, follow-up, education, referrals</div>
                            </div>
                        </div>
                        
                        <div class="soap-phrases">
                            <div class="soap-phrase" data-phrase="subjective1" id="phrase-thirst" draggable="true">
                                "Increased thirst and frequent urination for 1 week"
                            </div>
                            <div class="soap-phrase" data-phrase="objective1" id="phrase-vitals" draggable="true">
                                BP 138/82, HR 88, Weight 185 lbs
                            </div>
                            <div class="soap-phrase" data-phrase="assessment1" id="phrase-uncontrolled" draggable="true">
                                Uncontrolled Type 2 Diabetes
                            </div>
                            <div class="soap-phrase" data-phrase="plan1" id="phrase-labs" draggable="true">
                                Order A1c, basic metabolic panel, urinalysis
                            </div>
                            <div class="soap-phrase" data-phrase="subjective2" id="phrase-fatigue" draggable="true">
                                Reports fatigue and blood glucose readings 250-300
                            </div>
                            <div class="soap-phrase" data-phrase="objective2" id="phrase-meds" draggable="true">
                                Current medications: Metformin 1000mg BID, Lisinopril 10mg daily
                            </div>
                            <div class="soap-phrase" data-phrase="assessment2" id="phrase-need" draggable="true">
                                Need for medication adjustment and diabetes education
                            </div>
                            <div class="soap-phrase" data-phrase="plan2" id="phrase-followup" draggable="true">
                                Schedule follow-up in 2 weeks, provide glucose log
                            </div>
                        </div>
                        
                        <div style="margin-top: 24px;">
                            <button class="activity-btn" id="checkSoapBtn">
                                ‚úì Check SOAP Note
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- FEEDBACK SECTION - ALWAYS VISIBLE -->
                <div class="feedback-details" id="soapFeedbackDetails">
                    <div class="feedback-title">
                        <span>üìã SOAP Note Feedback:</span>
                    </div>
                    <div style="color: var(--color-muted); font-style: italic; margin-bottom: 12px;">
                        Complete the SOAP note above, then click "Check SOAP Note" to see detailed feedback here.
                    </div>
                    <ul class="feedback-list" id="soapFeedbackList">
                        <!-- Feedback will appear here after checking -->
                    </ul>
                </div>
                
                <div class="feedback-message" id="soapFeedback"></div>
            </section>

            <!-- ACTIVITY 2: EHR DOCUMENTATION SCENARIOS -->
            <section class="activity-card" aria-label="EHR Documentation Activity">
                <div class="activity-header">
                    <div class="activity-icon">üíª</div>
                    <h2 class="activity-title">EHR Documentation Scenarios</h2>
                </div>
                <p class="activity-description">
                    <strong>Instructions:</strong> For each scenario, select the most appropriate EHR documentation action. 
                    Consider "meaningful use" requirements and legal/ethical standards.
                </p>
                
                <div class="ehr-container">
                    <!-- Scenario 1 -->
                    <div class="ehr-scenario">
                        <h3 class="section-title">Scenario 1: Medication Documentation</h3>
                        <div class="ehr-instruction">
                            Dr. Chen verbally ordered "increase lisinopril to 20mg daily" during a patient visit. 
                            The MA administered the first dose in-office. What is the correct EHR documentation sequence?
                        </div>

                        <div class="ehr-options-grid">
                            <div class="ehr-option" data-scenario="1" data-answer="correct">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">1. Document verbal order in EHR<br>2. Update medication list<br>3. Document administration with time/date<br>4. Have provider co-sign</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="1" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">Wait until end of day to document all orders together</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="1" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">Document only in paper chart since it was a verbal order</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="1" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">Document administration but not the verbal order</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Scenario 2 -->
                    <div class="ehr-scenario">
                        <h3 class="section-title">Scenario 2: "Meaningful Use" Requirement</h3>
                        <div class="ehr-instruction">
                            Which documentation practice demonstrates "meaningful use" of the EHR for quality improvement?
                        </div>

                        <div class="ehr-options-grid">
                            <div class="ehr-option" data-scenario="2" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">Using copy/paste for all progress notes</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="2" data-answer="correct">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">Using structured data fields for smoking status, BMI, and medications</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="2" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">Documenting only minimal information to save time</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="2" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">Using free text only, no structured templates</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Scenario 3 -->
                    <div class="ehr-scenario">
                        <h3 class="section-title">Scenario 3: Allergy Documentation</h3>
                        <div class="ehr-instruction">
                            A patient reports a "bad reaction to penicillin as a child‚Äîhives and swelling." 
                            How should this be documented in the EHR?
                        </div>

                        <div class="ehr-options-grid">
                            <div class="ehr-option" data-scenario="3" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">"Allergy to penicillin" with no details</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="3" data-answer="correct">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">"Allergy: Penicillin - Reaction: Hives, facial swelling (childhood)"</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="3" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">Document only if prescribing antibiotics today</div>
                                </div>
                            </div>
                            
                            <div class="ehr-option" data-scenario="3" data-answer="incorrect">
                                <div class="ehr-header">
                                    <div class="ehr-checkbox"></div>
                                    <div class="ehr-text">"Possible penicillin allergy" without details</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 24px;">
                    <button class="activity-btn" id="checkEhrBtn">
                        ‚úì Check EHR Documentation
                    </button>
                </div>
                
                <div class="feedback-message" id="ehrFeedback"></div>
                
                <div style="margin-top: 24px; padding: 20px; background: rgba(175, 75, 239, 0.05); border-radius: var(--radius-sm); font-size: 0.95rem;">
                    <strong>Clinical Tip:</strong> EHR documentation must be timely, accurate, and complete. 
                    "Meaningful use" requires structured data that can be used for quality reporting and care coordination. 
                    Always include reaction details for allergies and document verbal orders immediately.
                </div>
            </section>

            <!-- ACTIVITY 3: HIPAA VIOLATION IDENTIFICATION -->
            <section class="activity-card" aria-label="HIPAA Violation Activity">
                <div class="activity-header">
                    <div class="activity-icon">üö´</div>
                    <h2 class="activity-title">Identify HIPAA Violations</h2>
                </div>
                <p class="activity-description">
                    <strong>Instructions:</strong> Click each scenario in order from most serious to least serious 
                    HIPAA violation. Consider both privacy and security rules.
                </p>
                
                <div class="hipaa-sequence">
                    <div class="hipaa-step" data-step="1" data-order="4">
                        <div class="hipaa-number">?</div>
                        <div class="hipaa-content">
                            <div class="hipaa-title">Left patient chart unattended in waiting room</div>
                            <div class="hipaa-description">Chart visible to other patients for 15 minutes</div>
                        </div>
                    </div>
                    
                    <div class="hipaa-step" data-step="2" data-order="1">
                        <div class="hipaa-number">?</div>
                        <div class="hipaa-content">
                            <div class="hipaa-title">Posted patient photos on social media</div>
                            <div class="hipaa-description">Shared photos from office holiday party with patients visible</div>
                        </div>
                    </div>
                    
                    <div class="hipaa-step" data-step="3" data-order="3">
                        <div class="hipaa-number">?</div>
                        <div class="hipaa-content">
                            <div class="hipaa-title">Discussed patient in elevator</div>
                            <div class="hipaa-description">Talked about patient's HIV status where others could hear</div>
                        </div>
                    </div>
                    
                    <div class="hipaa-step" data-step="4" data-order="2">
                        <div class="hipaa-number">?</div>
                        <div class="hipaa-content">
                            <div class="hipaa-title">EMR accessed without authorization</div>
                            <div class="hipaa-description">Looked up neighbor's records out of curiosity</div>
                        </div>
                    </div>
                    
                    <div class="hipaa-step" data-step="5" data-order="5">
                        <div class="hipaa-number">?</div>
                        <div class="hipaa-content">
                            <div class="hipaa-title">Faxed records without cover sheet</div>
                            <div class="hipaa-description">Sent to correct number but no confidentiality notice</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 24px;">
                    <button class="activity-btn" id="checkHipaaBtn">
                        ‚úì Check HIPAA Violation Order
                    </button>
                </div>
                
                <div class="feedback-message" id="hipaaFeedback"></div>
            </section>

            <!-- ACTIVITY 4: MEDICAL TERMINOLOGY MATCHING -->
            <section class="activity-card" aria-label="Medical Terminology Activity">
                <div class="activity-header">
                    <div class="activity-icon">üè•</div>
                    <h2 class="activity-title">Medical Terminology Matching</h2>
                </div>
                <p class="activity-description">
                    <strong>Instructions:</strong> Match medical terms with their correct definitions. 
                    Drag term cards to match with definition cards.
                </p>
                
                <div class="terminology-container">
                    <div class="terminology-column">
                        <div class="term-category">Medical Terms</div>
                        <div class="term-item" data-term="tachycardia" data-match="B" draggable="true">
                            Tachycardia
                        </div>
                        <div class="term-item" data-term="hypertension" data-match="D" draggable="true">
                            Hypertension
                        </div>
                        <div class="term-item" data-term="dyspnea" data-match="A" draggable="true">
                            Dyspnea
                        </div>
                        <div class="term-item" data-term="hematoma" data-match="C" draggable="true">
                            Hematoma
                        </div>
                    </div>
                    
                    <div class="terminology-column">
                        <div class="term-category">Definitions</div>
                        <div class="term-item" data-definition="breath" data-match="A" draggable="true">
                            Difficult or labored breathing
                        </div>
                        <div class="term-item" data-definition="heart" data-match="B" draggable="true">
                            Abnormally rapid heart rate (>100 bpm)
                        </div>
                        <div class="term-item" data-definition="blood" data-match="C" draggable="true">
                            Localized collection of blood outside blood vessels
                        </div>
                        <div class="term-item" data-definition="pressure" data-match="D" draggable="true">
                            Abnormally high blood pressure
                        </div>
                    </div>
                </div>
                
                <div class="term-drop-zones">
                    <div class="term-drop-zone" id="drop-terms">
                        <div style="width: 100%; text-align: center; color: var(--color-muted); padding: 10px;">
                            Drag Medical Terms Here
                        </div>
                    </div>
                    <div class="term-drop-zone" id="drop-definitions">
                        <div style="width: 100%; text-align: center; color: var(--color-muted); padding: 10px;">
                            Drag Definitions Here
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 24px;">
                    <button class="activity-btn" id="checkTermsBtn">
                        ‚úì Check Terminology Matches
                    </button>
                </div>
                
                <div class="feedback-message" id="termsFeedback"></div>
                
                <div style="margin-top: 24px; padding: 20px; background: rgba(175, 75, 239, 0.05); border-radius: var(--radius-sm); font-size: 0.95rem;">
                    <strong>Clinical Tip:</strong> Understanding medical terminology roots helps with documentation: 
                    Tachy- (fast), Cardia (heart); Hyper- (high), Tension (pressure); Dys- (difficult), Pnea (breathing); 
                    Hema- (blood), -oma (tumor/swelling).
                </div>
            </section>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-secondary" id="resetBtn">
                <span>‚Üª</span>
                Reset All Activities
            </button>
            <button class="btn btn-primary" id="checkBtn">
                <span>‚úì</span>
                Check All Answers
            </button>
            <button class="btn btn-primary" id="viewResultsBtn" style="display: none;">
                <span>üìä</span>
                View Final Results
            </button>
        </div>

        <!-- Results Panel -->
        <div class="results-panel" id="resultsPanel">
            <div class="results-header">
                <div class="activity-icon" style="background: var(--color-success);">‚úì</div>
                <h3 class="results-title">Module 2 Complete!</h3>
            </div>
            <div class="results-content">
                <p>Excellent work! You've completed the <strong>Documentation Lab</strong> module.</p>
                
                <div class="score-display">
                    <div class="score-value" id="scoreValue">0%</div>
                    <div class="score-text" id="scoreText">Your overall score</div>
                </div>
                
                <p><strong>What you've mastered:</strong></p>
                <ul style="margin-left: 20px; margin-top: 8px; margin-bottom: 16px;">
                    <li>‚úì SOAP note structure and completion</li>
                    <li>‚úì EHR documentation and "meaningful use" requirements</li>
                    <li>‚úì HIPAA violation identification and severity ranking</li>
                    <li>‚úì Medical terminology matching and definitions</li>
                    <li>‚úì Legal and ethical documentation standards</li>
                </ul>
                
                <div class="clinical-insight">
                    <strong>Clinical Insight:</strong> Documentation is a legal record, not just clinical notes. 
                    Remember the 6 C's of documentation: Clear, Concise, Complete, Correct, Chronological, and Confidential. 
                    In court, if it's not documented, it didn't happen. Always document objectively, using patient's own words 
                    when possible, and include all relevant negatives (absence of symptoms).
                </div>
            </div>
        </div>
    </main>

    <script>
        // === STATE MANAGEMENT ===
        let moduleState = {
            soapNote: { completed: false, score: 0, total: 8 },
            ehrScenarios: { completed: false, score: 0, total: 3 },
            hipaaViolations: { completed: false, score: 0, total: 5 },
            terminology: { completed: false, score: 0, total: 4 },
            startTime: new Date(),
            activitiesCompleted: 0
        };

        // === ACTIVITY 1: SOAP NOTE FUNCTIONS ===
        function initializeSoapNote() {
            let draggedPhrase = null;
            
            // SOAP phrase drag events
            document.querySelectorAll('.soap-phrase').forEach(phrase => {
                phrase.addEventListener('dragstart', function(e) {
                    draggedPhrase = this;
                    this.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', this.id);
                    
                    setTimeout(() => {
                        this.style.opacity = '0.4';
                    }, 0);
                });
                
                phrase.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    this.style.opacity = '1';
                    draggedPhrase = null;
                });
            });
            
            // SOAP section drop events
            document.querySelectorAll('.soap-section').forEach(section => {
                section.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.style.borderColor = 'var(--color-primary)';
                    this.style.backgroundColor = 'rgba(175, 75, 239, 0.05)';
                });
                
                section.addEventListener('dragleave', function() {
                    this.style.borderColor = '#ddd';
                    this.style.backgroundColor = 'white';
                });
                
                section.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.style.borderColor = '#ddd';
                    this.style.backgroundColor = 'white';
                    
                    if (draggedPhrase) {
                        // Check if this section already has 2 phrases
                        const currentPhrases = this.querySelectorAll('.soap-phrase');
                        if (currentPhrases.length >= 2) {
                            alert('Each SOAP section can only have 2 phrases maximum.');
                            return;
                        }
                        
                        // Create clone
                        const phraseClone = draggedPhrase.cloneNode(true);
                        phraseClone.classList.remove('dragging');
                        phraseClone.classList.add('placed');
                        phraseClone.draggable = false;
                        phraseClone.style.cursor = 'default';
                        phraseClone.style.opacity = '1';
                        phraseClone.style.margin = '10px 0';
                        phraseClone.style.width = '90%';
                        
                        // Add to section
                        this.appendChild(phraseClone);
                        
                        // Hide original if it's the first placement
                        if (!draggedPhrase.classList.contains('placed')) {
                            draggedPhrase.style.visibility = 'hidden';
                        }
                    }
                });
            });
            
            // Check SOAP button
            document.getElementById('checkSoapBtn').addEventListener('click', checkSoapNote);
        }
        
        function checkSoapNote() {
            const correctMatches = {
                'section-subjective': ['subjective1', 'subjective2'],
                'section-objective': ['objective1', 'objective2'],
                'section-assessment': ['assessment1', 'assessment2'],
                'section-plan': ['plan1', 'plan2']
            };
            
            let score = 0;
            let totalPossible = 8;
            let feedbackItems = [];
            
            // Clear previous feedback
            const feedbackList = document.getElementById('soapFeedbackList');
            feedbackList.innerHTML = '';
            
            // Check each section
            for (const [sectionId, correctPhraseIds] of Object.entries(correctMatches)) {
                const section = document.getElementById(sectionId);
                const sectionTitle = section.querySelector('.section-title').textContent;
                const placedPhrases = Array.from(section.querySelectorAll('.soap-phrase'));
                
                // Check each correct phrase for this section
                correctPhraseIds.forEach(correctPhraseId => {
                    const isPlaced = placedPhrases.some(phrase => phrase.dataset.phrase === correctPhraseId);
                    
                    if (isPlaced) {
                        score++;
                        
                        let phraseText = '';
                        switch(correctPhraseId) {
                            case 'subjective1': phraseText = 'Patient reports thirst/urination'; break;
                            case 'subjective2': phraseText = 'Fatigue and high glucose readings'; break;
                            case 'objective1': phraseText = 'Vital signs'; break;
                            case 'objective2': phraseText = 'Current medications'; break;
                            case 'assessment1': phraseText = 'Uncontrolled diabetes diagnosis'; break;
                            case 'assessment2': phraseText = 'Need for medication adjustment'; break;
                            case 'plan1': phraseText = 'Order lab tests'; break;
                            case 'plan2': phraseText = 'Schedule follow-up'; break;
                        }
                        
                        const li = document.createElement('li');
                        li.className = 'feedback-item correct';
                        li.textContent = `${sectionTitle}: Correct - "${phraseText}" belongs here.`;
                        feedbackList.appendChild(li);
                    } else {
                        let phraseText = '';
                        switch(correctPhraseId) {
                            case 'subjective1': phraseText = '"Increased thirst and frequent urination for 1 week"'; break;
                            case 'subjective2': phraseText = '"Reports fatigue and blood glucose readings 250-300"'; break;
                            case 'objective1': phraseText = '"BP 138/82, HR 88, Weight 185 lbs"'; break;
                            case 'objective2': phraseText = '"Current medications: Metformin 1000mg BID, Lisinopril 10mg daily"'; break;
                            case 'assessment1': phraseText = '"Uncontrolled Type 2 Diabetes"'; break;
                            case 'assessment2': phraseText = '"Need for medication adjustment and diabetes education"'; break;
                            case 'plan1': phraseText = '"Order A1c, basic metabolic panel, urinalysis"'; break;
                            case 'plan2': phraseText = '"Schedule follow-up in 2 weeks, provide glucose log"'; break;
                        }
                        
                        const li = document.createElement('li');
                        li.className = 'feedback-item incorrect';
                        li.textContent = `${sectionTitle}: Missing - ${phraseText} should be in this section.`;
                        feedbackList.appendChild(li);
                    }
                });
                
                // Check for incorrect placements
                placedPhrases.forEach(phrase => {
                    const phraseId = phrase.dataset.phrase;
                    const isCorrect = correctPhraseIds.includes(phraseId);
                    
                    if (isCorrect) {
                        section.classList.remove('incorrect-drop');
                        section.classList.add('correct-drop');
                    } else {
                        section.classList.remove('correct-drop');
                        section.classList.add('incorrect-drop');
                    }
                });
            }
            
            // Add clinical tips
            const tip1 = document.createElement('li');
            tip1.className = 'feedback-item tip';
            tip1.textContent = 'SOAP Note Structure: S = Patient\'s words/feelings, O = Measurable data, A = Your diagnosis/analysis, P = Next steps/treatment.';
            feedbackList.appendChild(tip1);
            
            if (score === totalPossible) {
                const tip2 = document.createElement('li');
                tip2.className = 'feedback-item tip';
                tip2.textContent = 'Excellent SOAP documentation! This clear, structured format ensures complete patient records and effective care coordination.';
                feedbackList.appendChild(tip2);
            } else if (score >= totalPossible * 0.7) {
                const tip3 = document.createElement('li');
                tip3.className = 'feedback-item tip';
                tip3.textContent = 'Good effort! Remember: Keep Subjective in patient\'s words, Objective measurable, Assessment analytical, Plan specific.';
                feedbackList.appendChild(tip3);
            }
            
            // Update module state
            moduleState.soapNote.score = score;
            moduleState.soapNote.completed = true;
            
            // Update feedback title
            const feedbackTitle = document.querySelector('#soapFeedbackDetails .feedback-title');
            feedbackTitle.innerHTML = `<span>üìã SOAP Note Feedback: ${score}/${totalPossible} Correct</span>`;
            
            // Provide summary feedback
            let summaryFeedback = '';
            if (score === totalPossible) {
                summaryFeedback = '‚úì Perfect! All SOAP note sections correctly completed with appropriate documentation.';
            } else if (score >= totalPossible * 0.7) {
                summaryFeedback = `‚úì Good effort! ${score}/${totalPossible} correct. Review the detailed feedback to improve your SOAP documentation.`;
            } else {
                summaryFeedback = `‚úó Needs practice. ${score}/${totalPossible} correct. Review SOAP note structure in Chapter 4.`;
            }
            
            showFeedback('soapFeedback', summaryFeedback, score >= totalPossible * 0.7 ? 'correct' : 'incorrect');
            updateProgress();
        }

        // === ACTIVITY 2: EHR SCENARIOS FUNCTIONS ===
        function initializeEhrScenarios() {
            // EHR option click events
            document.querySelectorAll('.ehr-option').forEach(option => {
                option.addEventListener('click', function() {
                    const scenario = this.dataset.scenario;
                    
                    // Remove selection from other options in same scenario
                    document.querySelectorAll(`.ehr-option[data-scenario="${scenario}"]`).forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Select this one
                    this.classList.add('selected');
                });
            });
            
            // Check EHR button
            document.getElementById('checkEhrBtn').addEventListener('click', checkEhrScenarios);
        }
        
        function checkEhrScenarios() {
            let score = 0;
            let totalScenarios = 3;
            
            // Check each scenario
            for (let i = 1; i <= totalScenarios; i++) {
                const selectedOption = document.querySelector(`.ehr-option[data-scenario="${i}"].selected`);
                const correctOption = document.querySelector(`.ehr-option[data-scenario="${i}"][data-answer="correct"]`);
                
                if (selectedOption && selectedOption.dataset.answer === 'correct') {
                    selectedOption.classList.add('correct');
                    score++;
                } else if (selectedOption) {
                    selectedOption.classList.add('incorrect');
                    // Show correct answer
                    correctOption.classList.add('correct');
                } else {
                    // If nothing selected, show correct answer
                    correctOption.classList.add('correct');
                }
                
                // Disable further clicks
                document.querySelectorAll(`.ehr-option[data-scenario="${i}"]`).forEach(opt => {
                    opt.style.pointerEvents = 'none';
                });
            }
            
            // Update module state
            moduleState.ehrScenarios.score = score;
            moduleState.ehrScenarios.completed = true;
            
            // Provide feedback
            let feedback = '';
            if (score === totalScenarios) {
                feedback = '‚úì Perfect! All EHR documentation scenarios correct. You understand timely documentation, meaningful use, and complete allergy recording.';
            } else if (score >= 2) {
                feedback = `‚úì Good! ${score}/${totalScenarios} correct. Review any incorrect answers marked in red.`;
            } else {
                feedback = `‚úó Needs review. ${score}/${totalScenarios} correct. Key principles: Document immediately, use structured data, include reaction details for allergies.`;
            }
            
            showFeedback('ehrFeedback', feedback, score >= 2 ? 'correct' : 'incorrect');
            updateProgress();
        }

        // === ACTIVITY 3: HIPAA VIOLATION FUNCTIONS ===
        function initializeHipaaViolations() {
            let clickOrder = [];
            let currentClick = 1;
            const maxSteps = 5;
            const correctOrder = [2, 4, 3, 1, 5]; // Correct severity order
            
            // HIPAA step click events
            document.querySelectorAll('.hipaa-step').forEach(step => {
                step.addEventListener('click', function() {
                    // If already clicked, skip
                    if (this.classList.contains('active')) return;
                    
                    // Mark as active in current order
                    const stepNumber = parseInt(this.dataset.step);
                    clickOrder.push(stepNumber);
                    
                    // Update display
                    const numberSpan = this.querySelector('.hipaa-number');
                    numberSpan.textContent = currentClick;
                    this.classList.add('active');
                    
                    currentClick++;
                    
                    // Check if all steps are clicked
                    if (clickOrder.length === maxSteps) {
                        checkHipaaSequence(clickOrder, correctOrder);
                    }
                });
            });
            
            // Check HIPAA button
            document.getElementById('checkHipaaBtn').addEventListener('click', function() {
                if (clickOrder.length < maxSteps) {
                    showFeedback('hipaaFeedback', 
                        `Please click all ${maxSteps} scenarios in order of severity first!`, 
                        'incorrect');
                    return;
                }
                checkHipaaSequence(clickOrder, correctOrder);
            });
        }
        
        function checkHipaaSequence(clickOrder, correctOrder) {
            let correctCount = 0;
            
            // Compare sequences
            for (let i = 0; i < clickOrder.length; i++) {
                if (clickOrder[i] === correctOrder[i]) {
                    correctCount++;
                }
            }
            
            // Calculate score
            moduleState.hipaaViolations.score = correctCount;
            moduleState.hipaaViolations.completed = true;
            
            // Visual feedback
            document.querySelectorAll('.hipaa-step').forEach((step, index) => {
                const stepNumber = parseInt(step.dataset.step);
                const numberSpan = step.querySelector('.hipaa-number');
                
                if (stepNumber === correctOrder[index]) {
                    numberSpan.style.background = 'var(--color-success)';
                } else {
                    numberSpan.style.background = 'var(--color-error)';
                    const correctIndex = correctOrder.indexOf(stepNumber);
                    if (correctIndex !== -1) {
                        numberSpan.title = `Should be severity level ${correctIndex + 1}`;
                    }
                }
            });
            
            // Show feedback
            const percentage = Math.round((correctCount / maxSteps) * 100);
            let feedback = '';
            
            if (percentage === 100) {
                feedback = `‚úì Perfect! All ${correctCount}/${maxSteps} correctly ordered by severity. Most serious: Social media > Unauthorized access > Discussing PHI > Unattended chart > Fax without cover.`;
            } else if (percentage >= 70) {
                feedback = `‚úì Good! ${correctCount}/${maxSteps} correct (${percentage}%). Review scenarios marked in red.`;
            } else {
                feedback = `‚úó Needs review. ${correctCount}/${maxSteps} correct (${percentage}%). Severity order: 1. Social media post, 2. Unauthorized EMR access, 3. Discussing PHI publicly, 4. Unattended chart, 5. Fax without cover sheet.`;
            }
            
            showFeedback('hipaaFeedback', feedback, 
                percentage >= 70 ? 'correct' : 'incorrect');
            
            updateProgress();
        }

        // === ACTIVITY 4: TERMINOLOGY MATCHING FUNCTIONS ===
        function initializeTerminologyMatching() {
            let draggedItem = null;
            let matches = [];
            
            // Term item drag events
            document.querySelectorAll('.term-item').forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    draggedItem = this;
                    this.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', this.id || this.textContent);
                    
                    // Add active class to drop zones
                    document.querySelectorAll('.term-drop-zone').forEach(zone => {
                        zone.classList.add('active');
                    });
                });
                
                item.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    draggedItem = null;
                    
                    // Remove active class from drop zones
                    document.querySelectorAll('.term-drop-zone').forEach(zone => {
                        zone.classList.remove('active');
                    });
                });
            });
            
            // Drop zone events
            document.querySelectorAll('.term-drop-zone').forEach(zone => {
                zone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                });
                
                zone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    
                    if (draggedItem) {
                        // Create clone
                        const itemClone = draggedItem.cloneNode(true);
                        itemClone.classList.remove('dragging');
                        itemClone.draggable = true; // Allow re-dragging
                        itemClone.style.cursor = 'grab';
                        itemClone.style.margin = '5px';
                        
                        // Add new drag event to clone
                        itemClone.addEventListener('dragstart', function(e) {
                            this.classList.add('dragging');
                            e.dataTransfer.setData('text/plain', this.id || this.textContent);
                            
                            document.querySelectorAll('.term-drop-zone').forEach(z => {
                                z.classList.add('active');
                            });
                        });
                        
                        itemClone.addEventListener('dragend', function() {
                            this.classList.remove('dragging');
                            
                            document.querySelectorAll('.term-drop-zone').forEach(z => {
                                z.classList.remove('active');
                            });
                        });
                        
                        this.appendChild(itemClone);
                    }
                });
            });
            
            // Check terms button
            document.getElementById('checkTermsBtn').addEventListener('click', checkTermMatches);
        }
        
        function checkTermMatches() {
            const correctMatches = {
                'tachycardia': 'B',
                'hypertension': 'D',
                'dyspnea': 'A',
                'hematoma': 'C'
            };
            
            // Get all items in drop zones
            const termZone = document.getElementById('drop-terms');
            const definitionZone = document.getElementById('drop-definitions');
            
            const termItems = Array.from(termZone.querySelectorAll('.term-item'));
            const definitionItems = Array.from(definitionZone.querySelectorAll('.term-item'));
            
            let score = 0;
            let matchedPairs = [];
            
            // Reset visual feedback
            document.querySelectorAll('.term-item').forEach(item => {
                item.classList.remove('matched', 'incorrect-match');
            });
            
            // Try to match items
            termItems.forEach(termItem => {
                const termType = termItem.dataset.term;
                const correctMatch = correctMatches[termType];
                
                // Find matching definition
                const matchingDefinition = definitionItems.find(definition => 
                    definition.dataset.definition && definition.dataset.match === correctMatch
                );
                
                if (matchingDefinition) {
                    termItem.classList.add('matched');
                    matchingDefinition.classList.add('matched');
                    score++;
                    matchedPairs.push(termType);
                    
                    // Remove from arrays to prevent double matching
                    const definitionIndex = definitionItems.indexOf(matchingDefinition);
                    if (definitionIndex > -1) {
                        definitionItems.splice(definitionIndex, 1);
                    }
                } else {
                    termItem.classList.add('incorrect-match');
                }
            });
            
            // Mark unmatched definitions as incorrect
            definitionItems.forEach(item => {
                item.classList.add('incorrect-match');
            });
            
            // Update module state
            moduleState.terminology.score = score;
            moduleState.terminology.completed = true;
            
            // Provide feedback
            let feedback = '';
            if (score === 4) {
                feedback = `‚úì Perfect! All 4 medical terms correctly matched. You understand: Tachycardia = fast heart, Hypertension = high BP, Dyspnea = labored breathing, Hematoma = blood collection.`;
            } else if (score >= 2) {
                feedback = `‚úì Good work! ${score}/4 terms correctly matched. Review unmatched items marked in red.`;
            } else {
                feedback = `‚úó Needs review. ${score}/4 terms correct. Study medical terminology roots: Tachy- (fast), Hyper- (high), Dys- (difficult), Hema- (blood).`;
            }
            
            showFeedback('termsFeedback', feedback, score >= 2 ? 'correct' : 'incorrect');
            updateProgress();
        }

        // === INITIALIZE MODULE ===
        document.addEventListener('DOMContentLoaded', function() {
            initializeSoapNote();
            initializeEhrScenarios();
            initializeHipaaViolations();
            initializeTerminologyMatching();
            setupEventListeners();
            updateProgress();
            startTimer();
        });

        // === HELPER FUNCTIONS ===
        function setupEventListeners() {
            // Reset button
            document.getElementById('resetBtn').addEventListener('click', resetAllActivities);
            
            // Check all answers button
            document.getElementById('checkBtn').addEventListener('click', checkAllAnswers);
            
            // View results button
            document.getElementById('viewResultsBtn').addEventListener('click', showFinalResults);
        }

        function showFeedback(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = 'feedback-message';
            element.classList.add(`feedback-${type}`);
            element.style.display = 'block';
            
            if (type === 'incorrect') {
                setTimeout(() => {
                    element.style.display = 'none';
                }, 5000);
            }
        }

        function updateProgress() {
            // Calculate completed activities
            let completedCount = 0;
            if (moduleState.soapNote.completed) completedCount++;
            if (moduleState.ehrScenarios.completed) completedCount++;
            if (moduleState.hipaaViolations.completed) completedCount++;
            if (moduleState.terminology.completed) completedCount++;
            
            document.getElementById('completedCount').textContent = completedCount;
            
            // Calculate accuracy
            let totalScore = 0;
            let totalPossible = 0;
            
            Object.values(moduleState).forEach(activity => {
                if (activity.score !== undefined && activity.total) {
                    totalScore += activity.score;
                    totalPossible += activity.total;
                }
            });
            
            const accuracy = totalPossible > 0 ? Math.round((totalScore / totalPossible) * 100) : 0;
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            
            // Update progress tracker
            if (completedCount >= 4) {
                document.querySelectorAll('.progress-step').forEach(step => {
                    step.classList.remove('active');
                    step.classList.add('completed');
                });
                
                // Show "View Results" button
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('viewResultsBtn').style.display = 'flex';
            } else if (completedCount >= 1) {
                document.querySelectorAll('.progress-step').forEach((step, index) => {
                    step.classList.remove('active', 'completed');
                    if (index < completedCount) {
                        step.classList.add('completed');
                    }
                    if (index === completedCount) {
                        step.classList.add('active');
                    }
                });
            }
            
            // Update module state
            moduleState.activitiesCompleted = completedCount;
        }

        function startTimer() {
            const timeElement = document.getElementById('timeSpent');
            
            setInterval(() => {
                const now = new Date();
                const diffMs = now - moduleState.startTime;
                const diffMins = Math.floor(diffMs / 60000);
                timeElement.textContent = `${diffMins} min`;
            }, 60000);
        }

        function checkAllAnswers() {
            // Trigger check for each activity if not already checked
            if (!moduleState.soapNote.completed) {
                checkSoapNote();
            }
            
            if (!moduleState.ehrScenarios.completed) {
                checkEhrScenarios();
            }
            
            if (!moduleState.hipaaViolations.completed) {
                showFeedback('hipaaFeedback', 
                    'Complete the HIPAA violation ordering activity first!', 
                    'incorrect');
            }
            
            if (!moduleState.terminology.completed) {
                checkTermMatches();
            }
            
            updateProgress();
            
            // If all activities completed, show results
            if (moduleState.activitiesCompleted >= 4) {
                showFinalResults();
            }
        }

        function showFinalResults() {
            // Calculate final score
            let totalScore = 0;
            let totalPossible = 0;
            
            Object.values(moduleState).forEach(activity => {
                if (activity.score !== undefined && activity.total) {
                    totalScore += activity.score;
                    totalPossible += activity.total;
                }
            });
            
            const finalScore = totalPossible > 0 ? Math.round((totalScore / totalPossible) * 100) : 0;
            
            // Animate score counter
            const scoreElement = document.getElementById('scoreValue');
            animateCounter(scoreElement, 0, finalScore, 1500);
            
            // Set score text
            const scoreText = document.getElementById('scoreText');
            let performance = '';
            
            if (finalScore >= 90) performance = 'Outstanding!';
            else if (finalScore >= 80) performance = 'Excellent!';
            else if (finalScore >= 70) performance = 'Good!';
            else performance = 'Keep practicing!';
            
            scoreText.textContent = `${performance} Your overall score`;
            
            // Show results panel
            document.getElementById('resultsPanel').classList.add('show');
            
            // Scroll to results
            setTimeout(() => {
                document.getElementById('resultsPanel').scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest'
                });
            }, 100);
        }

        function animateCounter(element, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const value = Math.floor(progress * (end - start) + start);
                element.textContent = `${value}%`;
                
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        function resetAllActivities() {
            if (!confirm("Are you sure you want to reset all activities? All progress will be lost.")) return;
            
            // Reset module state
            moduleState = {
                soapNote: { completed: false, score: 0, total: 8 },
                ehrScenarios: { completed: false, score: 0, total: 3 },
                hipaaViolations: { completed: false, score: 0, total: 5 },
                terminology: { completed: false, score: 0, total: 4 },
                startTime: new Date(),
                activitiesCompleted: 0
            };
            
            // Reset activity 1
            document.querySelectorAll('.soap-phrase').forEach(phrase => {
                phrase.classList.remove('dragging', 'placed');
                phrase.style.visibility = 'visible';
                phrase.style.opacity = '1';
                phrase.draggable = true;
                phrase.style.cursor = 'grab';
                phrase.style.width = 'auto';
                phrase.style.margin = '0';
            });
            
            // Reset SOAP sections
            const sectionData = {
                'section-subjective': { title: 'S - Subjective', instruction: 'Patient\'s own words about symptoms, concerns, history' },
                'section-objective': { title: 'O - Objective', instruction: 'Measurable, observable data (vitals, exam findings)' },
                'section-assessment': { title: 'A - Assessment', instruction: 'Your diagnosis, analysis, or clinical impression' },
                'section-plan': { title: 'P - Plan', instruction: 'Treatment, follow-up, education, referrals' }
            };
            
            for (const [sectionId, data] of Object.entries(sectionData)) {
                const section = document.getElementById(sectionId);
                section.innerHTML = `
                    <div class="section-title">${data.title}</div>
                    <div class="section-instruction">${data.instruction}</div>
                `;
                section.classList.remove('correct-drop', 'incorrect-drop');
                section.style.borderColor = '#ddd';
                section.style.backgroundColor = 'white';
            }
            
            // Reset feedback section for activity 1
            const feedbackList = document.getElementById('soapFeedbackList');
            feedbackList.innerHTML = '';
            
            const feedbackTitle = document.querySelector('#soapFeedbackDetails .feedback-title');
            feedbackTitle.innerHTML = `<span>üìã SOAP Note Feedback:</span>`;
            
            // Reset activity 2
            document.querySelectorAll('.ehr-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
                option.style.pointerEvents = 'auto';
            });
            
            // Reset activity 3
            document.querySelectorAll('.hipaa-step').forEach(step => {
                step.classList.remove('active');
                const numberSpan = step.querySelector('.hipaa-number');
                numberSpan.textContent = '?';
                numberSpan.style.background = 'var(--color-primary)';
                numberSpan.title = '';
            });
            
            // Reset activity 4
            document.querySelectorAll('.term-item').forEach(item => {
                item.classList.remove('matched', 'incorrect-match', 'dragging');
                item.draggable = true;
                item.style.cursor = 'grab';
                item.style.margin = '0';
            });
            
            // Clear drop zones for activity 4
            document.getElementById('drop-terms').innerHTML = 
                '<div style="width: 100%; text-align: center; color: var(--color-muted); padding: 10px;">Drag Medical Terms Here</div>';
            document.getElementById('drop-definitions').innerHTML = 
                '<div style="width: 100%; text-align: center; color: var(--color-muted); padding: 10px;">Drag Definitions Here</div>';
            
            // Clear feedback messages
            document.querySelectorAll('.feedback-message').forEach(feedback => {
                feedback.textContent = '';
                feedback.className = 'feedback-message';
                feedback.style.display = 'none';
            });
            
            // Hide results panel
            document.getElementById('resultsPanel').classList.remove('show');
            
            // Reset buttons
            document.getElementById('checkBtn').style.display = 'flex';
            document.getElementById('viewResultsBtn').style.display = 'none';
            
            // Reset progress tracker
            document.querySelectorAll('.progress-step').forEach((step, index) => {
                step.classList.remove('completed');
                if (index === 0) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
            
            // Update progress display
            updateProgress();
            
            // Show reset confirmation
            showFeedback('soapFeedback', '‚úì All activities have been reset. Ready to start again!', 'correct');
        }
    </script>
</body>
</html>
