<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AlliedRx -- Chapter 17: Women's Reproductive Health & Contraception</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --color-primary: #af4bef;
            --color-primary-soft: #d492ff;
            --color-accent: #8380f0;
            --color-success: #00b894;
            --color-error: #e17055;
            --color-warning: #fdcb6e;
            --color-info: #0984e3;
            --color-bg: #f7f5fb;
            --color-text: #2b2b2b;
            --color-muted: #6c6880;
            --color-dark: #0c0a18;
            --radius-lg: 24px;
            --radius-md: 16px;
            --radius-sm: 12px;
            --shadow-soft: 0 18px 45px rgba(23, 10, 61, 0.18);
            --shadow-hover: 0 25px 50px rgba(175, 75, 239, 0.15);
            --shadow-card: 0 12px 30px rgba(15, 23, 42, 0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            padding: 24px;
            background: radial-gradient(
                circle at top left,
                #ffffff 0,
                #f1ecff 40%,
                var(--color-bg) 100%
            );
            color: var(--color-text);
            -webkit-text-size-adjust: 100%;
            line-height: 1.5;
        }

        @media (max-width: 600px) {
            body { padding: 12px; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes checkmarkPop {
            0% { transform: scale(0); opacity: 0; }
            70% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 28px 30px 32px;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.8s ease-out;
        }

        @media (max-width: 900px) { .page { padding: 22px; } }
        @media (max-width: 480px) {
            body { padding: 0; }
            .page {
                border-radius: 0;
                box-shadow: none;
                padding: 18px 14px 22px;
            }
        }

        /* Header */
        .brand-row {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 14px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            width: 100%;
            animation: fadeIn 0.6s ease-out 0.2s both;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .brand-logo {
            height: 40px;
            width: auto;
            max-width: 100%;
            filter: drop-shadow(0 3px 8px rgba(0, 0, 0, 0.2));
            transition: transform 0.3s ease;
        }

        .brand-logo:hover { transform: scale(1.05); }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 2px;
            max-width: 100%;
        }

        .course-name {
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: var(--color-muted);
            white-space: normal;
        }

        .week-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 10px;
            border-radius: 999px;
            background: rgba(175, 75, 239, 0.08);
            font-size: 0.76rem;
            color: var(--color-primary);
            white-space: normal;
        }

        .week-label-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--color-success);
            flex-shrink: 0;
        }

        .badge-mode {
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(12, 10, 24, 0.06);
            border: 1px solid rgba(12, 10, 24, 0.08);
            font-size: 0.74rem;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: var(--color-muted);
            white-space: nowrap;
            transition: all 0.3s ease;
        }

        .badge-mode:hover {
            background: rgba(175, 75, 239, 0.1);
            border-color: var(--color-primary-soft);
            color: var(--color-primary);
        }

        @media (max-width: 480px) {
            .brand-row { flex-direction: column; align-items: flex-start; }
            .badge-mode { margin-top: 6px; }
        }

        h1 {
            font-size: clamp(1.8rem, 3vw, 2.2rem);
            line-height: 1.1;
            color: var(--color-primary);
            margin-bottom: 6px;
            animation: fadeInUp 0.6s ease-out 0.3s both;
        }

        .module-subtitle {
            font-size: 0.98rem;
            color: var(--color-muted);
            max-width: 600px;
            margin-bottom: 24px;
            animation: fadeInUp 0.6s ease-out 0.4s both;
        }

        /* Progress Tracker */
        .progress-tracker {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
            padding: 0 20px;
        }

        .progress-tracker::before {
            content: '';
            position: absolute;
            top: 15px;
            left: 50px;
            right: 50px;
            height: 3px;
            background: rgba(12, 10, 24, 0.08);
            z-index: 1;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 2;
            flex: 1;
        }

        .step-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: white;
            border: 2px solid rgba(12, 10, 24, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-muted);
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-circle {
            background: var(--color-primary);
            border-color: var(--color-primary);
            color: white;
            transform: scale(1.1);
        }

        .progress-step.completed .step-circle {
            background: var(--color-success);
            border-color: var(--color-success);
            color: white;
        }

        .step-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-align: center;
            font-weight: 500;
        }

        .progress-step.active .step-label {
            color: var(--color-primary);
            font-weight: 600;
        }

        /* Progress Summary */
        .progress-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
            animation: fadeInUp 0.6s ease-out 0.5s both;
        }

        .summary-card {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-md);
            padding: 16px;
            border: 1px solid rgba(12, 10, 24, 0.06);
            text-align: center;
            transition: all 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-card);
            border-color: var(--color-primary-soft);
        }

        .summary-number {
            font-size: 2rem;
            font-weight: 800;
            color: var(--color-primary);
            display: block;
            line-height: 1;
            margin-bottom: 4px;
        }

        .summary-label {
            font-size: 0.8rem;
            color: var(--color-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Activity Grid */
        .activity-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 900px) {
            .activity-grid { grid-template-columns: 1fr; }
        }

        .activity-card {
            background: white;
            border-radius: var(--radius-md);
            border: 1px solid rgba(12, 10, 24, 0.08);
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--color-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .activity-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
            border-color: var(--color-primary-soft);
        }

        .activity-card:hover::before { opacity: 1; }

        .activity-card.completed {
            border-color: var(--color-success);
        }

        .activity-card.completed::before {
            background: var(--color-success);
            opacity: 1;
        }

        .activity-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .activity-number {
            font-size: 0.8rem;
            font-weight: 700;
            color: var(--color-primary);
            background: rgba(175, 75, 239, 0.1);
            padding: 4px 10px;
            border-radius: 20px;
        }

        .activity-status {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 12px;
            background: rgba(12, 10, 24, 0.06);
            color: var(--color-muted);
        }

        .activity-card.completed .activity-status {
            background: rgba(0, 184, 148, 0.1);
            color: var(--color-success);
        }

        .activity-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 8px;
        }

        .activity-description {
            font-size: 0.9rem;
            color: var(--color-muted);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        /* Activity 1: Contraceptive Method Selection Simulator */
        .patient-scenarios {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .patient-card {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-sm);
            padding: 15px;
            border: 2px solid rgba(12, 10, 24, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .patient-card:hover {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.05);
            transform: translateY(-2px);
        }

        .patient-card.selected {
            border-color: var(--color-success);
            background: rgba(0, 184, 148, 0.1);
        }

        .patient-age {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 5px;
        }

        .patient-details {
            font-size: 0.8rem;
            color: var(--color-text);
            line-height: 1.4;
        }

        .contraceptive-methods {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .method-item {
            background: rgba(12, 10, 24, 0.05);
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.85rem;
            cursor: grab;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .method-item:hover {
            background: rgba(175, 75, 239, 0.1);
            border-color: var(--color-primary-soft);
            transform: translateY(-2px);
        }

        .method-item.dragging {
            opacity: 0.7;
            transform: scale(0.95);
        }

        .patient-dropzone {
            min-height: 100px;
            border: 2px dashed rgba(12, 10, 24, 0.1);
            border-radius: var(--radius-sm);
            padding: 15px;
            margin-bottom: 20px;
            background: rgba(12, 10, 24, 0.02);
        }

        .patient-dropzone.hover {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.05);
        }

        .patient-dropzone.empty::after {
            content: 'Drag contraceptive methods here for selected patient';
            color: var(--color-muted);
            text-align: center;
            display: block;
            font-size: 0.9rem;
            margin-top: 30px;
        }

        .dropzone-header {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 10px;
        }

        .dropped-method {
            background: rgba(0, 184, 148, 0.1);
            border-radius: 15px;
            padding: 6px 12px;
            font-size: 0.8rem;
            margin: 5px;
            display: inline-block;
            border: 1px solid var(--color-success);
            position: relative;
        }

        .dropped-method.incorrect {
            background: rgba(225, 112, 85, 0.1);
            border-color: var(--color-error);
        }

        .dropped-method:hover::after {
            content: '×';
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--color-error);
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
        }

        /* Activity 2: Menstrual Cycle & Disorders Explorer */
        .cycle-slider-container {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-sm);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(12, 10, 24, 0.08);
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .cycle-phase {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--color-primary);
        }

        .cycle-day {
            font-size: 0.8rem;
            color: var(--color-muted);
        }

        .slider-track {
            width: 100%;
            height: 8px;
            background: rgba(12, 10, 24, 0.1);
            border-radius: 4px;
            position: relative;
            margin-bottom: 30px;
            cursor: pointer;
        }

        .slider-thumb {
            width: 24px;
            height: 24px;
            background: var(--color-primary);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            cursor: grab;
            box-shadow: 0 4px 12px rgba(175, 75, 239, 0.3);
            z-index: 2;
        }

        .slider-marker {
            position: absolute;
            top: 20px;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: var(--color-muted);
            text-align: center;
            width: 40px;
        }

        .hormone-levels {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .hormone-bar {
            height: 20px;
            background: var(--color-primary-soft);
            border-radius: 10px;
            margin-top: 5px;
            position: relative;
            overflow: hidden;
        }

        .hormone-fill {
            height: 100%;
            background: var(--color-accent);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .disorders-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .disorder-card {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-sm);
            padding: 15px;
            border: 2px dashed rgba(12, 10, 24, 0.1);
            min-height: 120px;
            transition: all 0.3s ease;
            position: relative;
        }

        .disorder-card.hover {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.05);
        }

        .disorder-card.filled {
            border: 2px solid var(--color-primary-soft);
            background: rgba(175, 75, 239, 0.08);
        }

        .disorder-card.wrong-drop {
            border-color: var(--color-error);
            background: rgba(225, 112, 85, 0.05);
            animation: shake 0.5s ease;
        }

        .disorder-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 10px;
            text-align: center;
        }

        .disorder-items {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .disorder-item {
            background: rgba(12, 10, 24, 0.05);
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 0.85rem;
            cursor: grab;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .disorder-item:hover {
            background: rgba(175, 75, 239, 0.1);
            border-color: var(--color-primary-soft);
            transform: translateY(-2px);
        }

        .disorder-item.dragging {
            opacity: 0.7;
            transform: scale(0.95);
        }

        /* Inline Feedback Messages */
        .inline-feedback {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%) translateY(-100%);
            background: var(--color-error);
            color: white;
            padding: 8px 12px;
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            z-index: 100;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: slideIn 0.3s ease;
            display: none;
        }

        .inline-feedback::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--color-error);
        }

        .inline-feedback.show {
            display: block;
        }

        /* Detailed Feedback */
        .detailed-feedback {
            background: rgba(12, 10, 24, 0.02);
            border-radius: var(--radius-sm);
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid var(--color-primary);
            display: none;
        }

        .detailed-feedback.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .feedback-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feedback-icon {
            font-size: 1.2rem;
        }

        .feedback-icon.correct {
            color: var(--color-success);
        }

        .feedback-icon.incorrect {
            color: var(--color-error);
        }

        .feedback-content {
            font-size: 0.85rem;
            color: var(--color-text);
            line-height: 1.5;
        }

        .feedback-content strong {
            color: var(--color-primary);
        }

        .pro-tip {
            background: rgba(253, 203, 110, 0.1);
            border-left: 3px solid var(--color-warning);
            padding: 10px 12px;
            margin: 10px 0;
            font-size: 0.8rem;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
        }

        .pro-tip strong {
            color: var(--color-warning);
        }

        .clinical-reasoning {
            background: rgba(131, 128, 240, 0.08);
            border-left: 3px solid var(--color-accent);
            padding: 10px 12px;
            margin: 10px 0;
            font-size: 0.8rem;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
        }

        .clinical-reasoning strong {
            color: var(--color-accent);
        }

        /* Wrong Answer Explanation */
        .wrong-answer-explanation {
            background: rgba(225, 112, 85, 0.08);
            border-radius: var(--radius-sm);
            padding: 12px 15px;
            margin-top: 15px;
            border-left: 4px solid var(--color-error);
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .wrong-answer-explanation.show {
            display: block;
        }

        .explanation-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--color-error);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .explanation-content {
            font-size: 0.8rem;
            color: var(--color-text);
            line-height: 1.5;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border-radius: var(--radius-md);
            border: none;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: #9a3bd6;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(175, 75, 239, 0.3);
        }

        .btn-secondary {
            background: rgba(12, 10, 24, 0.06);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: rgba(12, 10, 24, 0.1);
            transform: translateY(-2px);
        }

        .btn-icon {
            font-size: 1.1em;
        }

        /* Results Panel */
        .results-panel {
            background: var(--color-dark);
            color: white;
            border-radius: var(--radius-md);
            padding: 30px;
            margin-top: 30px;
            display: none;
            animation: fadeInUp 0.6s ease;
        }

        .results-panel.show {
            display: block;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .results-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: white;
        }

        .score-display {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--color-primary-soft);
            text-align: center;
            margin: 20px 0;
        }

        .clinical-insights {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            padding: 20px;
            margin-top: 20px;
        }

        .insights-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--color-primary-soft);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insights-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .insights-list li {
            display: flex;
            gap: 10px;
            align-items: flex-start;
            font-size: 0.9rem;
            color: #e5e7eb;
        }

        .insight-dot {
            width: 6px;
            height: 6px;
            margin-top: 6px;
            border-radius: 999px;
            background: var(--color-accent);
            flex-shrink: 0;
        }

        /* Ethical Note */
        .ethical-note {
            background: rgba(253, 203, 110, 0.1);
            border: 2px solid var(--color-warning);
            border-radius: var(--radius-sm);
            padding: 15px;
            margin-top: 15px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .note-icon {
            font-size: 1.5rem;
            color: var(--color-warning);
            flex-shrink: 0;
        }

        .note-content {
            flex: 1;
        }

        .note-title {
            font-size: 0.95rem;
            font-weight: 700;
            color: var(--color-warning);
            margin-bottom: 5px;
        }

        .note-text {
            font-size: 0.85rem;
            color: var(--color-text);
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .patient-scenarios { grid-template-columns: 1fr; }
            .hormone-levels { grid-template-columns: 1fr; }
            .disorders-grid { grid-template-columns: 1fr; }
            .action-buttons { flex-direction: column; }
            .btn { width: 100%; justify-content: center; }
            .inline-feedback {
                white-space: normal;
                width: 90%;
                left: 5%;
                transform: translateY(-100%);
            }
            .inline-feedback::after {
                left: 50%;
            }
        }
    </style>
</head>
<body>
    <main class="page" aria-labelledby="module-heading">
        <!-- Header -->
        <header class="brand-row">
            <div class="brand">
                <img
                    src="https://cdn.prod.website-files.com/64d0ccc1558d601cbfb09021/64e9d2f719b1e5258e5d57f5_IMG_1512-p-500.png"
                    alt="AlliedRx logo"
                    class="brand-logo"
                />
                <div class="course-meta">
                    <span class="course-name">Clinical Medical Assistant • Week 7</span>
                    <div class="week-label">
                        <span class="week-label-dot"></span>
                        <span>Chapter 17: Obstetrics & Gynecology</span>
                    </div>
                </div>
            </div>
            <span class="badge-mode">Campus & Online</span>
        </header>

        <h1 id="module-heading">Women's Reproductive Health & Contraception</h1>
        <p class="module-subtitle">
            Master contraceptive method selection and understand menstrual cycle phases 
            and gynecologic disorders through interactive patient scenarios and clinical simulations.
        </p>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">Contraceptive Selection</div>
            </div>
            <div class="progress-step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">Cycle & Disorders</div>
            </div>
        </div>

        <!-- Progress Summary -->
        <div class="progress-summary">
            <div class="summary-card">
                <span class="summary-number" id="completed-count">0</span>
                <span class="summary-label">Activities Completed</span>
            </div>
            <div class="summary-card">
                <span class="summary-number" id="accuracy-rate">0%</span>
                <span class="summary-label">Current Accuracy</span>
            </div>
            <div class="summary-card">
                <span class="summary-number" id="time-spent">0:00</span>
                <span class="summary-label">Time Spent</span>
            </div>
        </div>

        <!-- Activity Grid -->
        <div class="activity-grid">
            <!-- Activity 1: Contraceptive Method Selection Simulator -->
            <section class="activity-card" id="activity-1" data-activity="1">
                <div class="activity-header">
                    <span class="activity-number">Activity 1</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Contraceptive Method Selection Simulator</h3>
                <p class="activity-description">
                    Select appropriate contraceptive methods for different patient profiles 
                    based on medical history, lifestyle, and reproductive goals. 
                    <strong>Consider efficacy, safety, and patient preferences.</strong>
                </p>

                <!-- Patient Scenarios -->
                <div class="patient-scenarios">
                    <div class="patient-card" data-patient="1">
                        <div class="patient-age">22-year-old college student</div>
                        <div class="patient-details">
                            • Needs convenience and STD protection<br>
                            • Irregular schedule<br>
                            • No contraindications to hormones<br>
                            • Not planning pregnancy for 3-5 years
                        </div>
                    </div>
                    <div class="patient-card" data-patient="2">
                        <div class="patient-age">35-year-old mother of 3</div>
                        <div class="patient-details">
                            • Wants permanent solution<br>
                            • Completed childbearing<br>
                            • History of heavy menstrual bleeding<br>
                            • No future pregnancy plans
                        </div>
                    </div>
                    <div class="patient-card" data-patient="3">
                        <div class="patient-age">18-year-old with migraines with aura</div>
                        <div class="patient-details">
                            • Contraindicated for estrogen<br>
                            • Needs reliable contraception<br>
                            • Concerned about weight gain<br>
                            • May want children in 5+ years
                        </div>
                    </div>
                    <div class="patient-card" data-patient="4">
                        <div class="patient-age">30-year-old planning pregnancy in 1 year</div>
                        <div class="patient-details">
                            • Wants easily reversible method<br>
                            • Regular menstrual cycles<br>
                            • No medical contraindications<br>
                            • Planning to conceive in 12 months
                        </div>
                    </div>
                    <div class="patient-card" data-patient="5">
                        <div class="patient-age">45-year-old perimenopausal with hypertension</div>
                        <div class="patient-details">
                            • Controlled hypertension on medication<br>
                            • Irregular periods<br>
                            • Vasomotor symptoms<br>
                            • Needs non-hormonal options
                        </div>
                    </div>
                </div>

                <!-- Contraceptive Methods -->
                <div class="contraceptive-methods" id="contraceptive-methods">
                    <div class="method-item draggable" data-method="oral" data-category="hormonal" draggable="true">Oral Contraceptive Pill</div>
                    <div class="method-item draggable" data-method="patch" data-category="hormonal" draggable="true">Contraceptive Patch</div>
                    <div class="method-item draggable" data-method="ring" data-category="hormonal" draggable="true">Vaginal Ring</div>
                    <div class="method-item draggable" data-method="implant" data-category="hormonal" draggable="true">Contraceptive Implant</div>
                    <div class="method-item draggable" data-method="injection" data-category="hormonal" draggable="true">Depo-Provera Injection</div>
                    <div class="method-item draggable" data-method="iud-hormonal" data-category="hormonal" draggable="true">Hormonal IUD</div>
                    <div class="method-item draggable" data-method="iud-copper" data-category="non-hormonal" draggable="true">Copper IUD</div>
                    <div class="method-item draggable" data-method="condom" data-category="barrier" draggable="true">Male Condom</div>
                    <div class="method-item draggable" data-method="female-condom" data-category="barrier" draggable="true">Female Condom</div>
                    <div class="method-item draggable" data-method="diaphragm" data-category="barrier" draggable="true">Diaphragm</div>
                    <div class="method-item draggable" data-method="fertility-awareness" data-category="natural" draggable="true">Fertility Awareness</div>
                    <div class="method-item draggable" data-method="tubal" data-category="permanent" draggable="true">Tubal Ligation</div>
                    <div class="method-item draggable" data-method="vasectomy" data-category="permanent" draggable="true">Vasectomy (Partner)</div>
                    <div class="method-item draggable" data-method="emergency" data-category="emergency" draggable="true">Emergency Contraception</div>
                </div>

                <!-- Patient Dropzone -->
                <div class="patient-dropzone empty" id="patient-dropzone">
                    <div class="dropzone-header">Selected Patient: <span id="selected-patient">None</span></div>
                    <div id="dropped-methods"></div>
                </div>

                <!-- Wrong Answer Explanation -->
                <div class="wrong-answer-explanation" id="activity1-wrong-explanation">
                    <div class="explanation-title">
                        <span>❌</span> Why This Choice Might Not Be Ideal
                    </div>
                    <div class="explanation-content" id="activity1-explanation-content">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Detailed Feedback -->
                <div class="detailed-feedback" id="feedback-1">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">✓</span>
                        Contraceptive Counseling Complete!
                    </div>
                    <div class="feedback-content">
                        <strong>Your Recommendations vs. Optimal Choices:</strong><br><br>
                        
                        <div id="patient-1-feedback" style="display: none;">
                            <strong>22-year-old college student:</strong><br>
                            <span class="your-choices">Your choices: <span id="p1-your"></span></span><br>
                            <span class="optimal-choices">Optimal: Hormonal IUD, Implant + Condoms</span><br>
                            <div class="clinical-reasoning">
                                <strong>Clinical Reasoning:</strong> Young adults need reliable, low-maintenance contraception. 
                                LARC methods (IUDs, implant) have highest efficacy rates (>99%) and don't require daily action. 
                                Condoms provide essential STD protection. Avoid methods requiring daily compliance (pills) due to irregular schedules.
                            </div>
                            <div class="pro-tip">
                                <strong>Pro Tip:</strong> Always offer LARC methods first to nulliparous women - they are safe and highly effective. 
                                Discuss emergency contraception as backup.
                            </div>
                        </div>
                        
                        <div id="patient-2-feedback" style="display: none;">
                            <strong>35-year-old mother of 3:</strong><br>
                            <span class="your-choices">Your choices: <span id="p2-your"></span></span><br>
                            <span class="optimal-choices">Optimal: Tubal ligation OR Hormonal IUD</span><br>
                            <div class="clinical-reasoning">
                                <strong>Clinical Reasoning:</strong> Patient wants permanent solution (tubal ligation). Hormonal IUD excellent for heavy bleeding (reduces flow 90%). Both options meet her needs.
                            </div>
                            <div class="pro-tip">
                                <strong>Pro Tip:</strong> For patients with heavy menstrual bleeding, hormonal IUDs (Mirena) are first-line treatment 
                                and provide contraception - two benefits in one.
                            </div>
                        </div>
                        
                        <div id="patient-3-feedback" style="display: none;">
                            <strong>18-year-old with migraines with aura:</strong><br>
                            <span class="your-choices">Your choices: <span id="p3-your"></span></span><br>
                            <span class="optimal-choices">Optimal: Progestin-only methods (Implant, Injection, Hormonal IUD)</span><br>
                            <div class="clinical-reasoning">
                                <strong>Clinical Reasoning:</strong> Estrogen-containing methods are ABSOLUTELY contraindicated in 
                                migraines with aura due to 2-4x increased stroke risk. Progestin-only methods are safe. 
                                Copper IUD is also safe but may worsen dysmenorrhea.
                            </div>
                            <div class="pro-tip">
                                <strong>Safety Alert:</strong> Migraines WITH aura = no estrogen. Migraines WITHOUT aura = estrogen may be used 
                                with caution if no other risk factors.
                            </div>
                        </div>
                        
                        <div id="patient-4-feedback" style="display: none;">
                            <strong>30-year-old planning pregnancy in 1 year:</strong><br>
                            <span class="your-choices">Your choices: <span id="p4-your"></span></span><br>
                            <span class="optimal-choices">Optimal: Barrier methods, Fertility awareness</span><br>
                            <div class="clinical-reasoning">
                                <strong>Clinical Reasoning:</strong> Patient wants pregnancy soon, so long-acting methods (IUDs, implant) 
                                are less ideal due to removal/reversal time. Barrier methods provide immediate reversibility. 
                                Fertility awareness requires regular cycles and careful tracking.
                            </div>
                            <div class="pro-tip">
                                <strong>Pro Tip:</strong> Recommend folic acid supplementation (400-800 mcg daily) when pregnancy is planned 
                                within 1 year to prevent neural tube defects.
                            </div>
                        </div>
                        
                        <div id="patient-5-feedback" style="display: none;">
                            <strong>45-year-old perimenopausal with hypertension:</strong><br>
                            <span class="your-choices">Your choices: <span id="p5-your"></span></span><br>
                            <span class="optimal-choices">Optimal: Copper IUD, Barrier methods</span><br>
                            <div class="clinical-reasoning">
                                <strong>Clinical Reasoning:</strong> Hypertension increases stroke risk with estrogen. 
                                Perimenopause means irregular ovulation but pregnancy still possible. Copper IUD provides 
                                non-hormonal protection for up to 10 years. Barrier methods are also appropriate.
                            </div>
                            <div class="pro-tip">
                                <strong>Clinical Pearl:</strong> Continue contraception until 1 year after last menstrual period 
                                if >50 years old, or 2 years if <50. FSH levels >30 mIU/mL on two occasions indicates menopause.
                            </div>
                        </div>
                        
                        <br><strong>Key Learning Points:</strong><br>
                        1. LARC methods (IUDs, implant) = highest efficacy, best for most patients<br>
                        2. Estrogen contraindications: migraines with aura, hypertension >160/100, history of VTE, smokers >35<br>
                        3. Patient preferences matter: permanence, reversibility, non-hormonal options<br>
                        4. Always consider STD protection needs
                    </div>
                </div>

                <!-- Ethical Note -->
                <div class="ethical-note">
                    <div class="note-icon">⚖️</div>
                    <div class="note-content">
                        <div class="note-title">Ethical & Cultural Considerations</div>
                        <div class="note-text">
                            <strong>Confidentiality:</strong> Adolescent patients have right to confidential reproductive health services.<br>
                            <strong>Informed Consent:</strong> Ensure patient understands risks, benefits, and alternatives.<br>
                            <strong>Cultural Sensitivity:</strong> Respect religious and cultural beliefs about contraception.<br>
                            <strong>Non-judgmental Care:</strong> Provide factual information without personal bias.
                        </div>
                    </div>
                </div>
            </section>

            <!-- Activity 2: Menstrual Cycle & Gynecologic Disorders Explorer -->
            <section class="activity-card" id="activity-2" data-activity="2">
                <div class="activity-header">
                    <span class="activity-number">Activity 2</span>
                    <span class="activity-status">Not Started</span>
                </div>
                <h3 class="activity-title">Menstrual Cycle & Gynecologic Disorders Explorer</h3>
                <p class="activity-description">
                    Explore menstrual cycle phases and match gynecologic disorders with their 
                    characteristics. Understand hormone fluctuations and clinical presentations.
                </p>

                <!-- Menstrual Cycle Slider -->
                <div class="cycle-slider-container">
                    <div class="slider-header">
                        <div class="cycle-phase" id="cycle-phase">Follicular Phase (Day 1-14)</div>
                        <div class="cycle-day" id="cycle-day">Day 1</div>
                    </div>
                    <div class="slider-track" id="slider-track">
                        <div class="slider-thumb" id="slider-thumb"></div>
                        <div class="slider-marker" style="left: 0%;">Day 1</div>
                        <div class="slider-marker" style="left: 25%;">Day 7</div>
                        <div class="slider-marker" style="left: 50%;">Day 14<br>(Ovulation)</div>
                        <div class="slider-marker" style="left: 75%;">Day 21</div>
                        <div class="slider-marker" style="left: 100%;">Day 28</div>
                    </div>

                    <!-- Hormone Levels -->
                    <div class="hormone-levels">
                        <div>
                            <div style="font-size: 0.8rem; color: var(--color-muted);">Estrogen</div>
                            <div class="hormone-bar">
                                <div class="hormone-fill" id="estrogen-level" style="width: 30%;"></div>
                            </div>
                        </div>
                        <div>
                            <div style="font-size: 0.8rem; color: var(--color-muted);">Progesterone</div>
                            <div class="hormone-bar">
                                <div class="hormone-fill" id="progesterone-level" style="width: 10%;"></div>
                            </div>
                        </div>
                    </div>

                    <p style="font-size: 0.8rem; color: var(--color-muted); margin-top: 15px;">
                        <strong>Clinical Insight:</strong> Follicular phase = estrogen rise, ovulation = LH surge, 
                        luteal phase = progesterone dominance. Implantation occurs day 20-24 if fertilization occurs.
                    </p>
                </div>

                <!-- Disorders Matching -->
                <div class="disorders-grid">
                    <div class="disorder-card" data-disorder="pcos" id="disorder-pcos">
                        <div class="disorder-title">PCOS</div>
                        <div class="disorder-content"></div>
                        <div class="inline-feedback" id="feedback-pcos"></div>
                    </div>
                    <div class="disorder-card" data-disorder="endometriosis" id="disorder-endo">
                        <div class="disorder-title">Endometriosis</div>
                        <div class="disorder-content"></div>
                        <div class="inline-feedback" id="feedback-endo"></div>
                    </div>
                    <div class="disorder-card" data-disorder="fibroids" id="disorder-fibroids">
                        <div class="disorder-title">Uterine Fibroids</div>
                        <div class="disorder-content"></div>
                        <div class="inline-feedback" id="feedback-fibroids"></div>
                    </div>
                    <div class="disorder-card" data-disorder="dysmenorrhea" id="disorder-dysmenorrhea">
                        <div class="disorder-title">Dysmenorrhea</div>
                        <div class="disorder-content"></div>
                        <div class="inline-feedback" id="feedback-dysmenorrhea"></div>
                    </div>
                    <div class="disorder-card" data-disorder="yeast" id="disorder-yeast">
                        <div class="disorder-title">Yeast Infection</div>
                        <div class="disorder-content"></div>
                        <div class="inline-feedback" id="feedback-yeast"></div>
                    </div>
                    <div class="disorder-card" data-disorder="bv" id="disorder-bv">
                        <div class="disorder-title">Bacterial Vaginosis</div>
                        <div class="disorder-content"></div>
                        <div class="inline-feedback" id="feedback-bv"></div>
                    </div>
                </div>

                <!-- Wrong Answer Explanation -->
                <div class="wrong-answer-explanation" id="activity2-wrong-explanation">
                    <div class="explanation-title">
                        <span>❌</span> Why This Match Is Incorrect
                    </div>
                    <div class="explanation-content" id="activity2-explanation-content">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Disorder Items -->
                <div class="disorder-items" id="disorder-items">
                    <div class="disorder-item draggable" data-disorder="pcos" draggable="true">Irregular periods, hirsutism, insulin resistance</div>
                    <div class="disorder-item draggable" data-disorder="pcos" draggable="true">Multiple ovarian cysts on ultrasound</div>
                    <div class="disorder-item draggable" data-disorder="endometriosis" draggable="true">Painful periods, dyspareunia, infertility</div>
                    <div class="disorder-item draggable" data-disorder="endometriosis" draggable="true">Endometrial tissue outside uterus</div>
                    <div class="disorder-item draggable" data-disorder="fibroids" draggable="true">Heavy menstrual bleeding, pelvic pressure</div>
                    <div class="disorder-item draggable" data-disorder="fibroids" draggable="true">Benign uterine muscle tumors</div>
                    <div class="disorder-item draggable" data-disorder="dysmenorrhea" draggable="true">Primary: no pelvic pathology</div>
                    <div class="disorder-item draggable" data-disorder="dysmenorrhea" draggable="true">Secondary: caused by underlying condition</div>
                    <div class="disorder-item draggable" data-disorder="yeast" draggable="true">Thick white discharge, itching, burning</div>
                    <div class="disorder-item draggable" data-disorder="yeast" draggable="true">Caused by Candida overgrowth</div>
                    <div class="disorder-item draggable" data-disorder="bv" draggable="true">Thin gray discharge, fishy odor</div>
                    <div class="disorder-item draggable" data-disorder="bv" draggable="true">Gardnerella vaginalis overgrowth</div>
                </div>

                <!-- Detailed Feedback -->
                <div class="detailed-feedback" id="feedback-2">
                    <div class="feedback-title">
                        <span class="feedback-icon correct">✓</span>
                        Menstrual Health Knowledge Demonstrated!
                    </div>
                    <div class="feedback-content">
                        <strong>Your Matches vs. Correct Characteristics:</strong><br><br>
                        
                        <div id="disorder-feedback-pcos" style="display: none;">
                            <strong>PCOS (Polycystic Ovary Syndrome):</strong><br>
                            <span class="your-matches">Your matches: <span id="pcos-your"></span></span><br>
                            <span class="correct-matches">Correct: Irregular periods, hirsutism, insulin resistance + Ovarian cysts</span><br>
                            <div class="clinical-reasoning">
                                <strong>Why These Are Correct:</strong> PCOS diagnosis requires 2 of 3 Rotterdam criteria: 
                                1) Oligo/anovulation, 2) Clinical/biochemical hyperandrogenism (hirsutism), 3) Polycystic ovaries. 
                                Insulin resistance affects 50-70% of PCOS patients regardless of weight.
                            </div>
                            <div class="pro-tip">
                                <strong>Clinical Pearl:</strong> Always screen for diabetes in PCOS patients (oral glucose tolerance test). 
                                Metformin improves insulin sensitivity and may restore ovulation.
                            </div>
                        </div>
                        
                        <div id="disorder-feedback-endo" style="display: none;">
                            <strong>Endometriosis:</strong><br>
                            <span class="your-matches">Your matches: <span id="endo-your"></span></span><br>
                            <span class="correct-matches">Correct: Painful periods, dyspareunia, infertility + Extrauterine endometrial tissue</span><br>
                            <div class="clinical-reasoning">
                                <strong>Why These Are Correct:</strong> Endometriosis causes pain from inflammatory response to 
                                ectopic endometrial tissue. Dyspareunia (pain with sex) is typically deep. Infertility occurs 
                                in 30-50% of cases due to pelvic adhesions and inflammation.
                            </div>
                            <div class="pro-tip">
                                <strong>Diagnostic Tip:</strong> Gold standard = laparoscopic visualization with biopsy. 
                                Transvaginal ultrasound may show endometriomas ("chocolate cysts") but misses superficial implants.
                            </div>
                        </div>
                        
                        <div id="disorder-feedback-fibroids" style="display: none;">
                            <strong>Uterine Fibroids (Leiomyomas):</strong><br>
                            <span class="your-matches">Your matches: <span id="fibroids-your"></span></span><br>
                            <span class="correct-matches">Correct: Heavy bleeding, pelvic pressure + Benign smooth muscle tumors</span><br>
                            <div class="clinical-reasoning">
                                <strong>Why These Are Correct:</strong> Fibroids are estrogen-dependent benign tumors affecting 
                                70-80% of women by age 50. Symptoms depend on location: submucosal → heavy bleeding; 
                                intramural → pressure/pain; subserosal → often asymptomatic.
                            </div>
                            <div class="pro-tip">
                                <strong>Management:</strong> First-line = observation if asymptomatic. Medical therapy = 
                                tranexamic acid for bleeding, GnRH agonists to shrink fibroids pre-surgery. 
                                UAE (uterine artery embolization) preserves uterus.
                            </div>
                        </div>
                        
                        <div id="disorder-feedback-dysmenorrhea" style="display: none;">
                            <strong>Dysmenorrhea (Painful Periods):</strong><br>
                            <span class="your-matches">Your matches: <span id="dysmenorrhea-your"></span></span><br>
                            <span class="correct-matches">Correct: Primary (no pathology) + Secondary (underlying cause)</span><br>
                            <div class="clinical-reasoning">
                                <strong>Why These Are Correct:</strong> Primary dysmenorrhea = painful cramps without pelvic pathology, 
                                caused by prostaglandin release. Secondary dysmenorrhea = pain from underlying condition 
                                (endometriosis, fibroids, adenomyosis, PID). Always rule out secondary causes.
                            </div>
                            <div class="pro-tip">
                                <strong>Treatment:</strong> NSAIDs (start 1-2 days before menses) for primary dysmenorrhea. 
                                For secondary, treat underlying cause. Combined hormonal contraceptives reduce pain in both types.
                            </div>
                        </div>
                        
                        <div id="disorder-feedback-yeast" style="display: none;">
                            <strong>Yeast Infection (Candidiasis):</strong><br>
                            <span class="your-matches">Your matches: <span id="yeast-your"></span></span><br>
                            <span class="correct-matches">Correct: Thick white discharge, itching/burning + Candida overgrowth</span><br>
                            <div class="clinical-reasoning">
                                <strong>Why These Are Correct:</strong> Candida albicans causes 85-90% of yeast infections. 
                                Thick, white, "cottage cheese" discharge is classic. Intense pruritus (itching) and 
                                erythema are hallmark symptoms. Risk factors: antibiotics, diabetes, pregnancy, immunosuppression.
                            </div>
                            <div class="pro-tip">
                                <strong>Treatment:</strong> Topical antifungals (clotrimazole, miconazole) or oral fluconazole. 
                                Recurrent (>4 episodes/year) requires 6-month maintenance therapy. Rule out diabetes in recurrent cases.
                            </div>
                        </div>
                        
                        <div id="disorder-feedback-bv" style="display: none;">
                            <strong>Bacterial Vaginosis:</strong><br>
                            <span class="your-matches">Your matches: <span id="bv-your"></span></span><br>
                            <span class="correct-matches">Correct: Thin gray discharge, fishy odor + Gardnerella overgrowth</span><br>
                            <div class="clinical-reasoning">
                                <strong>Why These Are Correct:</strong> BV results from overgrowth of anaerobic bacteria 
                                (Gardnerella vaginalis, Prevotella) disrupting normal lactobacillus dominance. 
                                "Fishy" amine odor (especially after sex) from pH change. Thin, gray, homogenous discharge.
                            </div>
                            <div class="pro-tip">
                                <strong>Clinical Significance:</strong> BV increases risk of PID, postoperative infections, 
                                and adverse pregnancy outcomes (preterm labor, chorioamnionitis). Treat with metronidazole 
                                or clindamycin.
                            </div>
                        </div>
                        
                        <br><strong>Key Differential Diagnoses:</strong><br>
                        1. PCOS vs. Thyroid disorder: Both cause irregular periods, but PCOS has hyperandrogenism<br>
                        2. Endometriosis vs. PID: Both cause pelvic pain, but PID has fever/cervical motion tenderness<br>
                        3. Yeast vs. BV: Yeast = thick/white/itchy; BV = thin/gray/fishy odor<br>
                        4. Primary vs. Secondary dysmenorrhea: Secondary starts later in life, worsens over time
                    </div>
                </div>

                <!-- Patient Education Note -->
                <div class="ethical-note">
                    <div class="note-icon">👩‍⚕️</div>
                    <div class="note-content">
                        <div class="note-title">Patient Education Focus</div>
                        <div class="note-text">
                            <strong>Menstrual Health:</strong> Normal cycle = 21-35 days, duration = 2-7 days.<br>
                            <strong>Red Flags:</strong> Bleeding between periods, postmenopausal bleeding, severe pain.<br>
                            <strong>Prevention:</strong> Regular Pap tests, HPV vaccination, safe sex practices.<br>
                            <strong>Self-Care:</strong> Heat for cramps, NSAIDs for pain, tracking symptoms.
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-secondary" id="reset-all-btn">
                <span class="btn-icon">↻</span>
                Reset All Activities
            </button>
            <button class="btn btn-secondary" id="check-answers-btn">
                <span class="btn-icon">✓</span>
                Check All Answers
            </button>
            <button class="btn btn-primary" id="view-results-btn">
                <span class="btn-icon">📊</span>
                View Final Results
            </button>
        </div>

        <!-- Results Panel -->
        <div class="results-panel" id="results-panel">
            <div class="results-header">
                <h2 class="results-title">Reproductive Health Competency Results</h2>
                <div class="score-display" id="final-score">0%</div>
            </div>

            <div class="clinical-insights">
                <h3 class="insights-title">
                    <span>🩺</span> Clinical Proficiency Insights
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Contraceptive Selection:</strong> LARC methods (IUDs, implant) have highest efficacy (>99%). Consider medical contraindications, lifestyle, and reproductive plans. Estrogen contraindicated in migraines with aura, hypertension >160/100, history of VTE, smokers >35.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Menstrual Cycle:</strong> Normal cycle = 21-35 days. Follicular phase variable, luteal phase fixed at 14 days. Ovulation occurs 14 days BEFORE next period (not 14 days after last period).</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>PCOS Diagnosis:</strong> Rotterdam criteria require 2 of 3: oligo/anovulation, hyperandrogenism, polycystic ovaries. Manage with lifestyle changes, metformin for insulin resistance, OCPs for hyperandrogenism.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Endometriosis:</strong> Gold standard diagnosis = laparoscopy with biopsy. Medical management with continuous OCPs, progestins, or GnRH agonists. Surgical excision for severe pain/infertility.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Infection Differentiation:</strong> Yeast = thick white discharge, itching. BV = thin gray discharge, fishy odor. Trichomoniasis = frothy yellow-green discharge, itching. PID = lower abdominal pain, fever, cervical motion tenderness.</span>
                    </li>
                </ul>
            </div>

            <div class="clinical-insights" style="margin-top: 20px;">
                <h3 class="insights-title">
                    <span>📋</span> Documentation & Patient Education
                </h3>
                <ul class="insights-list">
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Contraceptive Counseling:</strong> Document method selected, informed consent, education provided, follow-up plan. Include discussion of efficacy, side effects, STD protection, and reversibility.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Menstrual History:</strong> Document LMP, cycle length, duration, flow (pads/tampons per day), associated symptoms (pain, PMS), and any intermenstrual or postcoital bleeding.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Adolescent Confidentiality:</strong> Most states allow confidential reproductive health services for minors. Document patient's understanding and any disclosures to parents per state law.</span>
                    </li>
                    <li>
                        <span class="insight-dot"></span>
                        <span><strong>Cultural Competence:</strong> Respect cultural/religious beliefs about contraception, menstruation, and reproductive health. Use trained interpreters when needed.</span>
                    </li>
                </ul>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // State Management
            const state = {
                activities: {
                    1: { completed: false, correct: 0, total: 5, score: 0 },
                    2: { completed: false, correct: 0, total: 6, score: 0 }
                },
                startedAt: new Date(),
                timeSpent: 0,
                selectedPatient: null,
                placedMethods: {
                    1: [],
                    2: [],
                    3: [],
                    4: [],
                    5: []
                },
                placedDisorders: {
                    pcos: [],
                    endometriosis: [],
                    fibroids: [],
                    dysmenorrhea: [],
                    yeast: [],
                    bv: []
                }
            };

            // Correct answers with detailed explanations
            const correctRecommendations = {
                1: {
                    optimal: ['implant', 'iud-hormonal', 'condom'],
                    explanation: 'College students need convenient, reliable contraception. LARC methods (IUDs, implant) have highest efficacy and don\'t require daily compliance. Condoms provide essential STD protection.'
                },
                2: {
                    optimal: ['tubal', 'iud-hormonal'],
                    explanation: 'Patient wants permanent solution (tubal ligation). Hormonal IUD excellent for heavy bleeding (reduces flow 90%). Both options meet her needs.'
                },
                3: {
                    optimal: ['implant', 'iud-hormonal', 'injection', 'iud-copper'],
                    explanation: 'Estrogen ABSOLUTELY contraindicated in migraines with aura (stroke risk). Progestin-only methods safe. Copper IUD non-hormonal alternative.'
                },
                4: {
                    optimal: ['condom', 'diaphragm', 'fertility-awareness'],
                    explanation: 'Planning pregnancy soon → avoid LARC (removal/reversal time). Barrier methods immediately reversible. Fertility awareness requires regular cycles.'
                },
                5: {
                    optimal: ['iud-copper', 'condom', 'diaphragm'],
                    explanation: 'Hypertension increases stroke risk with estrogen. Perimenopausal but still needs contraception. Copper IUD provides 10-year non-hormonal protection.'
                }
            };

            const correctDisorderMatches = {
                'pcos': {
                    items: ['Irregular periods, hirsutism, insulin resistance', 'Multiple ovarian cysts on ultrasound'],
                    explanation: 'PCOS requires 2 of 3 Rotterdam criteria: oligo/anovulation, hyperandrogenism, polycystic ovaries. Insulin resistance affects most patients.'
                },
                'endometriosis': {
                    items: ['Painful periods, dyspareunia, infertility', 'Endometrial tissue outside uterus'],
                    explanation: 'Endometriosis causes pain from inflammatory response to ectopic endometrial tissue. Infertility occurs in 30-50% of cases.'
                },
                'fibroids': {
                    items: ['Heavy menstrual bleeding, pelvic pressure', 'Benign uterine muscle tumors'],
                    explanation: 'Fibroids are estrogen-dependent benign tumors affecting 70-80% of women. Symptoms: bleeding (submucosal), pressure/pain (intramural).'
                },
                'dysmenorrhea': {
                    items: ['Primary: no pelvic pathology', 'Secondary: caused by underlying condition'],
                    explanation: 'Primary = prostaglandin-mediated pain without pathology. Secondary = pain from endometriosis, fibroids, adenomyosis, or PID.'
                },
                'yeast': {
                    items: ['Thick white discharge, itching, burning', 'Caused by Candida overgrowth'],
                    explanation: 'Candida albicans causes 85-90% of cases. Classic: thick "cottage cheese" discharge, intense pruritus, erythema.'
                },
                'bv': {
                    items: ['Thin gray discharge, fishy odor', 'Gardnerella vaginalis overgrowth'],
                    explanation: 'BV results from anaerobic bacterial overgrowth disrupting lactobacillus. "Fishy" amine odor from pH change, especially post-coital.'
                }
            };

            // Wrong match explanations
            const wrongMatchExplanations = {
                'pcos-endometriosis': {
                    title: 'PCOS vs. Endometriosis',
                    explanation: 'PCOS is a hormonal disorder causing irregular periods, hirsutism, and insulin resistance with ovarian cysts. Endometriosis involves endometrial tissue outside the uterus causing painful periods and infertility. The key difference: PCOS = hormonal imbalance, Endometriosis = ectopic tissue.'
                },
                'pcos-fibroids': {
                    title: 'PCOS vs. Fibroids',
                    explanation: 'PCOS causes hormonal symptoms (hirsutism, insulin resistance) and ovarian cysts. Fibroids are structural uterine tumors causing heavy bleeding and pressure. PCOS affects ovaries and metabolism; fibroids affect uterus only.'
                },
                'endometriosis-fibroids': {
                    title: 'Endometriosis vs. Fibroids',
                    explanation: 'Both cause pelvic pain, but endometriosis pain is cyclical (worse with periods) and causes infertility. Fibroids cause heavy bleeding and pressure symptoms. Endometriosis = inflammatory response to ectopic tissue; Fibroids = benign muscle tumors.'
                },
                'yeast-bv': {
                    title: 'Yeast vs. Bacterial Vaginosis',
                    explanation: 'Yeast infections: thick white "cottage cheese" discharge with itching. BV: thin gray discharge with fishy odor. Yeast = fungal (Candida), BV = bacterial imbalance. Yeast causes inflammation and itching; BV causes odor without inflammation.'
                },
                'dysmenorrhea-endometriosis': {
                    title: 'Dysmenorrhea vs. Endometriosis',
                    explanation: 'Primary dysmenorrhea = painful periods without pelvic pathology. Endometriosis = specific cause of secondary dysmenorrhea with ectopic endometrial tissue. All endometriosis causes dysmenorrhea, but not all dysmenorrhea is endometriosis.'
                }
            };

            // DOM Elements
            const progressSteps = document.querySelectorAll('.progress-step');
            const activityCards = document.querySelectorAll('.activity-card');
            const completedCount = document.getElementById('completed-count');
            const accuracyRate = document.getElementById('accuracy-rate');
            const timeSpentEl = document.getElementById('time-spent');
            const resetBtn = document.getElementById('reset-all-btn');
            const checkBtn = document.getElementById('check-answers-btn');
            const resultsBtn = document.getElementById('view-results-btn');
            const resultsPanel = document.getElementById('results-panel');
            const finalScore = document.getElementById('final-score');
            const selectedPatientSpan = document.getElementById('selected-patient');
            const patientDropzone = document.getElementById('patient-dropzone');
            const droppedMethodsDiv = document.getElementById('dropped-methods');
            const sliderThumb = document.getElementById('slider-thumb');
            const sliderTrack = document.getElementById('slider-track');
            const cyclePhase = document.getElementById('cycle-phase');
            const cycleDay = document.getElementById('cycle-day');
            const estrogenLevel = document.getElementById('estrogen-level');
            const progesteroneLevel = document.getElementById('progesterone-level');
            const feedback1 = document.getElementById('feedback-1');
            const feedback2 = document.getElementById('feedback-2');
            const wrongExplanation1 = document.getElementById('activity1-wrong-explanation');
            const wrongExplanation2 = document.getElementById('activity2-wrong-explanation');
            const explanationContent1 = document.getElementById('activity1-explanation-content');
            const explanationContent2 = document.getElementById('activity2-explanation-content');

            // Timer for time spent
            function updateTimer() {
                const now = new Date();
                const diff = Math.floor((now - state.startedAt) / 1000);
                state.timeSpent = diff;
                const minutes = Math.floor(diff / 60);
                const seconds = diff % 60;
                timeSpentEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
            setInterval(updateTimer, 1000);

            // Update Progress Summary
            function updateProgressSummary() {
                let completed = 0;
                let totalCorrect = 0;
                let totalItems = 0;

                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) completed++;
                    totalCorrect += activity.correct;
                    totalItems += activity.total;
                });

                completedCount.textContent = completed;
                const accuracy = totalItems > 0 ? Math.round((totalCorrect / totalItems) * 100) : 0;
                accuracyRate.textContent = `${accuracy}%`;

                progressSteps.forEach((step, index) => {
                    if (index < completed) {
                        step.classList.add('completed');
                        step.classList.remove('active');
                    } else if (index === completed) {
                        step.classList.add('active');
                        step.classList.remove('completed');
                    } else {
                        step.classList.remove('active', 'completed');
                    }
                });
            }

            // Activity 1: Contraceptive Method Selection Simulator
            function initActivity1() {
                const patientCards = document.querySelectorAll('#activity-1 .patient-card');
                const methodItems = document.querySelectorAll('#activity-1 .method-item');
                const status = document.querySelector('#activity-1 .activity-status');

                // Patient selection
                patientCards.forEach(card => {
                    card.addEventListener('click', function() {
                        if (state.activities[1].completed) return;

                        patientCards.forEach(c => c.classList.remove('selected'));
                        this.classList.add('selected');
                        
                        state.selectedPatient = this.dataset.patient;
                        selectedPatientSpan.textContent = this.querySelector('.patient-age').textContent;
                        
                        updateDropzoneDisplay();
                    });
                });

                // Setup drag and drop for methods
                methodItems.forEach(item => {
                    item.addEventListener('dragstart', function(e) {
                        if (!state.selectedPatient) {
                            showWrongExplanation('Please select a patient first before dragging methods.');
                            e.preventDefault();
                            return;
                        }
                        e.dataTransfer.setData('text/plain', JSON.stringify({
                            method: this.dataset.method,
                            text: this.textContent,
                            category: this.dataset.category
                        }));
                        this.classList.add('dragging');
                    });

                    item.addEventListener('dragend', function() {
                        this.classList.remove('dragging');
                    });
                });

                // Dropzone setup
                patientDropzone.addEventListener('dragover', function(e) {
                    if (!state.selectedPatient) return;
                    e.preventDefault();
                    this.classList.add('hover');
                });

                patientDropzone.addEventListener('dragleave', function() {
                    this.classList.remove('hover');
                });

                patientDropzone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('hover');
                    
                    if (!state.selectedPatient) {
                        showWrongExplanation('Please select a patient first before dropping methods.');
                        return;
                    }

                    const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                    
                    if (!state.placedMethods[state.selectedPatient].includes(data.method)) {
                        // Check if method is appropriate for this patient
                        const isCorrect = correctRecommendations[state.selectedPatient].optimal.includes(data.method);
                        
                        if (!isCorrect) {
                            // Show educational feedback about why this might not be ideal
                            showMethodFeedback(data.method, state.selectedPatient, data.category);
                        }
                        
                        state.placedMethods[state.selectedPatient].push(data.method);
                        updateDropzoneDisplay();
                        
                        checkActivity1Completion();
                    }
                });

                // Show method feedback
                function showMethodFeedback(methodId, patientId, category) {
                    const patientInfo = {
                        1: 'college student needing convenience and STD protection',
                        2: 'mother of 3 wanting permanent solution',
                        3: 'patient with migraines with aura (estrogen contraindicated)',
                        4: 'patient planning pregnancy in 1 year',
                        5: 'perimenopausal patient with hypertension'
                    };
                    
                    const methodExplanations = {
                        'oral': 'Oral contraceptive pills require daily compliance, which may be challenging for busy students. They also don\'t provide STD protection.',
                        'patch': 'The patch provides good efficacy but doesn\'t offer STD protection and may not be ideal for all lifestyles.',
                        'ring': 'The vaginal ring requires monthly insertion/removal and doesn\'t provide STD protection.',
                        'injection': 'Depo-Provera injection can cause weight gain and bone density loss with long-term use.',
                        'emergency': 'Emergency contraception is for emergencies only, not regular contraception.',
                        'fertility-awareness': 'Fertility awareness requires regular cycles and careful tracking, with higher failure rates.',
                        'vasectomy': 'Vasectomy is a male procedure - ensure patient understands this involves partner cooperation.'
                    };
                    
                    const explanation = methodExplanations[methodId] || 
                        `This ${category} method may not be optimal for a ${patientInfo[patientId]}. Consider patient preferences, medical history, and lifestyle factors.`;
                    
                    explanationContent1.innerHTML = `
                        <strong>Method:</strong> ${getMethodName(methodId)}<br>
                        <strong>Patient:</strong> ${patientInfo[patientId]}<br>
                        <strong>Why this might not be ideal:</strong> ${explanation}<br><br>
                        <strong>Better options:</strong> ${correctRecommendations[patientId].optimal.map(getMethodName).join(', ')}`
                    
                    wrongExplanation1.classList.add('show');
                    
                    // Auto-hide after 8 seconds
                    setTimeout(() => {
                        wrongExplanation1.classList.remove('show');
                    }, 8000);
                }

                function getMethodName(methodId) {
                    const methodItems = document.querySelectorAll('#activity-1 .method-item');
                    const item = Array.from(methodItems).find(item => item.dataset.method === methodId);
                    return item ? item.textContent : methodId;
                }

                // Update dropzone display
                function updateDropzoneDisplay() {
                    droppedMethodsDiv.innerHTML = '';
                    
                    if (state.selectedPatient && state.placedMethods[state.selectedPatient].length > 0) {
                        state.placedMethods[state.selectedPatient].forEach(methodId => {
                            const methodElement = Array.from(methodItems).find(item => item.dataset.method === methodId);
                            if (methodElement) {
                                const div = document.createElement('div');
                                div.className = 'dropped-method';
                                
                                // Check if method is correct for this patient
                                const isCorrect = correctRecommendations[state.selectedPatient].optimal.includes(methodId);
                                if (!isCorrect) {
                                    div.classList.add('incorrect');
                                }
                                
                                div.textContent = methodElement.textContent;
                                div.dataset.method = methodId;
                                
                                // Add remove functionality
                                div.addEventListener('click', function(e) {
                                    if (e.target === this && !state.activities[1].completed) {
                                        const methodToRemove = this.dataset.method;
                                        const index = state.placedMethods[state.selectedPatient].indexOf(methodToRemove);
                                        if (index > -1) {
                                            state.placedMethods[state.selectedPatient].splice(index, 1);
                                        }
                                        updateDropzoneDisplay();
                                    }
                                });
                                
                                droppedMethodsDiv.appendChild(div);
                            }
                        });
                        patientDropzone.classList.remove('empty');
                    } else {
                        patientDropzone.classList.add('empty');
                    }
                }

                // Check activity completion
                function checkActivity1Completion() {
                    const allPatients = ['1', '2', '3', '4', '5'];
                    const allHaveMethods = allPatients.every(patient => 
                        state.placedMethods[patient] && state.placedMethods[patient].length > 0
                    );

                    if (allHaveMethods) {
                        showActivity1Feedback();
                    }
                }

                // Show detailed feedback
                function showActivity1Feedback() {
                    let correctCount = 0;
                    const allPatients = ['1', '2', '3', '4', '5'];
                    
                    // Show feedback for each patient
                    allPatients.forEach(patient => {
                        const placed = state.placedMethods[patient] || [];
                        const correct = correctRecommendations[patient].optimal;
                        const feedbackDiv = document.getElementById(`patient-${patient}-feedback`);
                        
                        if (feedbackDiv) {
                            // Get method names
                            const methodItems = document.querySelectorAll('#activity-1 .method-item');
                            const placedNames = placed.map(methodId => {
                                const item = Array.from(methodItems).find(item => item.dataset.method === methodId);
                                return item ? item.textContent : methodId;
                            });
                            
                            // Update feedback display
                            document.getElementById(`p${patient}-your`).textContent = placedNames.join(', ') || 'None';
                            feedbackDiv.style.display = 'block';
                            
                            // Check if at least one correct method
                            const hasCorrect = placed.some(method => correct.includes(method));
                            if (hasCorrect) correctCount++;
                        }
                    });
                    
                    state.activities[1].completed = true;
                    state.activities[1].correct = correctCount;
                    state.activities[1].score = Math.round((correctCount / 5) * 100);
                    
                    status.textContent = 'Completed';
                    document.querySelector('#activity-1').classList.add('completed');
                    feedback1.classList.add('show');
                    wrongExplanation1.classList.remove('show');
                    
                    updateProgressSummary();
                }
            }

            // Activity 2: Menstrual Cycle & Disorders Explorer
            function initActivity2() {
                const disorderCards = document.querySelectorAll('#activity-2 .disorder-card');
                const disorderItems = document.querySelectorAll('#activity-2 .disorder-item');
                const status = document.querySelector('#activity-2 .activity-status');

                // Menstrual cycle slider
                let isDragging = false;
                
                function updateCycleDisplay(day) {
                    day = Math.max(1, Math.min(28, day));
                    cycleDay.textContent = `Day ${day}`;
                    
                    if (day <= 14) {
                        cyclePhase.textContent = `Follicular Phase (Day 1-14)`;
                    } else {
                        cyclePhase.textContent = `Luteal Phase (Day 15-28)`;
                    }
                    
                    let estrogenWidth, progesteroneWidth;
                    
                    if (day <= 14) {
                        estrogenWidth = 30 + (day / 14) * 70;
                        progesteroneWidth = 10;
                    } else {
                        estrogenWidth = 100 - ((day - 14) / 14) * 40;
                        progesteroneWidth = 10 + ((day - 14) / 14) * 90;
                    }
                    
                    estrogenLevel.style.width = `${estrogenWidth}%`;
                    progesteroneLevel.style.width = `${progesteroneWidth}%`;
                    
                    const percent = ((day - 1) / 27) * 100;
                    sliderThumb.style.left = `${percent}%`;
                }
                
                // Mouse events for slider
                sliderThumb.addEventListener('mousedown', function(e) {
                    isDragging = true;
                    document.addEventListener('mousemove', onMouseMove);
                    document.addEventListener('mouseup', onMouseUp);
                });
                
                sliderTrack.addEventListener('mousedown', function(e) {
                    const rect = this.getBoundingClientRect();
                    let x = e.clientX - rect.left;
                    x = Math.max(0, Math.min(rect.width, x));
                    const percent = (x / rect.width) * 100;
                    const day = Math.round(1 + (percent / 100) * 27);
                    updateCycleDisplay(day);
                });
                
                function onMouseMove(e) {
                    if (!isDragging) return;
                    const rect = sliderTrack.getBoundingClientRect();
                    let x = e.clientX - rect.left;
                    x = Math.max(0, Math.min(rect.width, x));
                    const percent = (x / rect.width) * 100;
                    const day = Math.round(1 + (percent / 100) * 27);
                    updateCycleDisplay(day);
                }
                
                function onMouseUp() {
                    isDragging = false;
                    document.removeEventListener('mousemove', onMouseMove);
                    document.removeEventListener('mouseup', onMouseUp);
                }
                
                // Initialize display
                updateCycleDisplay(1);

                // Setup drag and drop for disorders
                let draggedItem = null;

                disorderItems.forEach(item => {
                    item.addEventListener('dragstart', function(e) {
                        draggedItem = this;
                        e.dataTransfer.setData('text/plain', this.dataset.disorder);
                        this.classList.add('dragging');
                    });

                    item.addEventListener('dragend', function() {
                        this.classList.remove('dragging');
                        draggedItem = null;
                    });
                });

                disorderCards.forEach(card => {
                    card.addEventListener('dragover', function(e) {
                        e.preventDefault();
                        this.classList.add('hover');
                    });

                    card.addEventListener('dragleave', function() {
                        this.classList.remove('hover');
                    });

                    card.addEventListener('drop', function(e) {
                        e.preventDefault();
                        this.classList.remove('hover');
                        
                        if (!draggedItem) return;
                        
                        const targetDisorder = this.dataset.disorder;
                        const draggedDisorder = draggedItem.dataset.disorder;
                        
                        if (draggedDisorder === targetDisorder) {
                            // Correct match
                            const existingItems = Array.from(this.querySelectorAll('.disorder-content div'));
                            const alreadyPlaced = existingItems.some(div => div.textContent === draggedItem.textContent);
                            
                            if (!alreadyPlaced) {
                                // Add to card
                                const div = document.createElement('div');
                                div.textContent = draggedItem.textContent;
                                div.style.padding = '6px 10px';
                                div.style.margin = '4px 0';
                                div.style.background = 'rgba(0, 184, 148, 0.1)';
                                div.style.borderRadius = '8px';
                                div.style.fontSize = '0.8rem';
                                this.querySelector('.disorder-content').appendChild(div);
                                
                                // Hide original item
                                draggedItem.style.display = 'none';
                                
                                // Add to placed items
                                if (!state.placedDisorders[targetDisorder].includes(draggedItem.textContent)) {
                                    state.placedDisorders[targetDisorder].push(draggedItem.textContent);
                                }
                                
                                this.classList.add('filled');
                                
                                // Check completion
                                checkActivity2Completion();
                            }
                        } else {
                            // Wrong match - show inline feedback
                            showInlineFeedback(this, draggedItem, targetDisorder, draggedDisorder);
                        }
                    });
                });

                // Show inline feedback for wrong matches
                function showInlineFeedback(card, draggedItem, targetDisorder, draggedDisorder) {
                    // Add visual feedback
                    card.classList.add('wrong-drop');
                    setTimeout(() => {
                        card.classList.remove('wrong-drop');
                    }, 500);
                    
                    // Get feedback element
                    const feedbackEl = card.querySelector('.inline-feedback');
                    if (feedbackEl) {
                        // Get explanation
                        const explanation = getWrongMatchExplanation(draggedDisorder, targetDisorder);
                        
                        // Show feedback
                        feedbackEl.textContent = `Incorrect! This belongs with ${getDisorderName(draggedDisorder)}`;
                        feedbackEl.classList.add('show');
                        
                        // Also show detailed explanation below
                        showWrongMatchExplanation(draggedItem.textContent, draggedDisorder, targetDisorder);
                        
                        // Auto-hide after 4 seconds
                        setTimeout(() => {
                            feedbackEl.classList.remove('show');
                        }, 4000);
                    }
                }

                function getDisorderName(code) {
                    const names = {
                        'pcos': 'PCOS',
                        'endometriosis': 'Endometriosis',
                        'fibroids': 'Uterine Fibroids',
                        'dysmenorrhea': 'Dysmenorrhea',
                        'yeast': 'Yeast Infection',
                        'bv': 'Bacterial Vaginosis'
                    };
                    return names[code] || code;
                }

                function getWrongMatchExplanation(wrongDisorder, correctDisorder) {
                    const key = `${wrongDisorder}-${correctDisorder}`;
                    const reverseKey = `${correctDisorder}-${wrongDisorder}`;
                    
                    if (wrongMatchExplanations[key]) {
                        return wrongMatchExplanations[key].explanation;
                    } else if (wrongMatchExplanations[reverseKey]) {
                        return wrongMatchExplanations[reverseKey].explanation;
                    } else {
                        return `This characteristic belongs with ${getDisorderName(wrongDisorder)}, not ${getDisorderName(correctDisorder)}. They are different conditions with distinct clinical presentations.`;
                    }
                }

                function showWrongMatchExplanation(itemText, correctDisorder, wrongDisorder) {
                    const key = `${correctDisorder}-${wrongDisorder}`;
                    const reverseKey = `${wrongDisorder}-${correctDisorder}`;
                    
                    let title = `Incorrect Match: ${getDisorderName(correctDisorder)} vs ${getDisorderName(wrongDisorder)}`;
                    let explanation = getWrongMatchExplanation(correctDisorder, wrongDisorder);
                    
                    if (wrongMatchExplanations[key]) {
                        title = wrongMatchExplanations[key].title;
                    } else if (wrongMatchExplanations[reverseKey]) {
                        title = wrongMatchExplanations[reverseKey].title;
                    }
                    
                    explanationContent2.innerHTML = `
                        <strong>Item:</strong> "${itemText}"<br>
                        <strong>Your match:</strong> ${getDisorderName(wrongDisorder)}<br>
                        <strong>Correct match:</strong> ${getDisorderName(correctDisorder)}<br><br>
                        <strong>Why this is incorrect:</strong> ${explanation}<br><br>
                        <strong>Key difference:</strong> ${getKeyDifference(correctDisorder, wrongDisorder)}`
                    
                    wrongExplanation2.classList.add('show');
                    
                    // Auto-hide after 8 seconds
                    setTimeout(() => {
                        wrongExplanation2.classList.remove('show');
                    }, 8000);
                }

                function getKeyDifference(disorder1, disorder2) {
                    const differences = {
                        'pcos-endometriosis': 'PCOS = hormonal/metabolic disorder; Endometriosis = ectopic tissue causing inflammation',
                        'pcos-fibroids': 'PCOS = ovarian dysfunction; Fibroids = uterine structural issue',
                        'endometriosis-fibroids': 'Endometriosis pain is cyclical; Fibroids cause heavy bleeding',
                        'yeast-bv': 'Yeast = fungal infection with itching; BV = bacterial imbalance with odor',
                        'dysmenorrhea-endometriosis': 'Dysmenorrhea = symptom; Endometriosis = specific disease causing the symptom'
                    };
                    
                    const key1 = `${disorder1}-${disorder2}`;
                    const key2 = `${disorder2}-${disorder1}`;
                    
                    return differences[key1] || differences[key2] || 'Different pathophysiological mechanisms and clinical presentations.';
                }

                // Check activity completion
                function checkActivity2Completion() {
                    const allDisorders = ['pcos', 'endometriosis', 'fibroids', 'dysmenorrhea', 'yeast', 'bv'];
                    const allComplete = allDisorders.every(disorder => 
                        state.placedDisorders[disorder] && state.placedDisorders[disorder].length === 2
                    );

                    if (allComplete) {
                        showActivity2Feedback();
                    }
                }

                // Show detailed feedback
                function showActivity2Feedback() {
                    let correctCount = 0;
                    const allDisorders = ['pcos', 'endometriosis', 'fibroids', 'dysmenorrhea', 'yeast', 'bv'];
                    
                    // Show feedback for each disorder
                    allDisorders.forEach(disorder => {
                        const placed = state.placedDisorders[disorder] || [];
                        const correct = correctDisorderMatches[disorder].items;
                        const feedbackDiv = document.getElementById(`disorder-feedback-${disorder}`);
                        
                        if (feedbackDiv) {
                            document.getElementById(`${disorder}-your`).textContent = placed.join('; ') || 'None';
                            feedbackDiv.style.display = 'block';
                            
                            // Check if both correct items are placed
                            const allCorrect = correct.every(item => placed.includes(item));
                            if (allCorrect) correctCount++;
                        }
                    });
                    
                    state.activities[2].completed = true;
                    state.activities[2].correct = correctCount;
                    state.activities[2].score = Math.round((correctCount / 6) * 100);
                    
                    status.textContent = 'Completed';
                    document.querySelector('#activity-2').classList.add('completed');
                    feedback2.classList.add('show');
                    wrongExplanation2.classList.remove('show');
                    
                    updateProgressSummary();
                }
            }

            // Reset All Activities
            function resetAllActivities() {
                Object.keys(state.activities).forEach(key => {
                    state.activities[key] = {
                        completed: false,
                        correct: 0,
                        total: parseInt(key) === 1 ? 5 : 6,
                        score: 0
                    };
                });
                
                state.selectedPatient = null;
                state.placedMethods = {1: [], 2: [], 3: [], 4: [], 5: []};
                state.placedDisorders = {pcos: [], endometriosis: [], fibroids: [], dysmenorrhea: [], yeast: [], bv: []};

                activityCards.forEach(card => {
                    card.classList.remove('completed');
                    const status = card.querySelector('.activity-status');
                    status.textContent = 'Not Started';
                    const feedback = card.querySelector('.detailed-feedback');
                    feedback.classList.remove('show');
                });

                // Reset Activity 1
                document.querySelectorAll('#activity-1 .patient-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                selectedPatientSpan.textContent = 'None';
                droppedMethodsDiv.innerHTML = '';
                patientDropzone.classList.add('empty');
                
                document.querySelectorAll('#activity-1 .method-item').forEach(item => {
                    item.style.display = '';
                });

                // Reset Activity 2
                updateCycleDisplay(1);
                
                document.querySelectorAll('#activity-2 .disorder-content').forEach(content => {
                    content.innerHTML = '';
                });
                
                document.querySelectorAll('#activity-2 .disorder-card').forEach(card => {
                    card.classList.remove('filled', 'hover', 'wrong-drop');
                });
                
                document.querySelectorAll('#activity-2 .disorder-item').forEach(item => {
                    item.style.display = '';
                });

                // Hide all feedback sections
                for (let i = 1; i <= 5; i++) {
                    const feedback = document.getElementById(`patient-${i}-feedback`);
                    if (feedback) feedback.style.display = 'none';
                }
                
                const disorders = ['pcos', 'endo', 'fibroids', 'dysmenorrhea', 'yeast', 'bv'];
                disorders.forEach(disorder => {
                    const feedback = document.getElementById(`disorder-feedback-${disorder}`);
                    if (feedback) feedback.style.display = 'none';
                });

                // Hide wrong answer explanations
                wrongExplanation1.classList.remove('show');
                wrongExplanation2.classList.remove('show');

                // Hide inline feedback
                document.querySelectorAll('.inline-feedback').forEach(fb => {
                    fb.classList.remove('show');
                });

                resultsPanel.classList.remove('show');
                updateProgressSummary();
            }

            // Check All Answers
            function checkAllAnswers() {
                // Activity 1
                if (!state.activities[1].completed) {
                    const allPatients = ['1', '2', '3', '4', '5'];
                    
                    allPatients.forEach(patient => {
                        if (correctRecommendations[patient].optimal.length > 0) {
                            state.placedMethods[patient] = [correctRecommendations[patient].optimal[0]];
                        }
                    });
                    
                    const firstPatientCard = document.querySelector('#activity-1 .patient-card[data-patient="1"]');
                    if (firstPatientCard) {
                        firstPatientCard.click();
                        updateDropzoneDisplayForPatient('1');
                    }
                    
                    showActivity1Feedback();
                }

                // Activity 2
                if (!state.activities[2].completed) {
                    const allDisorders = ['pcos', 'endometriosis', 'fibroids', 'dysmenorrhea', 'yeast', 'bv'];
                    
                    allDisorders.forEach(disorder => {
                        state.placedDisorders[disorder] = correctDisorderMatches[disorder].items;
                    });
                    
                    // Update display
                    allDisorders.forEach(disorder => {
                        const card = document.getElementById(`disorder-${disorder}`);
                        const content = card.querySelector('.disorder-content');
                        content.innerHTML = '';
                        
                        correctDisorderMatches[disorder].items.forEach(text => {
                            const div = document.createElement('div');
                            div.textContent = text;
                            div.style.padding = '6px 10px';
                            div.style.margin = '4px 0';
                            div.style.background = 'rgba(0, 184, 148, 0.1)';
                            div.style.borderRadius = '8px';
                            div.style.fontSize = '0.8rem';
                            content.appendChild(div);
                        });
                        
                        card.classList.add('filled');
                        
                        // Hide the correct items
                        correctDisorderMatches[disorder].items.forEach(text => {
                            const item = Array.from(document.querySelectorAll('#activity-2 .disorder-item'))
                                .find(item => item.textContent === text);
                            if (item) item.style.display = 'none';
                        });
                    });
                    
                    showActivity2Feedback();
                }
            }

            // Helper functions
            function updateDropzoneDisplayForPatient(patientId) {
                const methodItems = document.querySelectorAll('#activity-1 .method-item');
                droppedMethodsDiv.innerHTML = '';
                
                if (state.placedMethods[patientId] && state.placedMethods[patientId].length > 0) {
                    state.placedMethods[patientId].forEach(methodId => {
                        const methodElement = Array.from(methodItems).find(item => item.dataset.method === methodId);
                        if (methodElement) {
                            const div = document.createElement('div');
                            div.className = 'dropped-method';
                            div.textContent = methodElement.textContent;
                            div.dataset.method = methodId;
                            droppedMethodsDiv.appendChild(div);
                        }
                    });
                    patientDropzone.classList.remove('empty');
                }
            }

            // View Final Results
            function viewFinalResults() {
                let totalScore = 0;
                let activityCount = 0;
                
                Object.values(state.activities).forEach(activity => {
                    if (activity.completed) {
                        totalScore += activity.score;
                        activityCount++;
                    }
                });
                
                const averageScore = activityCount > 0 ? Math.round(totalScore / activityCount) : 0;
                finalScore.textContent = `${averageScore}%`;
                resultsPanel.classList.add('show');
                
                resultsPanel.scrollIntoView({ behavior: 'smooth' });
            }

            // Initialize all activities
            initActivity1();
            initActivity2();

            // Event listeners
            resetBtn.addEventListener('click', resetAllActivities);
            checkBtn.addEventListener('click', checkAllAnswers);
            resultsBtn.addEventListener('click', viewFinalResults);

            // Initial progress update
            updateProgressSummary();
        });
    </script>
</body>
</html>
