<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ALLIEDRx -- Chapter 15: GI System Fundamentals & Assessment Simulator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        /* === ALLIEDRx BRANDING EXACT MATCH === */
        :root {
            --color-primary: #af4bef; /* Purple - main brand color */
            --color-primary-soft: #d492ff; /* Light purple */
            --color-accent: #8380f0; /* Blue-purple accent */
            --color-success: #00b894; /* Green for correct/success */
            --color-warning: #fdcb6e;
            --color-error: #e17055; /* Red/Orange for errors */
            --color-bg: #f7f5fb; /* Light background */
            --color-text: #2b2b2b; /* Dark text */
            --color-muted: #6c6880; /* Muted text */
            --radius-lg: 24px;
            --radius-md: 16px;
            --radius-sm: 12px;
            --shadow-soft: 0 18px 45px rgba(23, 10, 61, 0.18);
            --shadow-medium: 0 12px 30px rgba(23, 10, 61, 0.12);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            overflow-x: hidden;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        body {
            padding: 24px;
            background: radial-gradient(
                circle at top left,
                #ffffff 0,
                #f1ecff 40%,
                var(--color-bg) 100%
            );
            color: var(--color-text);
            -webkit-text-size-adjust: 100%;
        }

        @media (max-width: 600px) {
            body {
                padding: 12px;
            }
        }

        /* === ANIMATIONS === */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes checkmarkPop {
            0% { transform: scale(0); opacity: 0; }
            70% { transform: scale(1.2); }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes scoreCountUp {
            from { width: 0%; }
            to { width: var(--target-width); }
        }

        /* === MAIN PAGE CONTAINER === */
        .page {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-soft);
            padding: 28px 30px 32px;
            display: flex;
            flex-direction: column;
            gap: 32px;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.6s ease-out;
        }

        @media (max-width: 900px) {
            .page {
                padding: 22px;
                gap: 28px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 0;
            }
            .page {
                border-radius: 0;
                box-shadow: none;
                padding: 18px 14px 22px;
                gap: 24px;
            }
        }

        /* === ALLIEDRx HEADER/BRANDING === */
        .brand-row {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 14px;
            margin-bottom: 8px;
            flex-wrap: wrap;
            width: 100%;
            animation: fadeInUp 0.5s ease-out;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .brand-logo {
            height: 40px;
            width: auto;
            max-width: 100%;
            filter: drop-shadow(0 3px 8px rgba(0, 0, 0, 0.2));
        }

        .course-meta {
            display: flex;
            flex-direction: column;
            gap: 2px;
            max-width: 100%;
        }

        .course-name {
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: var(--color-muted);
            white-space: normal;
        }

        .week-label {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 10px;
            border-radius: 999px;
            background: rgba(175, 75, 239, 0.08);
            font-size: 0.76rem;
            color: var(--color-primary);
            white-space: normal;
        }

        .week-label-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: var(--color-success);
            flex-shrink: 0;
            animation: pulse 2s infinite;
        }

        .badge-mode {
            padding: 5px 10px;
            border-radius: 999px;
            background: rgba(12, 10, 24, 0.06);
            border: 1px solid rgba(12, 10, 24, 0.08);
            font-size: 0.74rem;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: var(--color-muted);
            white-space: nowrap;
        }

        @media (max-width: 480px) {
            .brand-row {
                flex-direction: column;
                align-items: flex-start;
            }
            .badge-mode {
                margin-top: 6px;
            }
        }

        /* === MODULE HEADER === */
        .module-header {
            animation: fadeInUp 0.5s ease-out 0.1s both;
        }

        h1 {
            font-size: clamp(2rem, 3vw, 2.4rem);
            line-height: 1.05;
            color: var(--color-primary);
            margin-bottom: 6px;
        }

        .module-subtitle {
            font-size: 1.1rem;
            color: var(--color-muted);
            max-width: 800px;
            margin-bottom: 6px;
        }

        .module-description {
            font-size: 0.98rem;
            color: var(--color-muted);
            max-width: 800px;
            line-height: 1.6;
        }

        /* === CLINICAL TIP STYLES === */
        .clinical-tip {
            margin: 20px 0;
            padding: 16px 20px;
            background: rgba(175, 75, 239, 0.05);
            border-left: 4px solid var(--color-primary);
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .tip-label {
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* === PROGRESS TRACKER === */
        .progress-tracker {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 8px 0 20px;
            animation: fadeInUp 0.5s ease-out 0.2s both;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--color-muted);
        }

        .progress-step.active {
            color: var(--color-primary);
            font-weight: 600;
        }

        .progress-step.completed {
            color: var(--color-success);
        }

        .step-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(12, 10, 24, 0.06);
            color: var(--color-muted);
        }

        .progress-step.active .step-icon {
            background: var(--color-primary);
            color: white;
        }

        .progress-step.completed .step-icon {
            background: var(--color-success);
            color: white;
        }

        .step-divider {
            flex: 1;
            height: 2px;
            background: rgba(12, 10, 24, 0.1);
            margin: 0 8px;
        }

        /* === PROGRESS SUMMARY === */
        .progress-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 16px;
            padding: 16px;
            background: rgba(175, 75, 239, 0.03);
            border-radius: var(--radius-sm);
            animation: fadeInUp 0.5s ease-out 0.3s both;
        }

        @media (max-width: 480px) {
            .progress-summary {
                grid-template-columns: 1fr;
                gap: 12px;
            }
        }

        .progress-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .progress-number {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--color-primary);
        }

        .progress-label {
            font-size: 0.75rem;
            color: var(--color-muted);
            text-align: center;
        }

        /* === ACTIVITY GRID === */
        .activity-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 32px;
            margin-bottom: 24px;
            animation: fadeInUp 0.5s ease-out 0.3s both;
        }

        /* === ACTIVITY CARDS === */
        .activity-card {
            background: rgba(175, 75, 239, 0.03);
            border-radius: var(--radius-md);
            border: 1px solid rgba(175, 75, 239, 0.1);
            padding: 28px;
            display: flex;
            flex-direction: column;
            gap: 24px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .activity-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-medium);
        }

        .activity-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .activity-icon {
            width: 42px;
            height: 42px;
            border-radius: 12px;
            background: var(--color-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .activity-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--color-text);
        }

        .activity-description {
            font-size: 1rem;
            color: var(--color-muted);
            line-height: 1.6;
            margin-bottom: 8px;
        }

        /* === ACTIVITY 1: ANATOMY DRAG-AND-DROP === */
        .anatomy-container {
            display: flex;
            flex-direction: column;
            gap: 28px;
        }

        .anatomy-scenario {
            background: white;
            border-radius: var(--radius-md);
            padding: 24px;
            border: 1px solid rgba(12, 10, 24, 0.08);
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .patient-info {
            font-weight: 700;
            color: var(--color-primary);
            font-size: 1.2rem;
            margin-bottom: 8px;
        }

        .patient-demographics {
            font-size: 1rem;
            color: var(--color-muted);
            margin-bottom: 12px;
        }

        .anatomy-instruction {
            font-size: 1rem;
            color: var(--color-muted);
            margin-bottom: 16px;
            font-style: italic;
            padding: 16px;
            background: rgba(175, 75, 239, 0.05);
            border-radius: var(--radius-sm);
            line-height: 1.5;
        }

        .anatomy-instruction strong {
            color: var(--color-primary);
        }

        .abdominal-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 24px 0;
        }

        @media (max-width: 768px) {
            .abdominal-grid {
                grid-template-columns: 1fr;
            }
        }

        .abdominal-quadrant {
            background: white;
            border-radius: var(--radius-sm);
            padding: 24px;
            border: 3px dashed #ddd;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-height: 180px;
            justify-content: center;
            cursor: pointer;
            position: relative;
        }

        .abdominal-quadrant:hover {
            border-color: var(--color-primary-soft);
            background-color: rgba(175, 75, 239, 0.03);
        }

        .abdominal-quadrant.correct-drop {
            border-color: var(--color-success);
            background-color: rgba(0, 184, 148, 0.05);
        }

        .abdominal-quadrant.incorrect-drop {
            border-color: var(--color-error);
            background-color: rgba(225, 112, 85, 0.05);
        }

        .quadrant-title {
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .quadrant-label {
            font-size: 0.9rem;
            color: var(--color-muted);
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .quadrant-instruction {
            font-size: 0.95rem;
            color: var(--color-text);
            line-height: 1.4;
        }

        .organ-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin: 24px 0;
            justify-content: center;
        }

        .organ-tag {
            background: white;
            border: 3px solid var(--color-accent);
            color: var(--color-text);
            padding: 12px 20px;
            border-radius: 24px;
            font-size: 1rem;
            cursor: grab;
            transition: all 0.2s ease;
            user-select: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .organ-tag:hover {
            background: var(--color-accent);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(131, 128, 240, 0.3);
        }

        .organ-tag.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }

        .organ-tag.placed {
            background: var(--color-success);
            color: white;
            border-color: var(--color-success);
            cursor: default;
        }

        .organ-icon {
            font-size: 1.2rem;
        }

        /* === ACTIVITY 2: GI FUNCTION MATCHING === */
        .function-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 32px;
        }

        @media (max-width: 768px) {
            .function-container {
                grid-template-columns: 1fr;
            }
        }

        .function-column {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .function-item {
            background: white;
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 2px solid rgba(12, 10, 24, 0.08);
            cursor: grab;
            user-select: none;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            line-height: 1.5;
            font-weight: 500;
        }

        .function-item:hover {
            transform: translateY(-2px);
            border-color: var(--color-primary-soft);
            box-shadow: var(--shadow-medium);
        }

        .function-item.dragging {
            opacity: 0.7;
            transform: rotate(3deg);
        }

        .function-item.matched {
            border-color: var(--color-success);
            background: rgba(0, 184, 148, 0.05);
        }

        .function-item.incorrect-match {
            border-color: var(--color-error);
            background: rgba(225, 112, 85, 0.05);
        }

        .function-category {
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .function-drop-zones {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 32px;
        }

        @media (max-width: 768px) {
            .function-drop-zones {
                grid-template-columns: 1fr;
            }
        }

        .function-drop-zone {
            min-height: 120px;
            border: 3px dashed var(--color-primary-soft);
            border-radius: var(--radius-sm);
            padding: 20px;
            background: rgba(175, 75, 239, 0.03);
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: flex-start;
        }

        .function-drop-zone.active {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.08);
        }

        /* === ACTIVITY 3: SYMPTOM ASSESSMENT SCENARIOS === */
        .symptom-container {
            display: flex;
            flex-direction: column;
            gap: 32px;
        }

        .symptom-scenario {
            background: white;
            border-radius: var(--radius-md);
            padding: 24px;
            border: 1px solid rgba(12, 10, 24, 0.08);
        }

        .section-title {
            font-size: 1.2rem;
            color: var(--color-primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--color-primary-soft);
        }

        .symptom-instruction {
            font-size: 1rem;
            color: var(--color-muted);
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .symptom-options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        @media (max-width: 768px) {
            .symptom-options-grid {
                grid-template-columns: 1fr;
            }
        }

        .symptom-option {
            background: white;
            border-radius: var(--radius-sm);
            padding: 20px;
            border: 2px solid rgba(12, 10, 24, 0.08);
            display: flex;
            flex-direction: column;
            gap: 12px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .symptom-option:hover {
            transform: translateY(-2px);
            border-color: var(--color-primary-soft);
            box-shadow: var(--shadow-medium);
        }

        .symptom-option.selected {
            border-color: var(--color-primary);
            background: rgba(175, 75, 239, 0.05);
        }

        .symptom-option.correct {
            border-color: var(--color-success);
            background: rgba(0, 184, 148, 0.05);
        }

        .symptom-option.incorrect {
            border-color: var(--color-error);
            background: rgba(225, 112, 85, 0.05);
        }

        .symptom-header {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .symptom-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--color-muted);
            border-radius: 4px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.9rem;
        }

        .symptom-option.selected .symptom-checkbox {
            background: var(--color-primary);
            border-color: var(--color-primary);
        }

        .symptom-option.correct .symptom-checkbox {
            background: var(--color-success);
            border-color: var(--color-success);
        }

        .symptom-option.incorrect .symptom-checkbox {
            background: var(--color-error);
            border-color: var(--color-error);
        }

        .symptom-text {
            font-size: 1rem;
            font-weight: 500;
            color: var(--color-text);
            line-height: 1.5;
        }

        /* === ACTIVITY 4: ABDOMINAL EXAM SEQUENCE === */
        .exam-sequence {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 24px;
        }

        .exam-step {
            background: white;
            border-radius: var(--radius-md);
            padding: 20px;
            border-left: 4px solid var(--color-primary);
            display: flex;
            align-items: flex-start;
            gap: 16px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .exam-step:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-medium);
        }

        .exam-step.active {
            background: rgba(175, 75, 239, 0.05);
        }

        .exam-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--color-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
            font-weight: 700;
            flex-shrink: 0;
            transition: background 0.3s ease;
        }

        .exam-content {
            flex: 1;
        }

        .exam-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 4px;
        }

        .exam-description {
            font-size: 0.9rem;
            color: var(--color-muted);
            line-height: 1.6;
        }

        /* === FEEDBACK SECTION - ALWAYS VISIBLE === */
        .feedback-details {
            margin-top: 24px;
            padding: 20px;
            background: rgba(175, 75, 239, 0.03);
            border-radius: var(--radius-sm);
            border-left: 4px solid var(--color-accent);
            display: block;
            animation: fadeIn 0.5s ease;
            min-height: 100px;
        }

        .feedback-title {
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 12px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feedback-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .feedback-item {
            margin-bottom: 12px;
            padding-left: 24px;
            position: relative;
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .feedback-item.correct:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: var(--color-success);
            font-weight: bold;
        }

        .feedback-item.incorrect:before {
            content: "‚úó";
            position: absolute;
            left: 0;
            color: var(--color-error);
            font-weight: bold;
        }

        .feedback-item.tip:before {
            content: "üí°";
            position: absolute;
            left: 0;
        }

        /* === ACTION BUTTONS === */
        .action-buttons {
            display: flex;
            gap: 16px;
            margin-top: 32px;
            animation: fadeInUp 0.5s ease-out 0.4s both;
        }

        .btn {
            padding: 14px 28px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #9a3ed8;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(175, 75, 239, 0.3);
        }

        .btn-secondary {
            background: rgba(12, 10, 24, 0.06);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: rgba(12, 10, 24, 0.12);
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* === ACTIVITY BUTTONS === */
        .activity-btn {
            padding: 12px 24px;
            background: var(--color-primary);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            align-self: flex-start;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .activity-btn:hover {
            background: #9a3ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(175, 75, 239, 0.3);
        }

        /* === RESULTS PANEL === */
        .results-panel {
            background: rgba(12, 10, 24, 0.94);
            color: #e5e7eb;
            border-radius: var(--radius-md);
            padding: 32px;
            margin-top: 32px;
            display: none;
            animation: fadeIn 0.6s ease;
        }

        .results-panel.show {
            display: block;
        }

        .results-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .results-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: #ffffff;
        }

        .results-content {
            font-size: 1rem;
            line-height: 1.7;
        }

        .results-content strong {
            color: #ffffff;
        }

        .score-display {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 24px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
        }

        .score-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--color-primary-soft);
        }

        .score-text {
            font-size: 1rem;
            color: #c4b5fd;
        }

        .score-bar {
            width: 100%;
            height: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            margin: 20px 0;
            overflow: hidden;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-primary), var(--color-success));
            border-radius: 6px;
            width: 0%;
            animation: scoreCountUp 1.5s ease-in-out forwards;
        }

        /* === CLINICAL INSIGHT CARD === */
        .clinical-insight {
            margin-top: 24px;
            border-radius: var(--radius-sm);
            border: 1px solid rgba(255, 255, 255, 0.16);
            background: rgba(15, 23, 42, 0.7);
            padding: 20px;
            font-size: 0.95rem;
            color: #e5e7eb;
            line-height: 1.6;
        }

        .clinical-insight strong {
            color: #fef3c7;
        }

        /* === FEEDBACK MESSAGES === */
        .feedback-message {
            padding: 16px 20px;
            border-radius: var(--radius-sm);
            margin-top: 16px;
            font-size: 1rem;
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .feedback-correct {
            background: rgba(0, 184, 148, 0.1);
            border-left: 4px solid var(--color-success);
            color: var(--color-success);
            display: block;
        }

        .feedback-incorrect {
            background: rgba(225, 112, 85, 0.1);
            border-left: 4px solid var(--color-error);
            color: var(--color-error);
            display: block;
        }

        /* === RESPONSIVE ADJUSTMENTS === */
        @media (max-width: 768px) {
            .activity-grid {
                gap: 24px;
            }
            .activity-card {
                padding: 20px;
            }
            .action-buttons {
                flex-direction: column;
            }
            .btn {
                width: 100%;
                justify-content: center;
            }
            .abdominal-grid {
                gap: 16px;
            }
            .organ-tags {
                gap: 10px;
            }
            .symptom-options-grid {
                gap: 12px;
            }
        }

        @media (max-width: 480px) {
            .progress-tracker {
                flex-wrap: wrap;
                justify-content: center;
            }
            .step-divider {
                display: none;
            }
        }
    </style>
</head>
<body>
    <main class="page" aria-labelledby="module-heading">
        <!-- Header -->
        <header class="brand-row">
            <div class="brand">
                <img
                    src="https://cdn.prod.website-files.com/64d0ccc1558d601cbfb09021/64e9d2f719b1e5258e5d57f5_IMG_1512-p-500.png"
                    alt="AlliedRx logo"
                    class="brand-logo"
                />
                <div class="course-meta">
                    <span class="course-name">Clinical Medical Assistant ‚Ä¢ Kinn's Chapter 15</span>
                    <div class="week-label">
                        <span class="week-label-dot"></span>
                        <span>Interactive Module 1: GI System Fundamentals & Assessment Simulator</span>
                    </div>
                </div>
            </div>
            <span class="badge-mode">Campus & Online</span>
        </header>

        <!-- Module Header -->
        <section class="module-header">
            <h1 id="module-heading">GI System Fundamentals & Assessment Simulator</h1>
            <p class="module-subtitle">Master GI anatomy, physiology, abdominal assessment, and symptom screening</p>
            <p class="module-description">
                This interactive module covers Objectives 1-5 and 10 from Chapter 15. You'll learn GI anatomy, 
                differentiate abdominal regions, assess GI symptoms, and practice telephone screening techniques.
            </p>
        </section>

        <!-- Clinical Tip -->
        <div class="clinical-tip">
            <div class="tip-label">üí° Clinical Insight</div>
            <p><strong>"RUQ pain often indicates gallbladder or liver issues."</strong>‚ÄîRemember the mnemonic for abdominal quadrants: "Right Upper Quadrant (RUQ): Liver, Gallbladder; Left Upper Quadrant (LUQ): Stomach, Spleen; Right Lower Quadrant (RLQ): Appendix; Left Lower Quadrant (LLQ): Sigmoid Colon."</p>
        </div>

        <!-- Progress Tracker -->
        <div class="progress-tracker">
            <div class="progress-step active">
                <span class="step-icon">1</span>
                <span>Anatomy Placement</span>
            </div>
            <div class="step-divider"></div>
            <div class="progress-step">
                <span class="step-icon">2</span>
                <span>Function Matching</span>
            </div>
            <div class="step-divider"></div>
            <div class="progress-step">
                <span class="step-icon">3</span>
                <span>Symptom Screening</span>
            </div>
            <div class="step-divider"></div>
            <div class="progress-step">
                <span class="step-icon">4</span>
                <span>Exam Sequence</span>
            </div>
        </div>

        <!-- Progress Summary -->
        <div class="progress-summary">
            <div class="progress-item">
                <span class="progress-number" id="completedCount">0</span>
                <span class="progress-label">Activities Completed</span>
            </div>
            <div class="progress-item">
                <span class="progress-number" id="accuracyScore">0%</span>
                <span class="progress-label">Current Accuracy</span>
            </div>
            <div class="progress-item">
                <span class="progress-number" id="timeSpent">0 min</span>
                <span class="progress-label">Time Spent</span>
            </div>
        </div>

        <!-- Activity Grid -->
        <div class="activity-grid">
            <!-- ACTIVITY 1: ANATOMY DRAG-AND-DROP -->
            <section class="activity-card" aria-label="Anatomy Placement Activity">
                <div class="activity-header">
                    <div class="activity-icon">üß†</div>
                    <h2 class="activity-title">GI Anatomy Placement</h2>
                </div>
                <p class="activity-description">
                    <strong>Instructions:</strong> Drag each GI organ to its correct abdominal quadrant or region. 
                    Consider both anatomical location and clinical significance of pain referral patterns.
                </p>
                
                <div class="anatomy-container">
                    <div class="anatomy-scenario">
                        <div class="scenario-header">
                            <div>
                                <div class="patient-info">Activity 1: Abdominal Anatomy Mapping</div>
                                <div class="patient-demographics">Place organs in correct abdominal quadrants</div>
                            </div>
                        </div>
                        
                        <div class="anatomy-instruction">
                            <strong>Clinical Significance:</strong> Knowing organ locations helps identify potential causes of abdominal pain. 
                            RUQ pain suggests liver/gallbladder issues, while RLQ pain raises suspicion for appendicitis.
                        </div>
                        
                        <div class="abdominal-grid">
                            <!-- RUQ -->
                            <div class="abdominal-quadrant" data-quadrant="ruq" id="quadrant-ruq">
                                <div class="quadrant-label">Right Upper Quadrant (RUQ)</div>
                                <div class="quadrant-title">Liver & Gallbladder Zone</div>
                                <div class="quadrant-instruction">Drag liver, gallbladder here</div>
                            </div>
                            
                            <!-- LUQ -->
                            <div class="abdominal-quadrant" data-quadrant="luq" id="quadrant-luq">
                                <div class="quadrant-label">Left Upper Quadrant (LUQ)</div>
                                <div class="quadrant-title">Stomach & Spleen Zone</div>
                                <div class="quadrant-instruction">Drag stomach, spleen here</div>
                            </div>
                            
                            <!-- RLQ -->
                            <div class="abdominal-quadrant" data-quadrant="rlq" id="quadrant-rlq">
                                <div class="quadrant-label">Right Lower Quadrant (RLQ)</div>
                                <div class="quadrant-title">Appendix Zone</div>
                                <div class="quadrant-instruction">Drag appendix here</div>
                            </div>
                            
                            <!-- LLQ -->
                            <div class="abdominal-quadrant" data-quadrant="llq" id="quadrant-llq">
                                <div class="quadrant-label">Left Lower Quadrant (LLQ)</div>
                                <div class="quadrant-title">Sigmoid Colon Zone</div>
                                <div class="quadrant-instruction">Drag sigmoid colon here</div>
                            </div>
                        </div>
                        
                        <div class="organ-tags">
                            <div class="organ-tag" data-organ="liver" id="tag-liver" draggable="true">
                                <span class="organ-icon">ü´Ä</span>
                                Liver
                            </div>
                            <div class="organ-tag" data-organ="gallbladder" id="tag-gallbladder" draggable="true">
                                <span class="organ-icon">üíö</span>
                                Gallbladder
                            </div>
                            <div class="organ-tag" data-organ="stomach" id="tag-stomach" draggable="true">
                                <span class="organ-icon">üçΩÔ∏è</span>
                                Stomach
                            </div>
                            <div class="organ-tag" data-organ="spleen" id="tag-spleen" draggable="true">
                                <span class="organ-icon">üî¥</span>
                                Spleen
                            </div>
                            <div class="organ-tag" data-organ="appendix" id="tag-appendix" draggable="true">
                                <span class="organ-icon">üìå</span>
                                Appendix
                            </div>
                            <div class="organ-tag" data-organ="sigmoid" id="tag-sigmoid" draggable="true">
                                <span class="organ-icon">üåÄ</span>
                                Sigmoid Colon
                            </div>
                            <div class="organ-tag" data-organ="pancreas" id="tag-pancreas" draggable="true">
                                <span class="organ-icon">üéØ</span>
                                Pancreas (Epigastric)
                            </div>
                            <div class="organ-tag" data-organ="small-intestine" id="tag-small-intestine" draggable="true">
                                <span class="organ-icon">üìè</span>
                                Small Intestine (Periumbilical)
                            </div>
                        </div>
                        
                        <div style="margin-top: 24px;">
                            <button class="activity-btn" id="checkAnatomyBtn">
                                ‚úì Check Anatomy Placement
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- FEEDBACK SECTION - ALWAYS VISIBLE -->
                <div class="feedback-details" id="anatomyFeedbackDetails">
                    <div class="feedback-title">
                        <span>üìã Anatomy Placement Feedback:</span>
                    </div>
                    <div style="color: var(--color-muted); font-style: italic; margin-bottom: 12px;">
                        Complete the anatomy placement above, then click "Check Anatomy Placement" to see detailed feedback here.
                    </div>
                    <ul class="feedback-list" id="anatomyFeedbackList">
                        <!-- Feedback will appear here after checking -->
                    </ul>
                </div>
                
                <div class="feedback-message" id="anatomyFeedback"></div>
            </section>

            <!-- ACTIVITY 2: GI FUNCTION MATCHING -->
            <section class="activity-card" aria-label="GI Function Matching Activity">
                <div class="activity-header">
                    <div class="activity-icon">‚öôÔ∏è</div>
                    <h2 class="activity-title">GI Function Matching</h2>
                </div>
                <p class="activity-description">
                    <strong>Instructions:</strong> Match each GI organ with its primary function(s). 
                    Some organs have multiple key functions‚Äîselect the most clinically significant ones.
                </p>
                
                <div class="function-container">
                    <div class="function-column">
                        <div class="function-category">GI Organs</div>
                        <div class="function-item" data-organ="stomach" data-match="A" draggable="true">
                            Stomach
                        </div>
                        <div class="function-item" data-organ="liver" data-match="C" draggable="true">
                            Liver
                        </div>
                        <div class="function-item" data-organ="small-intestine" data-match="B" draggable="true">
                            Small Intestine
                        </div>
                        <div class="function-item" data-organ="colon" data-match="D" draggable="true">
                            Large Intestine (Colon)
                        </div>
                    </div>
                    
                    <div class="function-column">
                        <div class="function-category">Primary Functions</div>
                        <div class="function-item" data-function="digestion" data-match="A" draggable="true">
                            Mechanical/chymification, protein digestion (pepsin), intrinsic factor production
                        </div>
                        <div class="function-item" data-function="absorption" data-match="B" draggable="true">
                            Nutrient absorption (villi/microvilli), completion of digestion
                        </div>
                        <div class="function-item" data-function="metabolism" data-match="C" draggable="true">
                            Bile production, detoxification, protein synthesis, glycogen storage
                        </div>
                        <div class="function-item" data-function="elimination" data-match="D" draggable="true">
                            Water absorption, feces formation, vitamin K production (bacteria)
                        </div>
                    </div>
                </div>
                
                <div class="function-drop-zones">
                    <div class="function-drop-zone" id="drop-organs">
                        <div style="width: 100%; text-align: center; color: var(--color-muted); padding: 10px;">
                            Drag GI Organs Here
                        </div>
                    </div>
                    <div class="function-drop-zone" id="drop-functions">
                        <div style="width: 100%; text-align: center; color: var(--color-muted); padding: 10px;">
                            Drag Primary Functions Here
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 24px;">
                    <button class="activity-btn" id="checkFunctionBtn">
                        ‚úì Check Function Matches
                    </button>
                </div>
                
                <div class="feedback-message" id="functionFeedback"></div>
                
                <div style="margin-top: 24px; padding: 20px; background: rgba(175, 75, 239, 0.05); border-radius: var(--radius-sm); font-size: 0.95rem;">
                    <strong>Clinical Tip:</strong> Understanding GI physiology helps explain symptoms: 
                    Poor fat digestion = gallbladder issues; malabsorption = small intestine problems; 
                    constipation/diarrhea = colon dysfunction; jaundice = liver impairment.
                </div>
            </section>

            <!-- ACTIVITY 3: SYMPTOM ASSESSMENT SCENARIOS -->
            <section class="activity-card" aria-label="Symptom Assessment Activity">
                <div class="activity-header">
                    <div class="activity-icon">üìû</div>
                    <h2 class="activity-title">Telephone Symptom Screening</h2>
                </div>
                <p class="activity-description">
                    <strong>Instructions:</strong> For each patient call, select ALL appropriate screening questions. 
                    Focus on identifying emergency symptoms vs. routine complaints.
                </p>
                
                <div class="symptom-container">
                    <!-- Scenario 1 -->
                    <div class="symptom-scenario">
                        <h3 class="section-title">Scenario 1: Upper Abdominal Pain</h3>
                        <div class="symptom-instruction">
                            <strong>Caller:</strong> "My husband is having bad upper stomach pain. He says it feels like burning and goes through to his back."
                        </div>

                        <div class="symptom-options-grid">
                            <div class="symptom-option" data-scenario="1" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Is there any blood in vomit or stool?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="1" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Does the pain radiate to shoulder or jaw?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="1" data-answer="incorrect">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">What did he eat for breakfast yesterday?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="1" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Is he having trouble breathing or sweating heavily?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="1" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Has he had this type of pain before?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="1" data-answer="incorrect">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Does he exercise regularly?</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Scenario 2 -->
                    <div class="symptom-scenario">
                        <h3 class="section-title">Scenario 2: Rectal Bleeding</h3>
                        <div class="symptom-instruction">
                            <strong>Caller:</strong> "I noticed bright red blood on the toilet paper after my bowel movement this morning. No pain."
                        </div>

                        <div class="symptom-options-grid">
                            <div class="symptom-option" data-scenario="2" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Is there blood mixed in stool or just on tissue?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="2" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Have you had recent constipation or straining?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="2" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Are you feeling dizzy or lightheaded?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="2" data-answer="incorrect">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">What is your favorite color?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="2" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Have you had unexplained weight loss recently?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="2" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Is there a family history of colon cancer?</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Scenario 3 -->
                    <div class="symptom-scenario">
                        <h3 class="section-title">Scenario 3: Severe Nausea/Vomiting</h3>
                        <div class="symptom-instruction">
                            <strong>Caller:</strong> "My daughter has been vomiting for 8 hours straight. She can't keep anything down."
                        </div>

                        <div class="symptom-options-grid">
                            <div class="symptom-option" data-scenario="3" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Is there blood or coffee-ground material in vomit?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="3" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">When was her last wet diaper/urination?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="3" data-answer="incorrect">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">What is her favorite TV show?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="3" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Is she alert or lethargic?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="3" data-answer="correct">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Any fever or abdominal pain?</div>
                                </div>
                            </div>
                            
                            <div class="symptom-option" data-scenario="3" data-answer="incorrect">
                                <div class="symptom-header">
                                    <div class="symptom-checkbox"></div>
                                    <div class="symptom-text">Does she like school?</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 24px;">
                    <button class="activity-btn" id="checkSymptomBtn">
                        ‚úì Check Symptom Screening
                    </button>
                </div>
                
                <div class="feedback-message" id="symptomFeedback"></div>
                
                <div style="margin-top: 24px; padding: 20px; background: rgba(175, 75, 239, 0.05); border-radius: var(--radius-sm); font-size: 0.95rem;">
                    <strong>Clinical Tip:</strong> Telephone screening requires identifying "red flags": 
                    Chest/back pain + sweating = possible MI; blood in vomit/stool = GI bleed; 
                    no urination for 8+ hours = dehydration; unexplained weight loss = possible malignancy.
                </div>
            </section>

            <!-- ACTIVITY 4: ABDOMINAL EXAM SEQUENCE -->
            <section class="activity-card" aria-label="Abdominal Exam Activity">
                <div class="activity-header">
                    <div class="activity-icon">ü©∫</div>
                    <h2 class="activity-title">Abdominal Examination Sequence</h2>
                </div>
                <p class="activity-description">
                    <strong>Instructions:</strong> Click each step in the correct sequence for a comprehensive 
                    abdominal examination. Remember the critical order to avoid altering findings.
                </p>
                
                <div class="exam-sequence">
                    <div class="exam-step" data-step="1" data-order="2">
                        <div class="exam-number">?</div>
                        <div class="exam-content">
                            <div class="exam-title">Percussion</div>
                            <div class="exam-description">Tap to assess organ size, detect fluid (ascites), identify tenderness</div>
                        </div>
                    </div>
                    
                    <div class="exam-step" data-step="2" data-order="4">
                        <div class="exam-number">?</div>
                        <div class="exam-content">
                            <div class="exam-title">Deep Palpation</div>
                            <div class="exam-description">Assess for masses, organ enlargement, deep tenderness</div>
                        </div>
                    </div>
                    
                    <div class="exam-step" data-step="3" data-order="1">
                        <div class="exam-number">?</div>
                        <div class="exam-content">
                            <div class="exam-title">Inspection</div>
                            <div class="exam-description">Observe contour, symmetry, skin, visible peristalsis, pulsations</div>
                        </div>
                    </div>
                    
                    <div class="exam-step" data-step="4" data-order="3">
                        <div class="exam-number">?</div>
                        <div class="exam-content">
                            <div class="exam-title">Auscultation</div>
                            <div class="exam-description">Listen for bowel sounds in all quadrants before touching abdomen</div>
                        </div>
                    </div>
                    
                    <div class="exam-step" data-step="5" data-order="5">
                        <div class="exam-number">?</div>
                        <div class="exam-content">
                            <div class="exam-title">Special Tests</div>
                            <div class="exam-description">Rebound tenderness, Murphy's sign, shifting dullness if indicated</div>
                        </div>
                    </div>
                    
                    <div class="exam-step" data-step="6" data-order="6">
                        <div class="exam-number">?</div>
                        <div class="exam-content">
                            <div class="exam-title">Documentation</div>
                            <div class="exam-description">Record findings using appropriate medical terminology</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 24px;">
                    <button class="activity-btn" id="checkExamBtn">
                        ‚úì Check Exam Sequence
                    </button>
                </div>
                
                <div class="feedback-message" id="examFeedback"></div>
                
                <div style="margin-top: 24px; padding: 20px; background: rgba(175, 75, 239, 0.05); border-radius: var(--radius-sm); font-size: 0.95rem;">
                    <strong>Clinical Tip:</strong> "Always auscultate BEFORE palpation!" Palpation can stimulate bowel sounds, 
                    giving false findings. Listen for at least 2 minutes per quadrant before proceeding to palpation. 
                    Normal bowel sounds occur every 5-15 seconds.
                </div>
            </section>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-secondary" id="resetBtn">
                <span>‚Üª</span>
                Reset All Activities
            </button>
            <button class="btn btn-primary" id="checkBtn">
                <span>‚úì</span>
                Check All Answers
            </button>
            <button class="btn btn-primary" id="viewResultsBtn" style="display: none;">
                <span>üìä</span>
                View Final Results
            </button>
        </div>

        <!-- Results Panel -->
        <div class="results-panel" id="resultsPanel">
            <div class="results-header">
                <div class="activity-icon" style="background: var(--color-success);">‚úì</div>
                <h3 class="results-title">Module 1 Complete!</h3>
            </div>
            <div class="results-content">
                <p>Excellent work! You've completed the <strong>GI System Fundamentals & Assessment Simulator</strong> module.</p>
                
                <div class="score-display">
                    <div class="score-value" id="scoreValue">0%</div>
                    <div class="score-text" id="scoreText">Your overall score</div>
                </div>
                
                <div class="score-bar">
                    <div class="score-fill" id="scoreFill"></div>
                </div>
                
                <p><strong>What you've mastered:</strong></p>
                <ul style="margin-left: 20px; margin-top: 8px; margin-bottom: 16px;">
                    <li>‚úì GI organ placement in abdominal quadrants</li>
                    <li>‚úì Matching organs with primary physiological functions</li>
                    <li>‚úì Telephone screening for GI complaints</li>
                    <li>‚úì Correct abdominal examination sequence</li>
                    <li>‚úì Identifying emergency vs. routine GI symptoms</li>
                </ul>
                
                <div class="clinical-insight">
                    <strong>Clinical Insight:</strong> The medical assistant's role in GI assessment includes accurate documentation 
                    using proper terminology. Remember: "Right Upper Quadrant (RUQ)" not "upper right stomach." 
                    When patients describe abdominal pain, have them point with one finger‚Äîdiffuse hand waving suggests 
                    less localized (and often less urgent) pathology. Always document pain characteristics using OPQRST 
                    (Onset, Provocation, Quality, Radiation, Severity, Time).
                </div>
            </div>
        </div>
    </main>

    <script>
        // === STATE MANAGEMENT ===
        let moduleState = {
            anatomy: { completed: false, score: 0, total: 8 },
            functions: { completed: false, score: 0, total: 4 },
            symptoms: { completed: false, score: 0, total: 14 },
            exam: { completed: false, score: 0, total: 6 },
            startTime: new Date(),
            activitiesCompleted: 0
        };

        // === ACTIVITY 1: ANATOMY FUNCTIONS ===
        function initializeAnatomyActivity() {
            let draggedOrgan = null;
            
            // Organ tag drag events
            document.querySelectorAll('.organ-tag').forEach(organ => {
                organ.addEventListener('dragstart', function(e) {
                    draggedOrgan = this;
                    this.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', this.id);
                    
                    setTimeout(() => {
                        this.style.opacity = '0.4';
                    }, 0);
                });
                
                organ.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    this.style.opacity = '1';
                    draggedOrgan = null;
                });
            });
            
            // Quadrant drop events
            document.querySelectorAll('.abdominal-quadrant').forEach(quadrant => {
                quadrant.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.style.borderColor = 'var(--color-primary)';
                    this.style.backgroundColor = 'rgba(175, 75, 239, 0.05)';
                });
                
                quadrant.addEventListener('dragleave', function() {
                    this.style.borderColor = '#ddd';
                    this.style.backgroundColor = 'white';
                });
                
                quadrant.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.style.borderColor = '#ddd';
                    this.style.backgroundColor = 'white';
                    
                    if (draggedOrgan) {
                        // Check if quadrant already has this organ type
                        const existingOrgans = this.querySelectorAll('.organ-tag');
                        const organType = draggedOrgan.dataset.organ;
                        
                        // Remove previous placement of same organ
                        document.querySelectorAll('.organ-tag.placed').forEach(placed => {
                            if (placed.dataset.organ === organType && placed !== draggedOrgan) {
                                placed.parentElement.removeChild(placed);
                                // Show original tag again
                                const originalTag = document.getElementById(`tag-${organType}`);
                                if (originalTag) {
                                    originalTag.style.visibility = 'visible';
                                }
                            }
                        });
                        
                        // Create clone
                        const organClone = draggedOrgan.cloneNode(true);
                        organClone.classList.remove('dragging');
                        organClone.classList.add('placed');
                        organClone.draggable = false;
                        organClone.style.cursor = 'default';
                        organClone.style.opacity = '1';
                        organClone.style.margin = '8px 0';
                        organClone.style.width = '90%';
                        
                        // Add to quadrant
                        this.appendChild(organClone);
                        
                        // Hide original
                        draggedOrgan.style.visibility = 'hidden';
                    }
                });
            });
            
            // Check anatomy button
            document.getElementById('checkAnatomyBtn').addEventListener('click', checkAnatomyPlacement);
        }
        
        function checkAnatomyPlacement() {
            const correctPlacements = {
                'ruq': ['liver', 'gallbladder'],
                'luq': ['stomach', 'spleen'],
                'rlq': ['appendix'],
                'llq': ['sigmoid'],
                'epigastric': ['pancreas'],
                'periumbilical': ['small-intestine']
            };
            
            let score = 0;
            let totalPossible = 8;
            let feedbackItems = [];
            
            // Clear previous feedback
            const feedbackList = document.getElementById('anatomyFeedbackList');
            feedbackList.innerHTML = '';
            
            // Check each quadrant
            for (const [quadrantId, correctOrgans] of Object.entries(correctPlacements)) {
                const quadrant = document.getElementById(`quadrant-${quadrantId}`) || 
                                 document.querySelector(`[data-quadrant="${quadrantId}"]`);
                if (!quadrant) continue;
                
                const quadrantTitle = quadrant.querySelector('.quadrant-title').textContent;
                const placedOrgans = Array.from(quadrant.querySelectorAll('.organ-tag'));
                
                // Check each correct organ for this quadrant
                correctOrgans.forEach(correctOrganId => {
                    const isPlaced = placedOrgans.some(organ => organ.dataset.organ === correctOrganId);
                    
                    if (isPlaced) {
                        score++;
                        
                        let organName = '';
                        switch(correctOrganId) {
                            case 'liver': organName = 'Liver'; break;
                            case 'gallbladder': organName = 'Gallbladder'; break;
                            case 'stomach': organName = 'Stomach'; break;
                            case 'spleen': organName = 'Spleen'; break;
                            case 'appendix': organName = 'Appendix'; break;
                            case 'sigmoid': organName = 'Sigmoid Colon'; break;
                            case 'pancreas': organName = 'Pancreas'; break;
                            case 'small-intestine': organName = 'Small Intestine'; break;
                        }
                        
                        const li = document.createElement('li');
                        li.className = 'feedback-item correct';
                        li.textContent = `${quadrantTitle}: Correct - ${organName} belongs here.`;
                        feedbackList.appendChild(li);
                    } else {
                        let organName = '';
                        switch(correctOrganId) {
                            case 'liver': organName = 'Liver'; break;
                            case 'gallbladder': organName = 'Gallbladder'; break;
                            case 'stomach': organName = 'Stomach'; break;
                            case 'spleen': organName = 'Spleen'; break;
                            case 'appendix': organName = 'Appendix'; break;
                            case 'sigmoid': organName = 'Sigmoid Colon'; break;
                            case 'pancreas': organName = 'Pancreas'; break;
                            case 'small-intestine': organName = 'Small Intestine'; break;
                        }
                        
                        const li = document.createElement('li');
                        li.className = 'feedback-item incorrect';
                        li.textContent = `${quadrantTitle}: Missing - ${organName} should be placed here.`;
                        feedbackList.appendChild(li);
                    }
                });
                
                // Check for incorrect placements
                placedOrgans.forEach(organ => {
                    const organId = organ.dataset.organ;
                    const isCorrect = correctOrgans.includes(organId);
                    
                    if (isCorrect) {
                        quadrant.classList.remove('incorrect-drop');
                        quadrant.classList.add('correct-drop');
                    } else {
                        quadrant.classList.remove('correct-drop');
                        quadrant.classList.add('incorrect-drop');
                    }
                });
            }
            
            // Add clinical tips
            const tip1 = document.createElement('li');
            tip1.className = 'feedback-item tip';
            tip1.textContent = 'Clinical Correlation: RUQ pain suggests liver/gallbladder issues. RLQ pain raises suspicion for appendicitis. LUQ pain may indicate gastric or splenic problems.';
            feedbackList.appendChild(tip1);
            
            if (score === totalPossible) {
                const tip2 = document.createElement('li');
                tip2.className = 'feedback-item tip';
                tip2.textContent = 'Excellent anatomical knowledge! This foundation is crucial for accurate patient assessment and documentation.';
                feedbackList.appendChild(tip2);
            } else if (score >= totalPossible * 0.7) {
                const tip3 = document.createElement('li');
                tip3.className = 'feedback-item tip';
                tip3.textContent = 'Good effort! Remember: Pancreas is epigastric, small intestine is periumbilical, sigmoid colon is LLQ.';
                feedbackList.appendChild(tip3);
            }
            
            // Update module state
            moduleState.anatomy.score = score;
            moduleState.anatomy.completed = true;
            
            // Update feedback title
            const feedbackTitle = document.querySelector('#anatomyFeedbackDetails .feedback-title');
            feedbackTitle.innerHTML = `<span>üìã Anatomy Placement Feedback: ${score}/${totalPossible} Correct</span>`;
            
            // Provide summary feedback
            let summaryFeedback = '';
            if (score === totalPossible) {
                summaryFeedback = '‚úì Perfect! All GI organs correctly placed in abdominal quadrants.';
            } else if (score >= totalPossible * 0.7) {
                summaryFeedback = `‚úì Good effort! ${score}/${totalPossible} correct. Review the detailed feedback to improve your anatomical placement.`;
            } else {
                summaryFeedback = `‚úó Needs practice. ${score}/${totalPossible} correct. Review abdominal quadrants and organ locations in Chapter 15.`;
            }
            
            showFeedback('anatomyFeedback', summaryFeedback, score >= totalPossible * 0.7 ? 'correct' : 'incorrect');
            updateProgress();
        }

        // === ACTIVITY 2: FUNCTION MATCHING FUNCTIONS ===
        function initializeFunctionMatching() {
            let draggedItem = null;
            
            // Function item drag events
            document.querySelectorAll('.function-item').forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    draggedItem = this;
                    this.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', this.id || this.textContent);
                    
                    // Add active class to drop zones
                    document.querySelectorAll('.function-drop-zone').forEach(zone => {
                        zone.classList.add('active');
                    });
                });
                
                item.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    draggedItem = null;
                    
                    // Remove active class from drop zones
                    document.querySelectorAll('.function-drop-zone').forEach(zone => {
                        zone.classList.remove('active');
                    });
                });
            });
            
            // Drop zone events
            document.querySelectorAll('.function-drop-zone').forEach(zone => {
                zone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                });
                
                zone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    
                    if (draggedItem) {
                        // Create clone
                        const itemClone = draggedItem.cloneNode(true);
                        itemClone.classList.remove('dragging');
                        itemClone.draggable = true; // Allow re-dragging
                        itemClone.style.cursor = 'grab';
                        itemClone.style.margin = '5px';
                        
                        // Add new drag event to clone
                        itemClone.addEventListener('dragstart', function(e) {
                            this.classList.add('dragging');
                            e.dataTransfer.setData('text/plain', this.id || this.textContent);
                            
                            document.querySelectorAll('.function-drop-zone').forEach(z => {
                                z.classList.add('active');
                            });
                        });
                        
                        itemClone.addEventListener('dragend', function() {
                            this.classList.remove('dragging');
                            
                            document.querySelectorAll('.function-drop-zone').forEach(z => {
                                z.classList.remove('active');
                            });
                        });
                        
                        this.appendChild(itemClone);
                    }
                });
            });
            
            // Check function button
            document.getElementById('checkFunctionBtn').addEventListener('click', checkFunctionMatches);
        }
        
        function checkFunctionMatches() {
            const correctMatches = {
                'stomach': 'A',
                'liver': 'C',
                'small-intestine': 'B',
                'colon': 'D'
            };
            
            // Get all items in drop zones
            const organZone = document.getElementById('drop-organs');
            const functionZone = document.getElementById('drop-functions');
            
            const organItems = Array.from(organZone.querySelectorAll('.function-item'));
            const functionItems = Array.from(functionZone.querySelectorAll('.function-item'));
            
            let score = 0;
            let matchedPairs = [];
            
            // Reset visual feedback
            document.querySelectorAll('.function-item').forEach(item => {
                item.classList.remove('matched', 'incorrect-match');
            });
            
            // Try to match items
            organItems.forEach(organItem => {
                const organType = organItem.dataset.organ;
                const correctMatch = correctMatches[organType];
                
                // Find matching function
                const matchingFunction = functionItems.find(func => 
                    func.dataset.function && func.dataset.match === correctMatch
                );
                
                if (matchingFunction) {
                    organItem.classList.add('matched');
                    matchingFunction.classList.add('matched');
                    score++;
                    matchedPairs.push(organType);
                    
                    // Remove from arrays to prevent double matching
                    const functionIndex = functionItems.indexOf(matchingFunction);
                    if (functionIndex > -1) {
                        functionItems.splice(functionIndex, 1);
                    }
                } else {
                    organItem.classList.add('incorrect-match');
                }
            });
            
            // Mark unmatched functions as incorrect
            functionItems.forEach(item => {
                item.classList.add('incorrect-match');
            });
            
            // Update module state
            moduleState.functions.score = score;
            moduleState.functions.completed = true;
            
            // Provide feedback
            let feedback = '';
            if (score === 4) {
                feedback = `‚úì Perfect! All 4 GI functions correctly matched. You understand: Stomach = digestion, Liver = metabolism, Small Intestine = absorption, Colon = elimination.`;
            } else if (score >= 2) {
                feedback = `‚úì Good work! ${score}/4 functions correctly matched. Review unmatched items marked in red.`;
            } else {
                feedback = `‚úó Needs review. ${score}/4 functions correct. Key functions: Stomach digests, Liver metabolizes, Small intestine absorbs, Colon eliminates.`;
            }
            
            showFeedback('functionFeedback', feedback, score >= 2 ? 'correct' : 'incorrect');
            updateProgress();
        }

        // === ACTIVITY 3: SYMPTOM ASSESSMENT FUNCTIONS ===
        function initializeSymptomAssessment() {
            // Symptom option click events
            document.querySelectorAll('.symptom-option').forEach(option => {
                option.addEventListener('click', function() {
                    const scenario = this.dataset.scenario;
                    
                    // Toggle selection
                    this.classList.toggle('selected');
                });
            });
            
            // Check symptom button
            document.getElementById('checkSymptomBtn').addEventListener('click', checkSymptomAssessment);
        }
        
        function checkSymptomAssessment() {
            const correctAnswers = {
                '1': [true, true, false, true, true, false], // Scenario 1 correct answers
                '2': [true, true, true, false, true, true],  // Scenario 2 correct answers
                '3': [true, true, false, true, true, false]  // Scenario 3 correct answers
            };
            
            let totalScore = 0;
            let totalQuestions = 0;
            
            // Check each scenario
            for (let i = 1; i <= 3; i++) {
                const options = document.querySelectorAll(`.symptom-option[data-scenario="${i}"]`);
                const scenarioCorrect = correctAnswers[i];
                
                options.forEach((option, index) => {
                    totalQuestions++;
                    const isSelected = option.classList.contains('selected');
                    const isCorrect = scenarioCorrect[index];
                    
                    // Mark visual feedback
                    if (isSelected && isCorrect) {
                        option.classList.add('correct');
                        totalScore++;
                    } else if (isSelected && !isCorrect) {
                        option.classList.add('incorrect');
                    } else if (!isSelected && isCorrect) {
                        option.classList.add('correct');
                        // Show that it should have been selected
                    }
                    
                    // Disable further clicks
                    option.style.pointerEvents = 'none';
                });
            }
            
            // Update module state
            moduleState.symptoms.score = Math.floor((totalScore / totalQuestions) * 14); // Convert to 14-point scale
            moduleState.symptoms.completed = true;
            
            // Calculate percentage for feedback
            const percentage = Math.round((totalScore / totalQuestions) * 100);
            
            // Provide feedback
            let feedback = '';
            if (percentage >= 90) {
                feedback = `‚úì Perfect! ${totalScore}/${totalQuestions} screening questions correct. You excellently identified emergency symptoms and appropriate screening questions.`;
            } else if (percentage >= 70) {
                feedback = `‚úì Good! ${totalScore}/${totalQuestions} correct (${percentage}%). Remember: Focus on red flags (bleeding, chest pain, dehydration) and relevant medical history.`;
            } else {
                feedback = `‚úó Needs review. ${totalScore}/${totalQuestions} correct (${percentage}%). Key principle: Telephone screening identifies emergencies needing immediate care vs. routine appointments.`;
            }
            
            showFeedback('symptomFeedback', feedback, percentage >= 70 ? 'correct' : 'incorrect');
            updateProgress();
        }

        // === ACTIVITY 4: EXAM SEQUENCE FUNCTIONS ===
        function initializeExamSequence() {
            let clickOrder = [];
            let currentClick = 1;
            const maxSteps = 6;
            const correctOrder = [3, 1, 4, 2, 5, 6]; // Correct sequence: Inspection ‚Üí Percussion ‚Üí Auscultation ‚Üí Deep Palpation ‚Üí Special Tests ‚Üí Documentation
            
            // Exam step click events
            document.querySelectorAll('.exam-step').forEach(step => {
                step.addEventListener('click', function() {
                    // If already clicked, skip
                    if (this.classList.contains('active')) return;
                    
                    // Mark as active in current order
                    const stepNumber = parseInt(this.dataset.step);
                    clickOrder.push(stepNumber);
                    
                    // Update display
                    const numberSpan = this.querySelector('.exam-number');
                    numberSpan.textContent = currentClick;
                    this.classList.add('active');
                    
                    currentClick++;
                    
                    // Check if all steps are clicked
                    if (clickOrder.length === maxSteps) {
                        checkExamSequence(clickOrder, correctOrder);
                    }
                });
            });
            
            // Check exam button
            document.getElementById('checkExamBtn').addEventListener('click', function() {
                if (clickOrder.length < maxSteps) {
                    showFeedback('examFeedback', 
                        `Please click all ${maxSteps} steps in the correct order first!`, 
                        'incorrect');
                    return;
                }
                checkExamSequence(clickOrder, correctOrder);
            });
        }
        
        function checkExamSequence(clickOrder, correctOrder) {
            let correctCount = 0;
            
            // Compare sequences
            for (let i = 0; i < clickOrder.length; i++) {
                if (clickOrder[i] === correctOrder[i]) {
                    correctCount++;
                }
            }
            
            // Calculate score
            moduleState.exam.score = correctCount;
            moduleState.exam.completed = true;
            
            // Visual feedback
            document.querySelectorAll('.exam-step').forEach((step, index) => {
                const stepNumber = parseInt(step.dataset.step);
                const numberSpan = step.querySelector('.exam-number');
                
                if (stepNumber === correctOrder[index]) {
                    numberSpan.style.background = 'var(--color-success)';
                } else {
                    numberSpan.style.background = 'var(--color-error)';
                    const correctIndex = correctOrder.indexOf(stepNumber);
                    if (correctIndex !== -1) {
                        numberSpan.title = `Should be step ${correctIndex + 1}`;
                    }
                }
            });
            
            // Show feedback
            const percentage = Math.round((correctCount / maxSteps) * 100);
            let feedback = '';
            
            if (percentage === 100) {
                feedback = `‚úì Perfect! All ${correctCount}/${maxSteps} steps in correct order. Critical sequence: Inspection ‚Üí Percussion ‚Üí Auscultation ‚Üí Palpation ‚Üí Special Tests ‚Üí Documentation.`;
            } else if (percentage >= 70) {
                feedback = `‚úì Good! ${correctCount}/${maxSteps} correct (${percentage}%). Review steps marked in red.`;
            } else {
                feedback = `‚úó Needs review. ${correctCount}/${maxSteps} correct (${percentage}%). Correct sequence: 1. Inspection, 2. Percussion, 3. Auscultation, 4. Deep Palpation, 5. Special Tests, 6. Documentation.`;
            }
            
            showFeedback('examFeedback', feedback, 
                percentage >= 70 ? 'correct' : 'incorrect');
            
            updateProgress();
        }

        // === INITIALIZE MODULE ===
        document.addEventListener('DOMContentLoaded', function() {
            initializeAnatomyActivity();
            initializeFunctionMatching();
            initializeSymptomAssessment();
            initializeExamSequence();
            setupEventListeners();
            updateProgress();
            startTimer();
        });

        // === HELPER FUNCTIONS ===
        function setupEventListeners() {
            // Reset button
            document.getElementById('resetBtn').addEventListener('click', resetAllActivities);
            
            // Check all answers button
            document.getElementById('checkBtn').addEventListener('click', checkAllAnswers);
            
            // View results button
            document.getElementById('viewResultsBtn').addEventListener('click', showFinalResults);
        }

        function showFeedback(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = 'feedback-message';
            element.classList.add(`feedback-${type}`);
            element.style.display = 'block';
            
            if (type === 'incorrect') {
                setTimeout(() => {
                    element.style.display = 'none';
                }, 5000);
            }
        }

        function updateProgress() {
            // Calculate completed activities
            let completedCount = 0;
            if (moduleState.anatomy.completed) completedCount++;
            if (moduleState.functions.completed) completedCount++;
            if (moduleState.symptoms.completed) completedCount++;
            if (moduleState.exam.completed) completedCount++;
            
            document.getElementById('completedCount').textContent = completedCount;
            
            // Calculate accuracy
            let totalScore = 0;
            let totalPossible = 0;
            
            Object.values(moduleState).forEach(activity => {
                if (activity.score !== undefined && activity.total) {
                    totalScore += activity.score;
                    totalPossible += activity.total;
                }
            });
            
            const accuracy = totalPossible > 0 ? Math.round((totalScore / totalPossible) * 100) : 0;
            document.getElementById('accuracyScore').textContent = `${accuracy}%`;
            
            // Update progress tracker
            if (completedCount >= 4) {
                document.querySelectorAll('.progress-step').forEach(step => {
                    step.classList.remove('active');
                    step.classList.add('completed');
                });
                
                // Show "View Results" button
                document.getElementById('checkBtn').style.display = 'none';
                document.getElementById('viewResultsBtn').style.display = 'flex';
            } else if (completedCount >= 1) {
                document.querySelectorAll('.progress-step').forEach((step, index) => {
                    step.classList.remove('active', 'completed');
                    if (index < completedCount) {
                        step.classList.add('completed');
                    }
                    if (index === completedCount) {
                        step.classList.add('active');
                    }
                });
            }
            
            // Update module state
            moduleState.activitiesCompleted = completedCount;
        }

        function startTimer() {
            const timeElement = document.getElementById('timeSpent');
            
            setInterval(() => {
                const now = new Date();
                const diffMs = now - moduleState.startTime;
                const diffMins = Math.floor(diffMs / 60000);
                timeElement.textContent = `${diffMins} min`;
            }, 60000);
        }

        function checkAllAnswers() {
            // Trigger check for each activity if not already checked
            if (!moduleState.anatomy.completed) {
                checkAnatomyPlacement();
            }
            
            if (!moduleState.functions.completed) {
                checkFunctionMatches();
            }
            
            if (!moduleState.symptoms.completed) {
                checkSymptomAssessment();
            }
            
            if (!moduleState.exam.completed) {
                showFeedback('examFeedback', 
                    'Complete the exam sequence activity first!', 
                    'incorrect');
            }
            
            updateProgress();
            
            // If all activities completed, show results
            if (moduleState.activitiesCompleted >= 4) {
                showFinalResults();
            }
        }

        function showFinalResults() {
            // Calculate final score
            let totalScore = 0;
            let totalPossible = 0;
            
            Object.values(moduleState).forEach(activity => {
                if (activity.score !== undefined && activity.total) {
                    totalScore += activity.score;
                    totalPossible += activity.total;
                }
            });
            
            const finalScore = totalPossible > 0 ? Math.round((totalScore / totalPossible) * 100) : 0;
            
            // Animate score counter
            const scoreElement = document.getElementById('scoreValue');
            animateCounter(scoreElement, 0, finalScore, 1500);
            
            // Set score bar width
            const scoreFill = document.getElementById('scoreFill');
            scoreFill.style.setProperty('--target-width', `${finalScore}%`);
            setTimeout(() => {
                scoreFill.style.width = `${finalScore}%`;
            }, 100);
            
            // Set score text
            const scoreText = document.getElementById('scoreText');
            let performance = '';
            
            if (finalScore >= 90) performance = 'Outstanding!';
            else if (finalScore >= 80) performance = 'Excellent!';
            else if (finalScore >= 70) performance = 'Good!';
            else performance = 'Keep practicing!';
            
            scoreText.textContent = `${performance} Your overall score`;
            
            // Show results panel
            document.getElementById('resultsPanel').classList.add('show');
            
            // Scroll to results
            setTimeout(() => {
                document.getElementById('resultsPanel').scrollIntoView({
                    behavior: 'smooth',
                    block: 'nearest'
                });
            }, 100);
        }

        function animateCounter(element, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const value = Math.floor(progress * (end - start) + start);
                element.textContent = `${value}%`;
                
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        function resetAllActivities() {
            if (!confirm("Are you sure you want to reset all activities? All progress will be lost.")) return;
            
            // Reset module state
            moduleState = {
                anatomy: { completed: false, score: 0, total: 8 },
                functions: { completed: false, score: 0, total: 4 },
                symptoms: { completed: false, score: 0, total: 14 },
                exam: { completed: false, score: 0, total: 6 },
                startTime: new Date(),
                activitiesCompleted: 0
            };
            
            // Reset activity 1
            document.querySelectorAll('.organ-tag').forEach(tag => {
                tag.classList.remove('dragging', 'placed');
                tag.style.visibility = 'visible';
                tag.style.opacity = '1';
                tag.draggable = true;
                tag.style.cursor = 'grab';
                tag.style.width = 'auto';
                tag.style.margin = '0';
            });
            
            // Reset quadrants
            const quadrantData = {
                'ruq': { label: 'Right Upper Quadrant (RUQ)', title: 'Liver & Gallbladder Zone', instruction: 'Drag liver, gallbladder here' },
                'luq': { label: 'Left Upper Quadrant (LUQ)', title: 'Stomach & Spleen Zone', instruction: 'Drag stomach, spleen here' },
                'rlq': { label: 'Right Lower Quadrant (RLQ)', title: 'Appendix Zone', instruction: 'Drag appendix here' },
                'llq': { label: 'Left Lower Quadrant (LLQ)', title: 'Sigmoid Colon Zone', instruction: 'Drag sigmoid colon here' }
            };
            
            for (const [quadrantId, data] of Object.entries(quadrantData)) {
                const quadrant = document.getElementById(`quadrant-${quadrantId}`);
                quadrant.innerHTML = `
                    <div class="quadrant-label">${data.label}</div>
                    <div class="quadrant-title">${data.title}</div>
                    <div class="quadrant-instruction">${data.instruction}</div>
                `;
                quadrant.classList.remove('correct-drop', 'incorrect-drop');
                quadrant.style.borderColor = '#ddd';
                quadrant.style.backgroundColor = 'white';
            }
            
            // Reset feedback section for activity 1
            const feedbackList = document.getElementById('anatomyFeedbackList');
            feedbackList.innerHTML = '';
            
            const feedbackTitle = document.querySelector('#anatomyFeedbackDetails .feedback-title');
            feedbackTitle.innerHTML = `<span>üìã Anatomy Placement Feedback:</span>`;
            
            // Reset activity 2
            document.querySelectorAll('.function-item').forEach(item => {
                item.classList.remove('matched', 'incorrect-match', 'dragging');
                item.draggable = true;
                item.style.cursor = 'grab';
                item.style.margin = '0';
            });
            
            // Clear drop zones for activity 2
            document.getElementById('drop-organs').innerHTML = 
                '<div style="width: 100%; text-align: center; color: var(--color-muted); padding: 10px;">Drag GI Organs Here</div>';
            document.getElementById('drop-functions').innerHTML = 
                '<div style="width: 100%; text-align: center; color: var(--color-muted); padding: 10px;">Drag Primary Functions Here</div>';
            
            // Reset activity 3
            document.querySelectorAll('.symptom-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
                option.style.pointerEvents = 'auto';
            });
            
            // Reset activity 4
            document.querySelectorAll('.exam-step').forEach(step => {
                step.classList.remove('active');
                const numberSpan = step.querySelector('.exam-number');
                numberSpan.textContent = '?';
                numberSpan.style.background = 'var(--color-primary)';
                numberSpan.title = '';
            });
            
            // Clear feedback messages
            document.querySelectorAll('.feedback-message').forEach(feedback => {
                feedback.textContent = '';
                feedback.className = 'feedback-message';
                feedback.style.display = 'none';
            });
            
            // Hide results panel
            document.getElementById('resultsPanel').classList.remove('show');
            
            // Reset buttons
            document.getElementById('checkBtn').style.display = 'flex';
            document.getElementById('viewResultsBtn').style.display = 'none';
            
            // Reset progress tracker
            document.querySelectorAll('.progress-step').forEach((step, index) => {
                step.classList.remove('completed');
                if (index === 0) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
            
            // Update progress display
            updateProgress();
            
            // Show reset confirmation
            showFeedback('anatomyFeedback', '‚úì All activities have been reset. Ready to start again!', 'correct');
        }
    </script>
</body>
</html>
